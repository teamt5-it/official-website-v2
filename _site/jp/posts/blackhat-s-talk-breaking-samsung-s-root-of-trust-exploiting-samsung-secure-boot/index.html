<!DOCTYPE html><html><html style="background-color:#4c433f"><head><script src="/@webcomponents/webcomponentsjs/webcomponents-loader.js"></script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-8DTJPD8FFX"></script><script>
                    window.dataLayer = window.dataLayer || [];
                    function gtag(){dataLayer.push(arguments);}
                    gtag('js', new Date());
                    gtag('config', 'G-8DTJPD8FFX', {
                      page_path: window.location.pathname,
                    });
                  </script><meta charSet="utf-8"/><link rel="shortcut icon" href="/favicon.ico" type="image/vnd.microsoft.icon"/><link rel="icon" href="/favicon.ico" type="image/vnd.microsoft.icon"/><style>
            body {
              font-family: Noto Sans JP, &#x27;Lato&#x27;, sans-serif;
            }
          </style><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="facebook-domain-verification" content="ud6xuazjca17uowsk65p2jrevtvosd"/><title>BlackHat&#x27;s Talk: Breaking Samsung&#x27;s Root of Trust - Exploiting Samsung Secure Boot</title><meta property="og:title" content="BlackHat&#x27;s Talk: Breaking Samsung&#x27;s Root of Trust - Exploiting Samsung Secure Boot"/><meta name="description" content="### D39

D39 focuses on vulnerability research and has identified several critical security flaws, including technical exploitation of mobile, IoT devices, and Linux and Windows operating systems. We have reported dozens of vulnerabilities and dedicate to Samsung Vulnerabilities and Exposures (SVE) and Common Vulnerabilities and Exposures (CVE).

Before diving into the main subject this month, we are glad to announce that TeamT5 is again accepted at Black Hat USA, and our vulnerability research team, D39, will talk at the Black Hat Briefings in the upcoming August. We are honored to share our research findings with researchers and security experts all over the world and expect more recognition of Taiwan&#x27;s vulnerability researchers in the world.

![](https://res.cloudinary.com/dvgomg5gh/image/upload/v1591769445/D39_6-1_6807f98c9b.png)
[Black Hat Session](https://www.blackhat.com/us-20/briefings/schedule/index.html#breaking-samsungs-root-of-trust-exploiting-samsung-s-secure-boot-20290)

This article will cover a part of our talk at Black Hat USA in August.

### Introduction

We have found several vulnerabilities in Samsung Secure boot, which can break through Samsung Knox protections. We can even retrieve users&#x27; sensitive data from a locked device. The affected Samsung mobiles include Galaxy S8, S9, and S10. Patches to these vulnerabilities have been provided by Samsung.

One of these vulnerabilities allows attackers to execute arbitrary code in Galaxy S8 secure bootloader to access the device. In this article, we will elaborate how we exploit these vulnerabilities to bypass S8 secure bootloader through the USB device and obtain arbitrary code execution in early boot stage.

Note: Another security research team found this vulnerability at the same time and report it to Samsung.
ID: SVE-2019-15230 (details below).
![](https://res.cloudinary.com/dvgomg5gh/image/upload/v1591769435/SVE-2019_3bc5eea84d.png)

### KNOX

![](https://res.cloudinary.com/dvgomg5gh/image/upload/v1591769436/D39_6-2_ee457f68cd.png)
[Image courtesy](https://docs.samsungknox.com/whitepapers/knox-platform/hardware-backed-root-of-trust.htm)

As the market leader of smartphone, Samsung conducts a series of protection on Android, known as the Knox Platform, to ensure the security of its devices. During the booting process, Samsung uses S-boot (Secure Boot) to make sure it can only boot a stocked image. If the device tries to boot a custom image, it will trip (turned from 0X0 to 0X1) a one-time programmable bit e-fuse (a.k.a Knox bit). Once a trustzone app (trustlet) detects the Knox bit tripped, it will delete the encryption key of sensitive data to prevent unauthorized data from accessing the locked device.

### Vulnerability

Smartphones with Samsung Exynos processor use a exclusive secure bootloader named S-boot. S-boot has ODIN mode which allows users to upgrade the firmware manually. Due to the insufficiency in its code, the flash command (opcode: 0x66) in ODIN mode is not able to properly check the flash image size, which leads to buffer overflow.

The flash command in ODIN mode uses a temporary buffer to store the image. In Galaxy S8, the buffer is located at 0xC0000000, right in front of sboot code segment (0xC9000000). Although the system will check to ensure that the size being no larger than 0x1e0000, it uses signed comparison to check the size of the image; thus provide us some space to get around. We therefore provide a size larger than 0x80000000, making buffer overflowed and, in the end, the following segments such as code, stack, and heap will be overwritten.

![](https://res.cloudinary.com/dvgomg5gh/image/upload/v1591769435/D39_6-3_8b038e080e.png)

### The Exploit

#### Code Execution

Although we can overflow the code segment of S-Boot, we still cannot hijack the execution flow. Since USB receivers use physical memory to hold the data it received directly, we cannot affect instruction cache unless the cache line has been invalidated.

Fortunately, the heap segment is not cached due to MMU flag. There are some pointers stored in the heap segment, which can be accessed during the USB process. If we overwrite these pointers with null bytes, the processor will trigger an exception and trap into the exception handler while accessing to NULL pointers. Since the handler has never been executed, it is not cached in the instruction cache. Therefore we can also overwrite the exception handler simultaneously and hijack it directly to our shellcode.

![](https://res.cloudinary.com/dvgomg5gh/image/upload/v1591769437/D39_6-4_58c7cc6a95.png)

#### Booting Custom Kernel

Since all the run-time data has been overwritten -- including stack, heap and global variables -- the sboot fail to perform further booting operation. These kinds of data are difficult to recover, so we must re-execute the booting process.

Under normal condition, S-boot calls several functions in a particular function table which is located at 0xC90C7350. To re-execute s-boot, these functions have to be invoked sequentially again. They would initialize the memory of heap and stack, set the global variables, and boot the kernel at the end. However, these functions also involve some SMC calls which cannot be executed twice. Since we only compromised EL1 (Exception Level 1), the trustzone in EL3 (Exception Level 3) cannot be reverted. As a result, we have to overwrite these SMC calls with NOP instruction while overflowing the code segment to ignore those SMC (System Management Controller) calls.

After all the run-time data has been reset, we replace the original kernel with our custom one. Then we execute one last function to boot our custom kernel and get the **root privilege without blowing KNOX bit**.

![](https://res.cloudinary.com/dvgomg5gh/image/upload/v1591769436/D39_6-5_2f6b6f9ccd.png)

### Timeline

2019-10-02 Report Vulnerability
2019-10-08 Informed Vulnerability duplicated and release patch note

### Appendix: Potential Exploit Path on Galaxy S10

According to our analysis, this vulnerability affects Galaxy S9, Galaxy S10 and Galaxy Note 10 as well. Among them we find that exploitation can still be trigger at different address. For instance, even the temporary buffer located at different addresss, like 0x890000000 in Galaxy S10, there are still chances to exploit it. To explain the complete exploitation flow, we choose the firmware, G970FXXU1ASD5, as an example.

In Galaxy S9 and later version, there is another feature added to the secure boot - compressed_download. It uses another buffer to store the flash image. However if compressed_download failed during the initialization, it will fallback to normal download, and use the buffer (0xC0000000) to store the flash image.

![](https://res.cloudinary.com/dvgomg5gh/image/upload/v1591769435/D39_6-6_724f86aa51.png)

To make S-boot fallback to normal download, we have to make the function `cd_v3_smp_register` fail. After reversing, we noticed that the function `cd_v3_smp_register` may return failed if there is no available core(`booted_cores` &gt; 3) can be booted. Coincidentally, there is a test command - &quot;smp_boot_test&quot; in the UART (Universal Asynchronous Receiver/Transmitter) console. The command smp_boot_test will boot a core and add the count of the booted_cores. Although `smp_boot_test` shutdown the booted up core immediately, it didn&#x27;t restore the count. Therefore, the compressed_download_init may failed if the command `smp_boot_test` has been invoked more than twice before entering the download mode.

If we have the UART debug cable to get the UART console, we can call the command`smp_boot_test` 3 times and enter the download mode via the command `usb`. The `compressed_download_init` would fail, then the temporary buffer fallback to 0xC0000000. Therefore the arbitrary code execution on S10&#x27;s bootloader can be achieved as the one in Galaxy S8.

We managed to build our own TypeC debug cable at first. However, after trying every kinds of Pull-up/down resistor value, TypeC accessory mode, TypeC VDM, we cannot yet figure out a cable for RID_523K detection. Still, in the end, we applied other approach that enable us to attain **Galaxy S10 Secure Bootloader&#x27;s permission of arbitrary code** without having debug cable.

We will have a thorough display on Black Hat. Stay tuned!

For the latest vulnerability research from D39, please follow:

TeamT5 official website: [https://teamt5.org/](https://teamt5.org/ &quot;https://teamt5.org/&quot;)

Twitter: [https://twitter.com/TeamT5_Official](https://twitter.com/TeamT5_Official &quot;https://twitter.com/TeamT5_Official&quot;)"/><meta property="og:description" content="### D39

D39 focuses on vulnerability research and has identified several critical security flaws, including technical exploitation of mobile, IoT devices, and Linux and Windows operating systems. We have reported dozens of vulnerabilities and dedicate to Samsung Vulnerabilities and Exposures (SVE) and Common Vulnerabilities and Exposures (CVE).

Before diving into the main subject this month, we are glad to announce that TeamT5 is again accepted at Black Hat USA, and our vulnerability research team, D39, will talk at the Black Hat Briefings in the upcoming August. We are honored to share our research findings with researchers and security experts all over the world and expect more recognition of Taiwan&#x27;s vulnerability researchers in the world.

![](https://res.cloudinary.com/dvgomg5gh/image/upload/v1591769445/D39_6-1_6807f98c9b.png)
[Black Hat Session](https://www.blackhat.com/us-20/briefings/schedule/index.html#breaking-samsungs-root-of-trust-exploiting-samsung-s-secure-boot-20290)

This article will cover a part of our talk at Black Hat USA in August.

### Introduction

We have found several vulnerabilities in Samsung Secure boot, which can break through Samsung Knox protections. We can even retrieve users&#x27; sensitive data from a locked device. The affected Samsung mobiles include Galaxy S8, S9, and S10. Patches to these vulnerabilities have been provided by Samsung.

One of these vulnerabilities allows attackers to execute arbitrary code in Galaxy S8 secure bootloader to access the device. In this article, we will elaborate how we exploit these vulnerabilities to bypass S8 secure bootloader through the USB device and obtain arbitrary code execution in early boot stage.

Note: Another security research team found this vulnerability at the same time and report it to Samsung.
ID: SVE-2019-15230 (details below).
![](https://res.cloudinary.com/dvgomg5gh/image/upload/v1591769435/SVE-2019_3bc5eea84d.png)

### KNOX

![](https://res.cloudinary.com/dvgomg5gh/image/upload/v1591769436/D39_6-2_ee457f68cd.png)
[Image courtesy](https://docs.samsungknox.com/whitepapers/knox-platform/hardware-backed-root-of-trust.htm)

As the market leader of smartphone, Samsung conducts a series of protection on Android, known as the Knox Platform, to ensure the security of its devices. During the booting process, Samsung uses S-boot (Secure Boot) to make sure it can only boot a stocked image. If the device tries to boot a custom image, it will trip (turned from 0X0 to 0X1) a one-time programmable bit e-fuse (a.k.a Knox bit). Once a trustzone app (trustlet) detects the Knox bit tripped, it will delete the encryption key of sensitive data to prevent unauthorized data from accessing the locked device.

### Vulnerability

Smartphones with Samsung Exynos processor use a exclusive secure bootloader named S-boot. S-boot has ODIN mode which allows users to upgrade the firmware manually. Due to the insufficiency in its code, the flash command (opcode: 0x66) in ODIN mode is not able to properly check the flash image size, which leads to buffer overflow.

The flash command in ODIN mode uses a temporary buffer to store the image. In Galaxy S8, the buffer is located at 0xC0000000, right in front of sboot code segment (0xC9000000). Although the system will check to ensure that the size being no larger than 0x1e0000, it uses signed comparison to check the size of the image; thus provide us some space to get around. We therefore provide a size larger than 0x80000000, making buffer overflowed and, in the end, the following segments such as code, stack, and heap will be overwritten.

![](https://res.cloudinary.com/dvgomg5gh/image/upload/v1591769435/D39_6-3_8b038e080e.png)

### The Exploit

#### Code Execution

Although we can overflow the code segment of S-Boot, we still cannot hijack the execution flow. Since USB receivers use physical memory to hold the data it received directly, we cannot affect instruction cache unless the cache line has been invalidated.

Fortunately, the heap segment is not cached due to MMU flag. There are some pointers stored in the heap segment, which can be accessed during the USB process. If we overwrite these pointers with null bytes, the processor will trigger an exception and trap into the exception handler while accessing to NULL pointers. Since the handler has never been executed, it is not cached in the instruction cache. Therefore we can also overwrite the exception handler simultaneously and hijack it directly to our shellcode.

![](https://res.cloudinary.com/dvgomg5gh/image/upload/v1591769437/D39_6-4_58c7cc6a95.png)

#### Booting Custom Kernel

Since all the run-time data has been overwritten -- including stack, heap and global variables -- the sboot fail to perform further booting operation. These kinds of data are difficult to recover, so we must re-execute the booting process.

Under normal condition, S-boot calls several functions in a particular function table which is located at 0xC90C7350. To re-execute s-boot, these functions have to be invoked sequentially again. They would initialize the memory of heap and stack, set the global variables, and boot the kernel at the end. However, these functions also involve some SMC calls which cannot be executed twice. Since we only compromised EL1 (Exception Level 1), the trustzone in EL3 (Exception Level 3) cannot be reverted. As a result, we have to overwrite these SMC calls with NOP instruction while overflowing the code segment to ignore those SMC (System Management Controller) calls.

After all the run-time data has been reset, we replace the original kernel with our custom one. Then we execute one last function to boot our custom kernel and get the **root privilege without blowing KNOX bit**.

![](https://res.cloudinary.com/dvgomg5gh/image/upload/v1591769436/D39_6-5_2f6b6f9ccd.png)

### Timeline

2019-10-02 Report Vulnerability
2019-10-08 Informed Vulnerability duplicated and release patch note

### Appendix: Potential Exploit Path on Galaxy S10

According to our analysis, this vulnerability affects Galaxy S9, Galaxy S10 and Galaxy Note 10 as well. Among them we find that exploitation can still be trigger at different address. For instance, even the temporary buffer located at different addresss, like 0x890000000 in Galaxy S10, there are still chances to exploit it. To explain the complete exploitation flow, we choose the firmware, G970FXXU1ASD5, as an example.

In Galaxy S9 and later version, there is another feature added to the secure boot - compressed_download. It uses another buffer to store the flash image. However if compressed_download failed during the initialization, it will fallback to normal download, and use the buffer (0xC0000000) to store the flash image.

![](https://res.cloudinary.com/dvgomg5gh/image/upload/v1591769435/D39_6-6_724f86aa51.png)

To make S-boot fallback to normal download, we have to make the function `cd_v3_smp_register` fail. After reversing, we noticed that the function `cd_v3_smp_register` may return failed if there is no available core(`booted_cores` &gt; 3) can be booted. Coincidentally, there is a test command - &quot;smp_boot_test&quot; in the UART (Universal Asynchronous Receiver/Transmitter) console. The command smp_boot_test will boot a core and add the count of the booted_cores. Although `smp_boot_test` shutdown the booted up core immediately, it didn&#x27;t restore the count. Therefore, the compressed_download_init may failed if the command `smp_boot_test` has been invoked more than twice before entering the download mode.

If we have the UART debug cable to get the UART console, we can call the command`smp_boot_test` 3 times and enter the download mode via the command `usb`. The `compressed_download_init` would fail, then the temporary buffer fallback to 0xC0000000. Therefore the arbitrary code execution on S10&#x27;s bootloader can be achieved as the one in Galaxy S8.

We managed to build our own TypeC debug cable at first. However, after trying every kinds of Pull-up/down resistor value, TypeC accessory mode, TypeC VDM, we cannot yet figure out a cable for RID_523K detection. Still, in the end, we applied other approach that enable us to attain **Galaxy S10 Secure Bootloader&#x27;s permission of arbitrary code** without having debug cable.

We will have a thorough display on Black Hat. Stay tuned!

For the latest vulnerability research from D39, please follow:

TeamT5 official website: [https://teamt5.org/](https://teamt5.org/ &quot;https://teamt5.org/&quot;)

Twitter: [https://twitter.com/TeamT5_Official](https://twitter.com/TeamT5_Official &quot;https://twitter.com/TeamT5_Official&quot;)"/><meta property="og:url" content="https://teamt5.org/jp/posts/blackhat-s-talk-breaking-samsung-s-root-of-trust-exploiting-samsung-secure-boot"/><meta property="og:type" content="website"/><meta property="og:image" content="https://res.cloudinary.com/dvgomg5gh/image/upload/v1590731286/20200608_cover_23a0b23713.jpg"/><meta name="next-head-count" content="7"/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-cf519ab7dd9a5a4fd835.js"></script><script src="/_next/static/chunks/webpack-e50c24efd369c1efbdb6.js" defer=""></script><script src="/_next/static/chunks/framework-d2ee10ca2f4d09d55866.js" defer=""></script><script src="/_next/static/chunks/main-a8d0f6a9979592fe7c0c.js" defer=""></script><script src="/_next/static/chunks/pages/_app-c4fc1fc4c79c4d8fe6ea.js" defer=""></script><script src="/_next/static/chunks/938-e92d2fa2f45971e6fc56.js" defer=""></script><script src="/_next/static/chunks/355-15d3d4def9e737543aae.js" defer=""></script><script src="/_next/static/chunks/40-c99810d551f4d9c6ca2d.js" defer=""></script><script src="/_next/static/chunks/625-71996cc7d9f6287d8f11.js" defer=""></script><script src="/_next/static/chunks/258-abfc1d233ee6f2e32b5d.js" defer=""></script><script src="/_next/static/chunks/502-5fb4c5ca4d423d22ef37.js" defer=""></script><script src="/_next/static/chunks/pages/%5Blang%5D/posts/%5Buid%5D-2ad5faee628e3c6ea341.js" defer=""></script><script src="/_next/static/yZH7uzr0jnSd-VRHt_pM1/_buildManifest.js" defer=""></script><script src="/_next/static/yZH7uzr0jnSd-VRHt_pM1/_ssgManifest.js" defer=""></script></head><body><div id="__next"><loading-mask></loading-mask><div style="background-color:#4c433f;height:100%;width:100%;z-index:100;position:absolute"></div><div class="invisible"><div class="css-5un68d"><div class="css-1tgzre3"><header class="css-d4eynq"><div class="css-9225oi"><a class="css-9obram" href="/jp/"><svg width="140px" height="140px" viewBox="0 0 140 140"><g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="header_logo_L"><g><rect id="Rectangle" fill="#d93751" x="0" y="0" width="140" height="140"></rect><g id="logo" fill="#FEFEFE"><g class="css-17sqj2s"><path d="M45.3878535,7.83374722 L46.5394028,6.64521453 C41.9643042,2.79068668 36.0560225,0.348420339 29.5325296,0.000255690073 L29.5325296,7.2512 C30.6363042,8.26884649 33.1205859,8.98776174 36.5806423,8.98776174 C40.4539944,8.98776174 44.2998535,8.10477869 45.3878535,7.83374722" id="Fill-1"></path><path d="M26.3422648,52.6615012 L26.3422648,50.0376949 C19.5488,43.5926005 14.657307,42.8932881 12.8558423,42.8932881 L12.4429972,42.9060726 L9.33764507,46.0156901 C13.9118423,49.8697918 19.8196732,52.3129104 26.3422648,52.6615012" id="Fill-3"></path><path d="M46.3986028,45.2400969 C44.2419831,44.4845327 42.1705465,44.1001453 40.2415324,44.1001453 C33.6680113,44.1001453 30.3197296,48.5244358 29.4516732,49.8791671 L29.5192789,52.6619274 C36.3294197,52.3018305 42.4819831,49.6703535 47.1359549,45.5239128 L46.3986028,45.2400969 Z" id="Fill-5"></path><path d="M49.3275493,43.2795506 C53.0927324,39.0500107 55.4575775,33.7099235 55.8113803,27.8367225 L51.4832676,27.8367225 C49.2689577,28.6758121 47.6410141,30.0633569 46.8347042,31.9256329 C45.2644507,35.5670857 46.9270986,40.3173811 47.7140282,42.1903109 L49.3275493,43.2795506 Z" id="Fill-7"></path><path d="M16.046062,8.13963777 C20.6599211,8.13963777 24.7414986,7.04869346 26.3424,6.55904697 L26.3424,0.000170460048 C19.8198085,0.348761259 13.9128789,2.79145375 9.33868169,6.6451293 L10.3369915,7.58777337 C11.9067944,7.90823826 13.9128789,8.13963777 16.046062,8.13963777" id="Fill-9"></path><path d="M7.70582535,9.29574044 L7.08385352,8.77370654 C3.00002254,13.0923119 0.411628169,18.6684862 0.0429521127,24.8255031 L6.49072676,24.8255031 C11.2276282,18.4588203 7.85230423,9.67075254 7.70582535,9.29574044" id="Fill-11"></path><path d="M6.34780845,27.8365947 L0.0429070423,27.8365947 C0.412935211,33.9927593 2.99952676,39.5689337 7.08290704,43.887539 L9.97417839,41.1563429 C9.97778028,35.5507642 7.37811831,29.8667738 6.34780845,27.8365947" id="Fill-13"></path><path d="M12.8634141,24.8256736 C17.1762028,22.6514557 17.0261183,19.1634169 16.7484845,17.766923 L11.7177239,13.1244436 C12.1882592,16.1957075 12.254062,20.6979835 9.9315831,24.8256736 L12.8634141,24.8256736 Z" id="Fill-15"></path><path d="M13.7971831,10.8505065 L18.6422535,15.4235235 C19.5337465,15.5837559 20.6100282,15.7333346 21.5934648,15.7333346 C24.3594366,15.7333346 25.8409014,14.5482111 26.4732394,13.8416542 L26.3614648,9.47404165 C24.1588732,10.0962208 20.3977465,10.934032 16.0962254,10.934032 C15.3210141,10.934032 14.5494085,10.9050538 13.7971831,10.8505065" id="Fill-17"></path><path d="M41.6613859,24.8256736 L46.3753014,24.8256736 C44.5544563,23.29963 43.3163718,21.5485792 42.6876394,19.6040562 C42.1972732,18.0890925 42.1125408,16.4739835 42.4289352,14.7830199 L38.9531042,18.0673588 C38.9760901,18.1474751 38.910738,18.3170828 38.8954141,18.4986228 C38.7061183,20.6562208 40.6468507,23.5020513 41.6613859,24.8256736" id="Fill-19"></path><path d="M12.7555606,38.5327923 L17.2071662,34.3309521 C17.0530254,29.6173056 12.7055324,27.9787584 12.2038986,27.8057414 L9.59612394,27.8296058 C10.5912789,29.9816639 12.2462648,34.0816542 12.7555606,38.5327923" id="Fill-21"></path><path d="M46.2172845,27.8365947 L41.9004394,27.8365947 C38.0352,29.5646334 37.6029746,33.2550935 37.5912563,34.6933501 L43.6635944,39.135539 C43.1272563,36.6919942 42.9226366,33.6339409 44.1070873,30.8844203 C44.5970028,29.7410596 45.306862,28.7195777 46.2172845,27.8365947" id="Fill-23"></path><path d="M45.5075606,18.7829927 C46.6532507,22.3566877 50.5685183,24.3502179 51.7376451,24.8765133 L55.8349972,24.8317676 C55.4672225,18.673046 52.8801803,13.0943148 48.7949972,8.77485714 L48.1847437,9.35186441 L47.9224338,9.72900726 C45.4688,13.0917579 44.6588845,16.1374528 45.5075606,18.7829927" id="Fill-25"></path><path d="M29.5945014,42.8879613 L29.5286986,43.335845 L29.5327549,45.4930169 C31.5735437,43.6614237 35.1305014,41.4130557 40.2919662,41.4130557 C40.7354592,41.4130557 41.1830085,41.4296755 41.6341634,41.462063 L35.2923042,36.8251235 C30.4585014,37.3369298 29.6251493,42.6582663 29.5945014,42.8879613" id="Fill-27"></path><path d="M32.1713127,16.1228785 C32.5417915,16.2319729 32.9505803,16.2869462 33.3864113,16.2869462 C35.2847775,16.2869462 37.2480451,15.2326508 37.8037634,14.9100552 L41.4918761,11.4147719 C39.7634254,11.6551206 38.1237634,11.7769995 36.5963268,11.7769995 C33.7145239,11.7769995 31.3456225,11.3367864 29.5328901,10.4627525 L29.5328901,13.4862877 C30.1192563,14.8448542 31.0143549,15.7840891 32.1713127,16.1228785" id="Fill-29"></path><path d="M26.3422648,41.5732881 C24.648969,37.2640581 20.8373634,36.7778208 19.2747718,36.7778208 L18.9241239,36.7884746 L15.3054197,40.3536465 C17.9402366,40.863322 21.7130817,42.350586 26.3422648,46.2306828 L26.3422648,41.5732881 Z" id="Fill-31"></path><polygon id="Fill-33" points="27.9386592 34.3720329 36.4574197 26.3310063 27.9386592 18.2899797 19.4198986 26.3310063"></polygon></g><g class="css-13e8tc8"><path d="M53.5407775,0.00379273608 L45.8256225,0.00379273608 C45.6034254,0.00379273608 45.4114254,0.0800736077 45.2505239,0.232209201 C45.0896225,0.384770944 45.0089465,0.570998547 45.0089465,0.79174431 C45.0089465,1.01206392 45.0896225,1.19871768 45.2505239,1.35085327 C45.4114254,1.50341501 45.6034254,1.57926973 45.8256225,1.57926973 L48.5582423,1.57926973 C48.647031,1.57926973 48.6916507,1.61634479 48.6916507,1.68964262 L48.6916507,9.87513414 C48.6916507,10.127415 48.7858479,10.3456039 48.9751437,10.5288484 C49.163538,10.7129453 49.3970028,10.8049937 49.6746366,10.8049937 L49.6913127,10.8049937 C49.9581296,10.8049937 50.1884394,10.7129453 50.3831437,10.5288484 C50.5769465,10.3456039 50.6742986,10.127415 50.6742986,9.87513414 L50.6742986,1.68964262 C50.6742986,1.61634479 50.7135099,1.57926973 50.791031,1.57926973 L53.5407775,1.57926973 C53.7737915,1.57926973 53.9707493,1.50341501 54.1321014,1.35085327 C54.2930028,1.19871768 54.3736789,1.01206392 54.3736789,0.79174431 C54.3736789,0.570998547 54.2930028,0.384770944 54.1321014,0.232209201 C53.9707493,0.0800736077 53.7737915,0.00379273608 53.5407775,0.00379273608" id="Fill-35"></path><path d="M62.5289014,4.67316223 C61.895662,4.16732203 61.0830423,3.84856174 60.1978592,3.84472639 C60.192,3.84472639 56.8455211,3.84387409 56.8455211,3.84387409 L56.8455211,1.5908184 L61.8821408,1.5908184 C62.3468169,1.5908184 62.7209014,1.2345569 62.7209014,0.795196126 C62.7209014,0.356261501 62.3445634,9.9475983e-14 61.880338,9.9475983e-14 C61.8695211,9.9475983e-14 55.1661972,0.000426150121 55.1661972,0.000426150121 L55.1612394,5.45642615 C55.1612394,5.45642615 60.2442817,5.45813075 60.2587042,5.45898305 C61.2232113,5.50628571 61.9997746,6.45745278 61.9997746,7.30719613 C61.9997746,8.13435351 61.2633239,9.14646005 60.3335211,9.22018402 C60.3033239,9.22487167 55.2189296,9.21890557 55.2009014,9.22061017 C54.7610141,9.24617918 54.3743099,9.59349153 54.3743099,10.0158063 C54.3743099,10.0294431 54.3734085,10.0362615 54.3743099,10.0498983 C54.4009014,10.4700823 54.8250141,10.8105763 55.2748169,10.8105763 C55.3248451,10.8105763 60.1807324,10.8050363 60.1807324,10.8050363 C61.0397746,10.8050363 61.8294085,10.5399709 62.456338,10.1023148 C63.308169,9.50783535 63.8580282,8.32569492 63.8580282,7.30719613 C63.8580282,6.31682324 63.340169,5.32133656 62.5289014,4.67316223" id="Fill-37"></path><path d="M19.8986366,1.07875642 C20.091538,1.07875642 20.2492845,0.929177724 20.2492845,0.747211622 C20.2492845,0.56481937 20.091538,0.415666828 19.8986366,0.415666828 L12.4863549,0.415666828 L12.4859042,0.415666828 C12.2930028,0.415666828 12.135707,0.56481937 12.135707,0.747211622 L12.135707,10.4732358 C12.135707,10.5188339 12.1451718,10.5623012 12.1632,10.6023593 C12.2168338,10.7208291 12.3412282,10.8047806 12.4859042,10.8047806 L19.8986366,10.8047806 C20.091538,10.8047806 20.2492845,10.6556281 20.2492845,10.4732358 C20.2492845,10.2908436 20.091538,10.1421172 19.8986366,10.1421172 L12.8365521,10.1421172 L12.8365521,5.53884358 L19.4682141,5.53884358 C19.6444394,5.53884358 19.7882141,5.40247554 19.7882141,5.236277 L19.7882141,5.17874673 C19.7882141,5.01212203 19.6444394,4.875754 19.4682141,4.875754 L12.8365521,4.875754 L12.8365521,1.07875642 L19.8986366,1.07875642 Z" id="Fill-39"></path><path d="M10.1354366,0.415794673 L0.350647887,0.415794673 C0.157746479,0.415794673 -1.04805054e-13,0.564947215 -1.04805054e-13,0.746913317 C-1.04805054e-13,0.929305569 0.157746479,1.07888426 0.350647887,1.07888426 L4.89239437,1.07888426 L4.89239437,10.4733637 C4.89239437,10.6553298 5.05014085,10.8049085 5.24304225,10.8049085 C5.43594366,10.8049085 5.59369014,10.6553298 5.59369014,10.4733637 L5.59369014,1.07888426 L10.1354366,1.07888426 C10.328338,1.07888426 10.4860845,0.929305569 10.4860845,0.746913317 C10.4860845,0.564947215 10.328338,0.415794673 10.1354366,0.415794673" id="Fill-41"></path><path d="M24.5099718,6.72980533 L27.1776901,1.32025569 L29.8454085,6.72980533 L24.5099718,6.72980533 Z M27.5341972,0.47477385 C27.4692958,0.343093462 27.3232676,0.274909443 27.1776901,0.289824697 C27.0325634,0.274909443 26.8860845,0.343093462 26.8211831,0.47477385 L21.9643944,10.322677 C21.8828169,10.4875971 21.9589859,10.6861831 22.1338592,10.7633162 C22.3087324,10.8404494 22.5183099,10.76843 22.5998873,10.6030838 L24.1827606,7.39289492 L30.172169,7.39289492 L31.755493,10.6030838 C31.8370704,10.76843 32.0466479,10.8404494 32.2215211,10.7633162 C32.3963944,10.6861831 32.4725634,10.4875971 32.3909859,10.322677 L27.5341972,0.47477385 Z" id="Fill-43"></path><path d="M42.8502085,0.161510896 L42.8466028,0.161510896 C42.7375324,0.161510896 42.6433352,0.21264891 42.5793352,0.288077482 C42.5599549,0.306828087 42.5383211,0.323447942 42.5234479,0.347738499 L38.6347718,6.71612591 L34.7726873,0.391205811 C34.7298704,0.254837772 34.6014197,0.152561743 34.4436732,0.152561743 L34.4400676,0.152561743 C34.2480676,0.152561743 34.0912225,0.300861985 34.0912225,0.482401937 L34.0912225,10.466247 C34.0912225,10.6473608 34.2480676,10.795661 34.4400676,10.795661 L34.4436732,10.795661 C34.6352225,10.795661 34.7925183,10.6473608 34.7925183,10.466247 L34.7925183,1.74934625 L38.3300958,7.54243099 C38.3350535,7.55138015 38.3440676,7.55649395 38.3503775,7.56416465 C38.3589408,7.576523 38.3706592,7.58632446 38.3810254,7.59740436 C38.4017577,7.61828571 38.4224901,7.63788862 38.4472789,7.65280387 C38.4526873,7.65578692 38.4553915,7.66132688 38.4608,7.66388378 C38.4720676,7.66984988 38.4842366,7.67027603 38.4959549,7.67538983 C38.520293,7.68476513 38.5437296,7.69414044 38.5698704,7.69882809 C38.5919549,7.70223729 38.6126873,7.70266344 38.6347718,7.70266344 C38.6568563,7.70266344 38.6780394,7.70223729 38.6996732,7.69882809 C38.7258141,7.69414044 38.7492507,7.68476513 38.7735887,7.67538983 C38.7848563,7.67027603 38.7974761,7.66984988 38.8087437,7.66388378 C38.8141521,7.66132688 38.817307,7.65578692 38.8222648,7.65280387 C38.8475042,7.63788862 38.8677859,7.61828571 38.8885183,7.59740436 C38.8988845,7.58632446 38.9106028,7.576523 38.9191662,7.56416465 C38.9254761,7.55649395 38.9344901,7.55138015 38.9394479,7.54243099 L42.4977577,1.71525424 L42.4977577,10.4751961 C42.4977577,10.6563099 42.6546028,10.8050363 42.8466028,10.8050363 L42.8502085,10.8050363 C43.0422085,10.8050363 43.1990535,10.6563099 43.1990535,10.4751961 L43.1990535,0.49135109 C43.1990535,0.310237288 43.0422085,0.161510896 42.8502085,0.161510896" id="Fill-45"></path></g></g></g></g></g></svg></a><nav class="css-l5nqew"><div class="css-1d9x1rz"><div class="css-1xglul2 light"><div class="css-kknodv"><svg height="24" width="24" viewBox="0 0 24 24"><rect x="2" y="6" width="20" height="2" rx="1"></rect><rect x="2" y="11" width="20" height="2" rx="1"></rect><rect x="2" y="16" width="20" height="2" rx="1"></rect></svg></div></div></div><div class="css-jvtqvi disable-pointer-events"><div class="css-1umzfw"><div class="css-oro646"><div class="
              css-1wdsbza
              
            "></div><div class="
                css-1e542ht
                
              "><div class="css-x716e4"><div class="collapse css-23jkpm"><style data-emotion="css pi1u99">.css-pi1u99{-webkit-text-decoration:none;text-decoration:none;}.css-pi1u99.light{color:#fff;}.css-pi1u99.dark{color:#4c433f;}</style><a class="light css-pi1u99"><span>ソリューション</span></a><div class="drop-icon dropdown-action-icon light show"><svg width="12px" height="7px" viewBox="0 0 12 7"><g id="Symbols" stroke="none" stroke-width="1"><g id="icon/down" transform="translate(-2.000000, -6.000000)"><g id="color/sonar_red" transform="translate(2.000000, 6.000000)"><path d="M0.295367042,0.295011084 C0.689189766,-0.0983370279 1.32770256,-0.0983370279 1.72152528,0.295011084 L6,4.56832964 L10.2784747,0.295011084 C10.6722974,-0.0983370279 11.3108102,-0.0983370279 11.704633,0.295011084 C12.0984557,0.688359195 12.0984557,1.32610249 11.704633,1.7194506 L6.71307912,6.70498892 C6.3192564,7.09833703 5.6807436,7.09833703 5.28692088,6.70498892 L0.295367042,1.7194506 C-0.0984556808,1.32610249 -0.0984556808,0.688359195 0.295367042,0.295011084 Z" id="Mask"></path></g></g></g></svg></div><div class="close-icon dropdown-action-icon"><img src="/images/icons/close.svg" alt="close icon"/></div></div><div class="css-1uptx9b"><div class="css-h7wgr8"><style data-emotion="css pi1u99">.css-pi1u99{-webkit-text-decoration:none;text-decoration:none;}.css-pi1u99.light{color:#fff;}.css-pi1u99.dark{color:#4c433f;}</style><a class="light css-pi1u99" href="/jp/products/threatsonar"><div class="css-frvq03"><div class="dropdown-item-image product css-1xyp7ut"><img src="/images/icons/ThreatSonar.svg" alt="threat-sonar"/></div><div class="css-brgklg">ThreatSonar</div><div class="css-redxgc"><div style="display:flex;justify-content:center;align-items:center;transform:rotate(180deg)"><svg width="40px" height="40px" viewBox="0 0 40 40"><g fill="#4c433f" transform="translate(5.000000, 5.000000)"><path d="M30,15 C30,15.4807835 29.627203,15.8770378 29.1469257,15.9311926 L29.0343052,15.9374971 L3.20017573,15.9367054 L15.3022515,28.4199682 C15.6677828,28.797006 15.6492627,29.3903257 15.2608856,29.7451848 C14.9023837,30.0727471 14.3540519,30.0826245 13.9843141,29.7856554 L13.8958136,29.7050268 L0.262475843,15.6425293 C-0.058327965,15.311627 -0.0850616157,14.8108998 0.182274891,14.4516934 L0.262475843,14.3574707 L13.8958136,0.294973235 C14.261345,-0.0820645885 14.8725086,-0.100043974 15.2608856,0.254815155 C15.6193876,0.582377427 15.6627451,1.11312505 15.3797938,1.48939075 L15.3022515,1.58003182 L3.20210712,14.0617057 L29.0343052,14.0624975 C29.5676437,14.0624975 30,14.4822331 30,15 Z"></path></g></svg></div></div></div></a><style data-emotion="css pi1u99">.css-pi1u99{-webkit-text-decoration:none;text-decoration:none;}.css-pi1u99.light{color:#fff;}.css-pi1u99.dark{color:#4c433f;}</style><a class="light css-pi1u99" href="/jp/products/threatvision"><div class="css-frvq03"><div class="dropdown-item-image product css-4cvnva"><img src="/images/icons/ThreatVision.svg" alt="threat-vision"/></div><div class="css-brgklg">ThreatVision</div><div class="css-redxgc"><div style="display:flex;justify-content:center;align-items:center;transform:rotate(180deg)"><svg width="40px" height="40px" viewBox="0 0 40 40"><g fill="#4c433f" transform="translate(5.000000, 5.000000)"><path d="M30,15 C30,15.4807835 29.627203,15.8770378 29.1469257,15.9311926 L29.0343052,15.9374971 L3.20017573,15.9367054 L15.3022515,28.4199682 C15.6677828,28.797006 15.6492627,29.3903257 15.2608856,29.7451848 C14.9023837,30.0727471 14.3540519,30.0826245 13.9843141,29.7856554 L13.8958136,29.7050268 L0.262475843,15.6425293 C-0.058327965,15.311627 -0.0850616157,14.8108998 0.182274891,14.4516934 L0.262475843,14.3574707 L13.8958136,0.294973235 C14.261345,-0.0820645885 14.8725086,-0.100043974 15.2608856,0.254815155 C15.6193876,0.582377427 15.6627451,1.11312505 15.3797938,1.48939075 L15.3022515,1.58003182 L3.20210712,14.0617057 L29.0343052,14.0624975 C29.5676437,14.0624975 30,14.4822331 30,15 Z"></path></g></svg></div></div></div></a></div></div></div><div class="css-x716e4"><div class="collapse css-23jkpm"><style data-emotion="css pi1u99">.css-pi1u99{-webkit-text-decoration:none;text-decoration:none;}.css-pi1u99.light{color:#fff;}.css-pi1u99.dark{color:#4c433f;}</style><a class="light css-pi1u99"><span>TeamT5について</span></a><div class="drop-icon dropdown-action-icon light show"><svg width="12px" height="7px" viewBox="0 0 12 7"><g id="Symbols" stroke="none" stroke-width="1"><g id="icon/down" transform="translate(-2.000000, -6.000000)"><g id="color/sonar_red" transform="translate(2.000000, 6.000000)"><path d="M0.295367042,0.295011084 C0.689189766,-0.0983370279 1.32770256,-0.0983370279 1.72152528,0.295011084 L6,4.56832964 L10.2784747,0.295011084 C10.6722974,-0.0983370279 11.3108102,-0.0983370279 11.704633,0.295011084 C12.0984557,0.688359195 12.0984557,1.32610249 11.704633,1.7194506 L6.71307912,6.70498892 C6.3192564,7.09833703 5.6807436,7.09833703 5.28692088,6.70498892 L0.295367042,1.7194506 C-0.0984556808,1.32610249 -0.0984556808,0.688359195 0.295367042,0.295011084 Z" id="Mask"></path></g></g></g></svg></div><div class="close-icon dropdown-action-icon"><img src="/images/icons/close.svg" alt="close icon"/></div></div><div class="css-1uptx9b"><div class="css-h7wgr8"><style data-emotion="css pi1u99">.css-pi1u99{-webkit-text-decoration:none;text-decoration:none;}.css-pi1u99.light{color:#fff;}.css-pi1u99.dark{color:#4c433f;}</style><a class="light css-pi1u99" href="/jp/about-us"><div class="css-frvq03"><div class="dropdown-item-image css-150aek"><img src="https://res.cloudinary.com/dvgomg5gh/image/upload/q_90/w_200,c_scale/f_auto/v1597723059/about_cover_59b796ac5a.jpg" alt="about-us"/></div><div class="css-brgklg">会社概要</div><div class="css-redxgc"><div style="display:flex;justify-content:center;align-items:center;transform:rotate(180deg)"><svg width="40px" height="40px" viewBox="0 0 40 40"><g fill="#4c433f" transform="translate(5.000000, 5.000000)"><path d="M30,15 C30,15.4807835 29.627203,15.8770378 29.1469257,15.9311926 L29.0343052,15.9374971 L3.20017573,15.9367054 L15.3022515,28.4199682 C15.6677828,28.797006 15.6492627,29.3903257 15.2608856,29.7451848 C14.9023837,30.0727471 14.3540519,30.0826245 13.9843141,29.7856554 L13.8958136,29.7050268 L0.262475843,15.6425293 C-0.058327965,15.311627 -0.0850616157,14.8108998 0.182274891,14.4516934 L0.262475843,14.3574707 L13.8958136,0.294973235 C14.261345,-0.0820645885 14.8725086,-0.100043974 15.2608856,0.254815155 C15.6193876,0.582377427 15.6627451,1.11312505 15.3797938,1.48939075 L15.3022515,1.58003182 L3.20210712,14.0617057 L29.0343052,14.0624975 C29.5676437,14.0624975 30,14.4822331 30,15 Z"></path></g></svg></div></div></div></a><style data-emotion="css pi1u99">.css-pi1u99{-webkit-text-decoration:none;text-decoration:none;}.css-pi1u99.light{color:#fff;}.css-pi1u99.dark{color:#4c433f;}</style><a class="light css-pi1u99" href="/jp/careers"><div class="css-frvq03"><div class="dropdown-item-image css-150aek"><img src="https://res.cloudinary.com/dvgomg5gh/image/upload/q_90/w_200,c_scale/f_auto/v1597723058/TeamT5_Careers_img_b6492dddfd.jpg" alt="careers"/></div><div class="css-brgklg">キャリア採用</div><div class="css-redxgc"><div style="display:flex;justify-content:center;align-items:center;transform:rotate(180deg)"><svg width="40px" height="40px" viewBox="0 0 40 40"><g fill="#4c433f" transform="translate(5.000000, 5.000000)"><path d="M30,15 C30,15.4807835 29.627203,15.8770378 29.1469257,15.9311926 L29.0343052,15.9374971 L3.20017573,15.9367054 L15.3022515,28.4199682 C15.6677828,28.797006 15.6492627,29.3903257 15.2608856,29.7451848 C14.9023837,30.0727471 14.3540519,30.0826245 13.9843141,29.7856554 L13.8958136,29.7050268 L0.262475843,15.6425293 C-0.058327965,15.311627 -0.0850616157,14.8108998 0.182274891,14.4516934 L0.262475843,14.3574707 L13.8958136,0.294973235 C14.261345,-0.0820645885 14.8725086,-0.100043974 15.2608856,0.254815155 C15.6193876,0.582377427 15.6627451,1.11312505 15.3797938,1.48939075 L15.3022515,1.58003182 L3.20210712,14.0617057 L29.0343052,14.0624975 C29.5676437,14.0624975 30,14.4822331 30,15 Z"></path></g></svg></div></div></div></a></div></div></div><div class="css-gf2gsr"><style data-emotion="css pi1u99">.css-pi1u99{-webkit-text-decoration:none;text-decoration:none;}.css-pi1u99.light{color:#fff;}.css-pi1u99.dark{color:#4c433f;}</style><a class="css-17d51iu collapse light css-pi1u99" href="/jp/news-and-events">最新情報</a></div><div class="css-gf2gsr"><style data-emotion="css pi1u99">.css-pi1u99{-webkit-text-decoration:none;text-decoration:none;}.css-pi1u99.light{color:#fff;}.css-pi1u99.dark{color:#4c433f;}</style><a class="css-17d51iu collapse light css-pi1u99" href="/jp/blog">ブログ</a></div><div class="css-x716e4"><div class="collapse css-23jkpm"><style data-emotion="css pi1u99">.css-pi1u99{-webkit-text-decoration:none;text-decoration:none;}.css-pi1u99.light{color:#fff;}.css-pi1u99.dark{color:#4c433f;}</style><a class="light css-pi1u99"><span>お問い合わせ</span></a><div class="drop-icon dropdown-action-icon light show"><svg width="12px" height="7px" viewBox="0 0 12 7"><g id="Symbols" stroke="none" stroke-width="1"><g id="icon/down" transform="translate(-2.000000, -6.000000)"><g id="color/sonar_red" transform="translate(2.000000, 6.000000)"><path d="M0.295367042,0.295011084 C0.689189766,-0.0983370279 1.32770256,-0.0983370279 1.72152528,0.295011084 L6,4.56832964 L10.2784747,0.295011084 C10.6722974,-0.0983370279 11.3108102,-0.0983370279 11.704633,0.295011084 C12.0984557,0.688359195 12.0984557,1.32610249 11.704633,1.7194506 L6.71307912,6.70498892 C6.3192564,7.09833703 5.6807436,7.09833703 5.28692088,6.70498892 L0.295367042,1.7194506 C-0.0984556808,1.32610249 -0.0984556808,0.688359195 0.295367042,0.295011084 Z" id="Mask"></path></g></g></g></svg></div><div class="close-icon dropdown-action-icon"><img src="/images/icons/close.svg" alt="close icon"/></div></div><div class="css-1uptx9b"><div class="css-h7wgr8"><style data-emotion="css pi1u99">.css-pi1u99{-webkit-text-decoration:none;text-decoration:none;}.css-pi1u99.light{color:#fff;}.css-pi1u99.dark{color:#4c433f;}</style><a class="light css-pi1u99" href="/jp/request-information"><div class="css-frvq03"><div class="dropdown-item-image css-150aek"><img src="https://res.cloudinary.com/dvgomg5gh/image/upload/q_90/w_200,c_scale/f_auto/v1597723058/info_9e3a7cbe05.jpg" alt="request-information"/></div><div class="css-brgklg">インフォメーション</div><div class="css-redxgc"><div style="display:flex;justify-content:center;align-items:center;transform:rotate(180deg)"><svg width="40px" height="40px" viewBox="0 0 40 40"><g fill="#4c433f" transform="translate(5.000000, 5.000000)"><path d="M30,15 C30,15.4807835 29.627203,15.8770378 29.1469257,15.9311926 L29.0343052,15.9374971 L3.20017573,15.9367054 L15.3022515,28.4199682 C15.6677828,28.797006 15.6492627,29.3903257 15.2608856,29.7451848 C14.9023837,30.0727471 14.3540519,30.0826245 13.9843141,29.7856554 L13.8958136,29.7050268 L0.262475843,15.6425293 C-0.058327965,15.311627 -0.0850616157,14.8108998 0.182274891,14.4516934 L0.262475843,14.3574707 L13.8958136,0.294973235 C14.261345,-0.0820645885 14.8725086,-0.100043974 15.2608856,0.254815155 C15.6193876,0.582377427 15.6627451,1.11312505 15.3797938,1.48939075 L15.3022515,1.58003182 L3.20210712,14.0617057 L29.0343052,14.0624975 C29.5676437,14.0624975 30,14.4822331 30,15 Z"></path></g></svg></div></div></div></a><style data-emotion="css pi1u99">.css-pi1u99{-webkit-text-decoration:none;text-decoration:none;}.css-pi1u99.light{color:#fff;}.css-pi1u99.dark{color:#4c433f;}</style><a class="light css-pi1u99" href="/jp/become-a-partner"><div class="css-frvq03"><div class="dropdown-item-image css-150aek"><img src="https://res.cloudinary.com/dvgomg5gh/image/upload/q_90/w_200,c_scale/f_auto/v1602841516/partner_c95a01f8af.jpg" alt="partner"/></div><div class="css-brgklg">パートナー募集</div><div class="css-redxgc"><div style="display:flex;justify-content:center;align-items:center;transform:rotate(180deg)"><svg width="40px" height="40px" viewBox="0 0 40 40"><g fill="#4c433f" transform="translate(5.000000, 5.000000)"><path d="M30,15 C30,15.4807835 29.627203,15.8770378 29.1469257,15.9311926 L29.0343052,15.9374971 L3.20017573,15.9367054 L15.3022515,28.4199682 C15.6677828,28.797006 15.6492627,29.3903257 15.2608856,29.7451848 C14.9023837,30.0727471 14.3540519,30.0826245 13.9843141,29.7856554 L13.8958136,29.7050268 L0.262475843,15.6425293 C-0.058327965,15.311627 -0.0850616157,14.8108998 0.182274891,14.4516934 L0.262475843,14.3574707 L13.8958136,0.294973235 C14.261345,-0.0820645885 14.8725086,-0.100043974 15.2608856,0.254815155 C15.6193876,0.582377427 15.6627451,1.11312505 15.3797938,1.48939075 L15.3022515,1.58003182 L3.20210712,14.0617057 L29.0343052,14.0624975 C29.5676437,14.0624975 30,14.4822331 30,15 Z"></path></g></svg></div></div></div></a></div></div></div><div class="css-1nae23b"><style data-emotion="css 11g9kr1">.css-11g9kr1{-webkit-text-decoration:none;text-decoration:none;}</style><a class="css-3n5iv4 css-11g9kr1" href="https://www.facebook.com/TeamT5.org/"><div class="css-6tkolk"><svg width="24px" height="24px" viewBox="0 0 24 24" version="1.1"><g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path class="light" d="M22,0 C23.1045695,-2.02906125e-16 24,0.8954305 24,2 L24,22 C24,23.0543618 23.1841222,23.9181651 22.1492623,23.9945143 L22,24 L22,24 L14,24 L14,23.978 L13.875,24 L13.875,15.5633307 L16.6710937,15.5633307 L17.203125,12.0733717 L13.875,12.0733717 L13.875,9.80860051 C13.875,8.85381375 14.3398828,7.92315016 15.8305781,7.92315016 L15.8305781,7.92315016 L17.34375,7.92315016 L17.34375,4.95196885 C17.34375,4.95196885 15.9704766,4.71616081 14.6575781,4.71616081 C11.9165156,4.71616081 10.125,6.3875682 10.125,9.41345698 L10.125,9.41345698 L10.125,12.0733717 L7.078125,12.0733717 L7.078125,15.5633307 L10.125,15.5633307 L10.125,24 C10.0832306,23.9934058 10.0415327,23.9865949 9.99990751,23.9795684 L10,24 L2,24 C0.8954305,24 1.3527075e-16,23.1045695 0,22 L0,2 C-1.3527075e-16,0.8954305 0.8954305,2.02906125e-16 2,0 L22,0 Z" id="path-1"></path></g></svg></div></a><style data-emotion="css 11g9kr1">.css-11g9kr1{-webkit-text-decoration:none;text-decoration:none;}</style><a class="css-3n5iv4 css-11g9kr1" href="https://www.linkedin.com/company/teamt5/"><div class="css-6tkolk"><svg width="24px" height="24px" viewBox="0 0 24 24"><g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="sns/linkedin/nor"><path class="light" d="M21,0 C22.6568542,-3.04359188e-16 24,1.34314575 24,3 L24,21 C24,22.6568542 22.6568542,24 21,24 L3,24 C1.34314575,24 2.02906125e-16,22.6568542 0,21 L0,3 C-2.02906125e-16,1.34314575 1.34314575,3.04359188e-16 3,0 L21,0 Z M19.0257087,9.0309163 C16.1146435,7.90189457 14.1125239,9.13845978 13.5311978,10.2828185 L13.5311978,10.2828185 L13.4415783,10.4056989 L13.3876217,10.4056989 L13.3876217,8.83634022 L10.0184804,8.83634022 L10.0184804,20.1829163 L13.5311978,20.1829163 L13.5316179,14.0152782 C13.5352018,13.9482549 13.5643166,13.4915116 13.7156109,12.9431337 C13.879513,12.3490576 14.4018935,11.8678837 15.0368065,11.7243076 C15.6717196,11.5811011 16.2554478,11.7243076 16.5934152,11.8678837 C16.9313826,12.0110902 17.1054478,12.3643946 17.1745565,12.471938 C17.2436652,12.5794815 17.458937,13.2476554 17.458937,13.6240576 L17.458937,13.6240576 L17.458937,20.1829163 L20.9921652,20.1829163 L20.9927319,13.1625978 C21.0044427,12.9799919 21.1719641,9.86344891 19.0257087,9.0309163 Z M7.82684783,8.83641413 L4.2731087,8.83641413 L4.2731087,20.1828054 L7.82684783,20.1828054 L7.82684783,8.83641413 Z M6.05809022,3.18481957 C4.92149239,3.18481957 3.99998152,4.10614565 3.99998152,5.24292826 C3.99998152,6.37952609 4.92149239,7.30085217 6.05809022,7.30085217 C7.19468804,7.30085217 8.11619891,6.37952609 8.11619891,5.24292826 C8.11619891,4.10614565 7.19468804,3.18481957 6.05809022,3.18481957 Z" id="Combined-Shape"></path></g></g></svg></div></a><style data-emotion="css 11g9kr1">.css-11g9kr1{-webkit-text-decoration:none;text-decoration:none;}</style><a class="css-3n5iv4 css-11g9kr1" href="https://twitter.com/teamt5_official/"><div class="css-6tkolk"><svg width="24px" height="24px" viewBox="0 0 24 24"><g id="sns/twitter/hover" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path class="light" d="M3,0 L21,0 C22.6568542,-3.04359188e-16 24,1.34314575 24,3 L24,21 C24,22.6568542 22.6568542,24 21,24 L3,24 C1.34314575,24 2.02906125e-16,22.6568542 0,21 L0,3 C-2.02906125e-16,1.34314575 1.34314575,3.04359188e-16 3,0 Z M9.40543979,19.2 C15.5354921,19.2 18.8873246,14.1204188 18.8873246,9.71811518 C18.8873246,9.57298429 18.8873246,9.4278534 18.8804136,9.28963351 C19.5300471,8.81968586 20.0967487,8.23225131 20.5459634,7.56188482 C19.9516178,7.82450262 19.3088953,8.00418848 18.6316178,8.08712042 C19.3227173,7.67246073 19.8479529,7.02282723 20.0967487,6.24188482 C19.4540262,6.62198953 18.7421937,6.89842932 17.9819843,7.0504712 C17.3738168,6.4008377 16.5099424,6 15.5493141,6 C13.7109895,6 12.2182147,7.49277487 12.2182147,9.33109948 C12.2182147,9.59371728 12.2458586,9.84942408 12.3080576,10.0913089 C9.53674869,9.95308901 7.08334555,8.62617801 5.4385288,6.60816754 C5.15517801,7.09884817 4.98931414,7.67246073 4.98931414,8.28062827 C4.98931414,9.4347644 5.57674869,10.4575916 6.47517801,11.0519372 C5.92920942,11.0381152 5.41779581,10.8860733 4.96858115,10.6372775 C4.96858115,10.6510995 4.96858115,10.6649215 4.96858115,10.6787435 C4.96858115,12.2959162 6.11580628,13.6366492 7.64313613,13.947644 C7.36669634,14.0236649 7.06952356,14.0651309 6.76543979,14.0651309 C6.55119895,14.0651309 6.34386911,14.0443979 6.13653927,14.0029319 C6.55810995,15.3298429 7.78826702,16.2904712 9.24648691,16.3181152 C8.10617277,17.2096335 6.66868586,17.7417801 5.10680105,17.7417801 C4.83727225,17.7417801 4.57465445,17.7279581 4.31203665,17.6934031 C5.77025654,18.6471204 7.52564921,19.2 9.40543979,19.2"></path></g></svg></div></a></div></div></div></div></div></nav></div><div class="css-1b3tozc"></div></header></div><main class="css-iwv7r0"><div class="css-ht0vth"><div class="css-w4jotj" style="background-image:url(https://res.cloudinary.com/dvgomg5gh/image/upload/f_auto/v1590731286/20200608_cover_23a0b23713.jpg)"></div><div class="css-1vd4pj2"><div class="css-f24dyb"><div style="background-color:#64cda2" class="css-1f7e94x">技術分析</div><a class="css-cf47rh">RSS</a></div><h1>BlackHat&#x27;s Talk: Breaking Samsung&#x27;s Root of Trust - Exploiting Samsung Secure Boot</h1></div></div><div class="css-14r7lg1 default"><div class="css-8x5obk"><div class="css-t9u2dq"><div class="css-1isrddr"><div class="css-4api5d"><div>2020. 06. 10</div><div class="css-57sp39"></div><div>D39</div></div><div class="css-k6q0dt">Share:<div class="css-3ostf4"><a class="css-8xetqx"><button aria-label="linkedin" class="react-share__ShareButton share" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><div class="css-6tkolk"><svg width="24px" height="24px" viewBox="0 0 24 24"><g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="sns/linkedin/nor"><path class="dark" d="M21,0 C22.6568542,-3.04359188e-16 24,1.34314575 24,3 L24,21 C24,22.6568542 22.6568542,24 21,24 L3,24 C1.34314575,24 2.02906125e-16,22.6568542 0,21 L0,3 C-2.02906125e-16,1.34314575 1.34314575,3.04359188e-16 3,0 L21,0 Z M19.0257087,9.0309163 C16.1146435,7.90189457 14.1125239,9.13845978 13.5311978,10.2828185 L13.5311978,10.2828185 L13.4415783,10.4056989 L13.3876217,10.4056989 L13.3876217,8.83634022 L10.0184804,8.83634022 L10.0184804,20.1829163 L13.5311978,20.1829163 L13.5316179,14.0152782 C13.5352018,13.9482549 13.5643166,13.4915116 13.7156109,12.9431337 C13.879513,12.3490576 14.4018935,11.8678837 15.0368065,11.7243076 C15.6717196,11.5811011 16.2554478,11.7243076 16.5934152,11.8678837 C16.9313826,12.0110902 17.1054478,12.3643946 17.1745565,12.471938 C17.2436652,12.5794815 17.458937,13.2476554 17.458937,13.6240576 L17.458937,13.6240576 L17.458937,20.1829163 L20.9921652,20.1829163 L20.9927319,13.1625978 C21.0044427,12.9799919 21.1719641,9.86344891 19.0257087,9.0309163 Z M7.82684783,8.83641413 L4.2731087,8.83641413 L4.2731087,20.1828054 L7.82684783,20.1828054 L7.82684783,8.83641413 Z M6.05809022,3.18481957 C4.92149239,3.18481957 3.99998152,4.10614565 3.99998152,5.24292826 C3.99998152,6.37952609 4.92149239,7.30085217 6.05809022,7.30085217 C7.19468804,7.30085217 8.11619891,6.37952609 8.11619891,5.24292826 C8.11619891,4.10614565 7.19468804,3.18481957 6.05809022,3.18481957 Z" id="Combined-Shape"></path></g></g></svg></div></button></a><a class="css-8xetqx"><button aria-label="twitter" class="react-share__ShareButton share" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><div class="css-6tkolk"><svg width="24px" height="24px" viewBox="0 0 24 24"><g id="sns/twitter/hover" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path class="dark" d="M3,0 L21,0 C22.6568542,-3.04359188e-16 24,1.34314575 24,3 L24,21 C24,22.6568542 22.6568542,24 21,24 L3,24 C1.34314575,24 2.02906125e-16,22.6568542 0,21 L0,3 C-2.02906125e-16,1.34314575 1.34314575,3.04359188e-16 3,0 Z M9.40543979,19.2 C15.5354921,19.2 18.8873246,14.1204188 18.8873246,9.71811518 C18.8873246,9.57298429 18.8873246,9.4278534 18.8804136,9.28963351 C19.5300471,8.81968586 20.0967487,8.23225131 20.5459634,7.56188482 C19.9516178,7.82450262 19.3088953,8.00418848 18.6316178,8.08712042 C19.3227173,7.67246073 19.8479529,7.02282723 20.0967487,6.24188482 C19.4540262,6.62198953 18.7421937,6.89842932 17.9819843,7.0504712 C17.3738168,6.4008377 16.5099424,6 15.5493141,6 C13.7109895,6 12.2182147,7.49277487 12.2182147,9.33109948 C12.2182147,9.59371728 12.2458586,9.84942408 12.3080576,10.0913089 C9.53674869,9.95308901 7.08334555,8.62617801 5.4385288,6.60816754 C5.15517801,7.09884817 4.98931414,7.67246073 4.98931414,8.28062827 C4.98931414,9.4347644 5.57674869,10.4575916 6.47517801,11.0519372 C5.92920942,11.0381152 5.41779581,10.8860733 4.96858115,10.6372775 C4.96858115,10.6510995 4.96858115,10.6649215 4.96858115,10.6787435 C4.96858115,12.2959162 6.11580628,13.6366492 7.64313613,13.947644 C7.36669634,14.0236649 7.06952356,14.0651309 6.76543979,14.0651309 C6.55119895,14.0651309 6.34386911,14.0443979 6.13653927,14.0029319 C6.55810995,15.3298429 7.78826702,16.2904712 9.24648691,16.3181152 C8.10617277,17.2096335 6.66868586,17.7417801 5.10680105,17.7417801 C4.83727225,17.7417801 4.57465445,17.7279581 4.31203665,17.6934031 C5.77025654,18.6471204 7.52564921,19.2 9.40543979,19.2"></path></g></svg></div></button></a><a class="css-8xetqx"><button aria-label="facebook" class="react-share__ShareButton share" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><div class="css-6tkolk"><svg width="24px" height="24px" viewBox="0 0 24 24" version="1.1"><g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path class="dark" d="M22,0 C23.1045695,-2.02906125e-16 24,0.8954305 24,2 L24,22 C24,23.0543618 23.1841222,23.9181651 22.1492623,23.9945143 L22,24 L22,24 L14,24 L14,23.978 L13.875,24 L13.875,15.5633307 L16.6710937,15.5633307 L17.203125,12.0733717 L13.875,12.0733717 L13.875,9.80860051 C13.875,8.85381375 14.3398828,7.92315016 15.8305781,7.92315016 L15.8305781,7.92315016 L17.34375,7.92315016 L17.34375,4.95196885 C17.34375,4.95196885 15.9704766,4.71616081 14.6575781,4.71616081 C11.9165156,4.71616081 10.125,6.3875682 10.125,9.41345698 L10.125,9.41345698 L10.125,12.0733717 L7.078125,12.0733717 L7.078125,15.5633307 L10.125,15.5633307 L10.125,24 C10.0832306,23.9934058 10.0415327,23.9865949 9.99990751,23.9795684 L10,24 L2,24 C0.8954305,24 1.3527075e-16,23.1045695 0,22 L0,2 C-1.3527075e-16,0.8954305 0.8954305,2.02906125e-16 2,0 L22,0 Z" id="path-1"></path></g></svg></div></button></a></div></div></div><div class="css-17crpi9"><div class="css-x9vory"><div><h3 id="d39">D39</h3><p>D39 focuses on vulnerability research and has identified several critical security flaws, including technical exploitation of mobile, IoT devices, and Linux and Windows operating systems. We have reported dozens of vulnerabilities and dedicate to Samsung Vulnerabilities and Exposures (SVE) and Common Vulnerabilities and Exposures (CVE).</p><p>Before diving into the main subject this month, we are glad to announce that TeamT5 is again accepted at Black Hat USA, and our vulnerability research team, D39, will talk at the Black Hat Briefings in the upcoming August. We are honored to share our research findings with researchers and security experts all over the world and expect more recognition of Taiwan&#x27;s vulnerability researchers in the world.</p><p><img src="https://res.cloudinary.com/dvgomg5gh/image/upload/v1591769445/D39_6-1_6807f98c9b.png" class="css-1h5x3dy"/>
<a href="https://www.blackhat.com/us-20/briefings/schedule/index.html#breaking-samsungs-root-of-trust-exploiting-samsung-s-secure-boot-20290">Black Hat Session</a></p><p>This article will cover a part of our talk at Black Hat USA in August.</p><h3 id="introduction">Introduction</h3><p>We have found several vulnerabilities in Samsung Secure boot, which can break through Samsung Knox protections. We can even retrieve users&#x27; sensitive data from a locked device. The affected Samsung mobiles include Galaxy S8, S9, and S10. Patches to these vulnerabilities have been provided by Samsung.</p><p>One of these vulnerabilities allows attackers to execute arbitrary code in Galaxy S8 secure bootloader to access the device. In this article, we will elaborate how we exploit these vulnerabilities to bypass S8 secure bootloader through the USB device and obtain arbitrary code execution in early boot stage.</p><p>Note: Another security research team found this vulnerability at the same time and report it to Samsung.
ID: SVE-2019-15230 (details below).
<img src="https://res.cloudinary.com/dvgomg5gh/image/upload/v1591769435/SVE-2019_3bc5eea84d.png" class="css-1h5x3dy"/></p><h3 id="knox">KNOX</h3><p><img src="https://res.cloudinary.com/dvgomg5gh/image/upload/v1591769436/D39_6-2_ee457f68cd.png" class="css-1h5x3dy"/>
<a href="https://docs.samsungknox.com/whitepapers/knox-platform/hardware-backed-root-of-trust.htm">Image courtesy</a></p><p>As the market leader of smartphone, Samsung conducts a series of protection on Android, known as the Knox Platform, to ensure the security of its devices. During the booting process, Samsung uses S-boot (Secure Boot) to make sure it can only boot a stocked image. If the device tries to boot a custom image, it will trip (turned from 0X0 to 0X1) a one-time programmable bit e-fuse (a.k.a Knox bit). Once a trustzone app (trustlet) detects the Knox bit tripped, it will delete the encryption key of sensitive data to prevent unauthorized data from accessing the locked device.</p><h3 id="vulnerability">Vulnerability</h3><p>Smartphones with Samsung Exynos processor use a exclusive secure bootloader named S-boot. S-boot has ODIN mode which allows users to upgrade the firmware manually. Due to the insufficiency in its code, the flash command (opcode: 0x66) in ODIN mode is not able to properly check the flash image size, which leads to buffer overflow.</p><p>The flash command in ODIN mode uses a temporary buffer to store the image. In Galaxy S8, the buffer is located at 0xC0000000, right in front of sboot code segment (0xC9000000). Although the system will check to ensure that the size being no larger than 0x1e0000, it uses signed comparison to check the size of the image; thus provide us some space to get around. We therefore provide a size larger than 0x80000000, making buffer overflowed and, in the end, the following segments such as code, stack, and heap will be overwritten.</p><p><img src="https://res.cloudinary.com/dvgomg5gh/image/upload/v1591769435/D39_6-3_8b038e080e.png" class="css-1h5x3dy"/></p><h3 id="the-exploit">The Exploit</h3><h4 id="code-execution">Code Execution</h4><p>Although we can overflow the code segment of S-Boot, we still cannot hijack the execution flow. Since USB receivers use physical memory to hold the data it received directly, we cannot affect instruction cache unless the cache line has been invalidated.</p><p>Fortunately, the heap segment is not cached due to MMU flag. There are some pointers stored in the heap segment, which can be accessed during the USB process. If we overwrite these pointers with null bytes, the processor will trigger an exception and trap into the exception handler while accessing to NULL pointers. Since the handler has never been executed, it is not cached in the instruction cache. Therefore we can also overwrite the exception handler simultaneously and hijack it directly to our shellcode.</p><p><img src="https://res.cloudinary.com/dvgomg5gh/image/upload/v1591769437/D39_6-4_58c7cc6a95.png" class="css-1h5x3dy"/></p><h4 id="booting-custom-kernel">Booting Custom Kernel</h4><p>Since all the run-time data has been overwritten -- including stack, heap and global variables -- the sboot fail to perform further booting operation. These kinds of data are difficult to recover, so we must re-execute the booting process.</p><p>Under normal condition, S-boot calls several functions in a particular function table which is located at 0xC90C7350. To re-execute s-boot, these functions have to be invoked sequentially again. They would initialize the memory of heap and stack, set the global variables, and boot the kernel at the end. However, these functions also involve some SMC calls which cannot be executed twice. Since we only compromised EL1 (Exception Level 1), the trustzone in EL3 (Exception Level 3) cannot be reverted. As a result, we have to overwrite these SMC calls with NOP instruction while overflowing the code segment to ignore those SMC (System Management Controller) calls.</p><p>After all the run-time data has been reset, we replace the original kernel with our custom one. Then we execute one last function to boot our custom kernel and get the <strong>root privilege without blowing KNOX bit</strong>.</p><p><img src="https://res.cloudinary.com/dvgomg5gh/image/upload/v1591769436/D39_6-5_2f6b6f9ccd.png" class="css-1h5x3dy"/></p><h3 id="timeline">Timeline</h3><p>2019-10-02 Report Vulnerability
2019-10-08 Informed Vulnerability duplicated and release patch note</p><h3 id="appendix-potential-exploit-path-on-galaxy-s10">Appendix: Potential Exploit Path on Galaxy S10</h3><p>According to our analysis, this vulnerability affects Galaxy S9, Galaxy S10 and Galaxy Note 10 as well. Among them we find that exploitation can still be trigger at different address. For instance, even the temporary buffer located at different addresss, like 0x890000000 in Galaxy S10, there are still chances to exploit it. To explain the complete exploitation flow, we choose the firmware, G970FXXU1ASD5, as an example.</p><p>In Galaxy S9 and later version, there is another feature added to the secure boot - compressed<em>download. It uses another buffer to store the flash image. However if compressed</em>download failed during the initialization, it will fallback to normal download, and use the buffer (0xC0000000) to store the flash image.</p><p><img src="https://res.cloudinary.com/dvgomg5gh/image/upload/v1591769435/D39_6-6_724f86aa51.png" class="css-1h5x3dy"/></p><p>To make S-boot fallback to normal download, we have to make the function <code>cd_v3_smp_register</code> fail. After reversing, we noticed that the function <code>cd_v3_smp_register</code> may return failed if there is no available core(<code>booted_cores</code> &gt; 3) can be booted. Coincidentally, there is a test command - &quot;smp<em>boot</em>test&quot; in the UART (Universal Asynchronous Receiver/Transmitter) console. The command smp<em>boot</em>test will boot a core and add the count of the booted<em>cores. Although <code>smp_boot_test</code> shutdown the booted up core immediately, it didn&#x27;t restore the count. Therefore, the compressed</em>download<em>init may failed if the command `smp</em>boot_test` has been invoked more than twice before entering the download mode.</p><p>If we have the UART debug cable to get the UART console, we can call the command<code>smp_boot_test</code> 3 times and enter the download mode via the command <code>usb</code>. The <code>compressed_download_init</code> would fail, then the temporary buffer fallback to 0xC0000000. Therefore the arbitrary code execution on S10&#x27;s bootloader can be achieved as the one in Galaxy S8.</p><p>We managed to build our own TypeC debug cable at first. However, after trying every kinds of Pull-up/down resistor value, TypeC accessory mode, TypeC VDM, we cannot yet figure out a cable for RID_523K detection. Still, in the end, we applied other approach that enable us to attain <strong>Galaxy S10 Secure Bootloader&#x27;s permission of arbitrary code</strong> without having debug cable.</p><p>We will have a thorough display on Black Hat. Stay tuned!</p><p>For the latest vulnerability research from D39, please follow:</p><p>TeamT5 official website: <a href="https://teamt5.org/" title="https://teamt5.org/">https://teamt5.org/</a></p><p>Twitter: <a href="https://twitter.com/TeamT5_Official" title="https://twitter.com/TeamT5_Official">https://twitter.com/TeamT5_Official</a></p></div></div></div><div class="css-1h6gcr1"><div class="css-2uv98o">Share:<div class="css-3ostf4"><a class="css-18hi9tf"><button aria-label="linkedin" class="react-share__ShareButton share" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><div class="css-6tkolk"><svg width="24px" height="24px" viewBox="0 0 24 24"><g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="sns/linkedin/nor"><path class="dark" d="M21,0 C22.6568542,-3.04359188e-16 24,1.34314575 24,3 L24,21 C24,22.6568542 22.6568542,24 21,24 L3,24 C1.34314575,24 2.02906125e-16,22.6568542 0,21 L0,3 C-2.02906125e-16,1.34314575 1.34314575,3.04359188e-16 3,0 L21,0 Z M19.0257087,9.0309163 C16.1146435,7.90189457 14.1125239,9.13845978 13.5311978,10.2828185 L13.5311978,10.2828185 L13.4415783,10.4056989 L13.3876217,10.4056989 L13.3876217,8.83634022 L10.0184804,8.83634022 L10.0184804,20.1829163 L13.5311978,20.1829163 L13.5316179,14.0152782 C13.5352018,13.9482549 13.5643166,13.4915116 13.7156109,12.9431337 C13.879513,12.3490576 14.4018935,11.8678837 15.0368065,11.7243076 C15.6717196,11.5811011 16.2554478,11.7243076 16.5934152,11.8678837 C16.9313826,12.0110902 17.1054478,12.3643946 17.1745565,12.471938 C17.2436652,12.5794815 17.458937,13.2476554 17.458937,13.6240576 L17.458937,13.6240576 L17.458937,20.1829163 L20.9921652,20.1829163 L20.9927319,13.1625978 C21.0044427,12.9799919 21.1719641,9.86344891 19.0257087,9.0309163 Z M7.82684783,8.83641413 L4.2731087,8.83641413 L4.2731087,20.1828054 L7.82684783,20.1828054 L7.82684783,8.83641413 Z M6.05809022,3.18481957 C4.92149239,3.18481957 3.99998152,4.10614565 3.99998152,5.24292826 C3.99998152,6.37952609 4.92149239,7.30085217 6.05809022,7.30085217 C7.19468804,7.30085217 8.11619891,6.37952609 8.11619891,5.24292826 C8.11619891,4.10614565 7.19468804,3.18481957 6.05809022,3.18481957 Z" id="Combined-Shape"></path></g></g></svg></div></button></a><a class="css-18hi9tf"><button aria-label="twitter" class="react-share__ShareButton share" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><div class="css-6tkolk"><svg width="24px" height="24px" viewBox="0 0 24 24"><g id="sns/twitter/hover" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path class="dark" d="M3,0 L21,0 C22.6568542,-3.04359188e-16 24,1.34314575 24,3 L24,21 C24,22.6568542 22.6568542,24 21,24 L3,24 C1.34314575,24 2.02906125e-16,22.6568542 0,21 L0,3 C-2.02906125e-16,1.34314575 1.34314575,3.04359188e-16 3,0 Z M9.40543979,19.2 C15.5354921,19.2 18.8873246,14.1204188 18.8873246,9.71811518 C18.8873246,9.57298429 18.8873246,9.4278534 18.8804136,9.28963351 C19.5300471,8.81968586 20.0967487,8.23225131 20.5459634,7.56188482 C19.9516178,7.82450262 19.3088953,8.00418848 18.6316178,8.08712042 C19.3227173,7.67246073 19.8479529,7.02282723 20.0967487,6.24188482 C19.4540262,6.62198953 18.7421937,6.89842932 17.9819843,7.0504712 C17.3738168,6.4008377 16.5099424,6 15.5493141,6 C13.7109895,6 12.2182147,7.49277487 12.2182147,9.33109948 C12.2182147,9.59371728 12.2458586,9.84942408 12.3080576,10.0913089 C9.53674869,9.95308901 7.08334555,8.62617801 5.4385288,6.60816754 C5.15517801,7.09884817 4.98931414,7.67246073 4.98931414,8.28062827 C4.98931414,9.4347644 5.57674869,10.4575916 6.47517801,11.0519372 C5.92920942,11.0381152 5.41779581,10.8860733 4.96858115,10.6372775 C4.96858115,10.6510995 4.96858115,10.6649215 4.96858115,10.6787435 C4.96858115,12.2959162 6.11580628,13.6366492 7.64313613,13.947644 C7.36669634,14.0236649 7.06952356,14.0651309 6.76543979,14.0651309 C6.55119895,14.0651309 6.34386911,14.0443979 6.13653927,14.0029319 C6.55810995,15.3298429 7.78826702,16.2904712 9.24648691,16.3181152 C8.10617277,17.2096335 6.66868586,17.7417801 5.10680105,17.7417801 C4.83727225,17.7417801 4.57465445,17.7279581 4.31203665,17.6934031 C5.77025654,18.6471204 7.52564921,19.2 9.40543979,19.2"></path></g></svg></div></button></a><a class="css-18hi9tf"><button aria-label="facebook" class="react-share__ShareButton share" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><div class="css-6tkolk"><svg width="24px" height="24px" viewBox="0 0 24 24" version="1.1"><g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path class="dark" d="M22,0 C23.1045695,-2.02906125e-16 24,0.8954305 24,2 L24,22 C24,23.0543618 23.1841222,23.9181651 22.1492623,23.9945143 L22,24 L22,24 L14,24 L14,23.978 L13.875,24 L13.875,15.5633307 L16.6710937,15.5633307 L17.203125,12.0733717 L13.875,12.0733717 L13.875,9.80860051 C13.875,8.85381375 14.3398828,7.92315016 15.8305781,7.92315016 L15.8305781,7.92315016 L17.34375,7.92315016 L17.34375,4.95196885 C17.34375,4.95196885 15.9704766,4.71616081 14.6575781,4.71616081 C11.9165156,4.71616081 10.125,6.3875682 10.125,9.41345698 L10.125,9.41345698 L10.125,12.0733717 L7.078125,12.0733717 L7.078125,15.5633307 L10.125,15.5633307 L10.125,24 C10.0832306,23.9934058 10.0415327,23.9865949 9.99990751,23.9795684 L10,24 L2,24 C0.8954305,24 1.3527075e-16,23.1045695 0,22 L0,2 C-1.3527075e-16,0.8954305 0.8954305,2.02906125e-16 2,0 L22,0 Z" id="path-1"></path></g></svg></div></button></a></div></div></div><div class="css-vkmg7y"></div></div></div><div class="css-m5kad0"><div class="css-1xf4lef default"></div><div class="css-1d0bkbk default"></div></div></div><div class="css-yx8k1m"><div class="css-k48dnj"><style data-emotion="css 10f0b8k">.css-10f0b8k{width:100%;height:100%;max-height:80vh;}</style><img src="" class="css-10f0b8k"/><div class="css-2eb87j"><svg height="10" viewBox="0 0 10 10" width="10"><defs><path id="a" d="m10.0473785.61928813c.2603496.26034952.2603496.68245951 0 .94280904l-3.77135252 3.77092881 3.77135252 3.77154352c.2603496.26034953.2603496.68245951 0 .942809-.26034949.2603496-.68245947.2603496-.942809 0l-3.77154352-3.77135252-3.77092881 3.77135252c-.26034953.2603496-.68245952.2603496-.94280904 0-.26034953-.26034949-.26034953-.68245947 0-.942809l3.77073785-3.77154352-3.77073785-3.77092881c-.26034953-.26034953-.26034953-.68245952 0-.94280904.26034952-.26034953.68245951-.26034953.94280904 0l3.77092881 3.77073785 3.77154352-3.77073785c.26034953-.26034953.68245951-.26034953.942809 0z"></path><mask id="b" fill="#fff"><use fill="#fff" fill-rule="evenodd" xlink:href="#a"></use></mask></defs><g fill="#f5f2e9" fill-rule="evenodd" transform="translate(-.333333 -.333333)"><use xlink:href="#a"></use><g mask="url(#b)"><path d="m0 0h16v16h-16z" transform="translate(-2.666667 -2.666667)"></path></g></g></svg></div></div></div></main><footer class="css-1j4sz91"><div class="css-1rid8u3"><div class="css-mp3uzg"><svg width="84px" height="84px" viewBox="0 0 84 84"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="footer-tmp/nor" transform="translate(-1166.000000, 0.000000)"><g id="footer/nor"><g id="Top" transform="translate(1166.000000, 0.000000)"><g id="scroll"><polygon id="Rectangle" fill="#d93751" points="42 0 84 42 42 84 0 42"></polygon><path d="M57,56.7989281 L42,70.9217351 L27,56.7989281 M42,70.9217351 L42.5,39.9444444" id="Combined-Shape" stroke="#FFFFFF" stroke-linecap="round" stroke-linejoin="round" transform="translate(42.000000, 55.222222) scale(1, -1) translate(-42.000000, -55.222222) "></path><text id="TOP" font-family="NotoSansCJKtc-Light, Noto Sans CJK TC" font-size="12" font-weight="300" fill="#FFFFFF"><tspan x="30.612" y="32">TOP</tspan></text></g></g></g></g></g></svg></div></div><div class="css-1742rmd"><a class="css-1xlcuzt" href="/jp/"><img src="/images/logo_contact.svg" alt=""/></a><div class="css-4qsnzi"><div class="css-tu40hi"><div class="css-9tw39e disable"><a href="/jpundefined"><style data-emotion="css h6a8fj">.css-h6a8fj{display:-webkit-box;display:-webkit-unset;display:-ms-unsetbox;display:unset;cursor:pointer;margin:0;color:#4c433f;font-size:14px;font-weight:bold;}</style><h6 class="css-1o9043k css-h6a8fj">ソリューション</h6></a></div><div class="css-ipgxcm"><div class="css-cssveg"><a href="/jp/products/threatsonar"><div class="css-1bu2g12">ThreatSonar</div></a></div><div class="css-cssveg"><a href="/jp/products/threatvision"><div class="css-1bu2g12">ThreatVision</div></a></div></div></div><div class="css-tu40hi"><div class="css-9tw39e disable"><a href="/jpundefined"><style data-emotion="css h6a8fj">.css-h6a8fj{display:-webkit-box;display:-webkit-unset;display:-ms-unsetbox;display:unset;cursor:pointer;margin:0;color:#4c433f;font-size:14px;font-weight:bold;}</style><h6 class="css-1o9043k css-h6a8fj">TeamT5について</h6></a></div><div class="css-ipgxcm"><div class="css-cssveg"><a href="/jp/about-us"><div class="css-1bu2g12">会社概要</div></a></div><div class="css-cssveg"><a href="/jp/careers"><div class="css-1bu2g12">キャリア採用</div></a></div></div></div><div class="css-tu40hi"><div class="css-9tw39e"><a href="/jp/news-and-events"><style data-emotion="css h6a8fj">.css-h6a8fj{display:-webkit-box;display:-webkit-unset;display:-ms-unsetbox;display:unset;cursor:pointer;margin:0;color:#4c433f;font-size:14px;font-weight:bold;}</style><h6 class="css-1o9043k css-h6a8fj">最新情報</h6></a></div></div><div class="css-tu40hi"><div class="css-9tw39e"><a href="/jp/blog"><style data-emotion="css h6a8fj">.css-h6a8fj{display:-webkit-box;display:-webkit-unset;display:-ms-unsetbox;display:unset;cursor:pointer;margin:0;color:#4c433f;font-size:14px;font-weight:bold;}</style><h6 class="css-1o9043k css-h6a8fj">ブログ</h6></a></div></div><div class="css-tu40hi"><div class="css-9tw39e disable"><a href="/jpundefined"><style data-emotion="css h6a8fj">.css-h6a8fj{display:-webkit-box;display:-webkit-unset;display:-ms-unsetbox;display:unset;cursor:pointer;margin:0;color:#4c433f;font-size:14px;font-weight:bold;}</style><h6 class="css-1o9043k css-h6a8fj">お問い合わせ</h6></a></div><div class="css-ipgxcm"><div class="css-cssveg"><a href="/jp/request-information"><div class="css-1bu2g12">インフォメーション</div></a></div><div class="css-cssveg"><a href="/jp/become-a-partner"><div class="css-1bu2g12">パートナー募集</div></a></div></div></div></div></div><hr/><div class="css-f24dyb"><div class="css-vx1whx"><a class="css-nagi7g" href="/jp/privacy-and-cookies-policy">プライバシー&amp;クッキーポリシー</a><a class="css-nagi7g" href="/jp/terms-of-service">サービス利用規約</a><div class="css-nagi7g disable">© 2020 TEAM T5, Inc. All Rights Reserved.</div></div><div class="css-1v3z295"><div class="css-cksic1"><select><option value="en">English</option><option value="tw">繁體中文</option><option selected="" value="jp">日本語</option></select><svg width="8px" height="4px" viewBox="0 0 8 4" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="footer/nor" transform="translate(-1227.000000, -341.000000)" fill="#4c433f"><g transform="translate(1170.000000, 333.000000)"><polygon id="Triangle" transform="translate(61.000000, 10.000000) scale(1, -1) translate(-61.000000, -10.000000) " points="61 8 65 12 57 12"></polygon></g></g></g></svg></div></div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"publish":true,"enable_form":false,"tags":[{"_id":"5ed467d0165e5f006fa403fd","name":"D39","createdAt":"2020-06-01T02:28:32.042Z","updatedAt":"2020-06-01T02:28:32.042Z","__v":0,"id":"5ed467d0165e5f006fa403fd"},{"_id":"5ed467b5165e5f006fa403fc","name":"vulnerability research ","createdAt":"2020-06-01T02:28:05.155Z","updatedAt":"2020-06-01T02:28:05.155Z","__v":0,"id":"5ed467b5165e5f006fa403fc"}],"relative_posts":[],"_id":"5ee07e4bbf58af004a154155","post_url":"blackhat-s-talk-breaking-samsung-s-root-of-trust-exploiting-samsung-secure-boot","post_name":"BlackHat's Talk: Breaking Samsung's Root of Trust - Exploiting Samsung Secure Boot","banner_img_url":"https://res.cloudinary.com/dvgomg5gh/image/upload/v1590731286/20200608_cover_23a0b23713.jpg","contents":[{"locale":"en","_id":"5ee07e4bbf58af004a154156","title":"BlackHat's Talk: Breaking Samsung's Root of Trust - Exploiting Samsung Secure Boot","context":"### D39\n\nD39 focuses on vulnerability research and has identified several critical security flaws, including technical exploitation of mobile, IoT devices, and Linux and Windows operating systems. We have reported dozens of vulnerabilities and dedicate to Samsung Vulnerabilities and Exposures (SVE) and Common Vulnerabilities and Exposures (CVE).\n\nBefore diving into the main subject this month, we are glad to announce that TeamT5 is again accepted at Black Hat USA, and our vulnerability research team, D39, will talk at the Black Hat Briefings in the upcoming August. We are honored to share our research findings with researchers and security experts all over the world and expect more recognition of Taiwan's vulnerability researchers in the world.\n\n![](https://res.cloudinary.com/dvgomg5gh/image/upload/v1591769445/D39_6-1_6807f98c9b.png)\n[Black Hat Session](https://www.blackhat.com/us-20/briefings/schedule/index.html#breaking-samsungs-root-of-trust-exploiting-samsung-s-secure-boot-20290)\n\nThis article will cover a part of our talk at Black Hat USA in August.\n\n### Introduction\n\nWe have found several vulnerabilities in Samsung Secure boot, which can break through Samsung Knox protections. We can even retrieve users' sensitive data from a locked device. The affected Samsung mobiles include Galaxy S8, S9, and S10. Patches to these vulnerabilities have been provided by Samsung.\n\nOne of these vulnerabilities allows attackers to execute arbitrary code in Galaxy S8 secure bootloader to access the device. In this article, we will elaborate how we exploit these vulnerabilities to bypass S8 secure bootloader through the USB device and obtain arbitrary code execution in early boot stage.\n\nNote: Another security research team found this vulnerability at the same time and report it to Samsung.\nID: SVE-2019-15230 (details below).\n![](https://res.cloudinary.com/dvgomg5gh/image/upload/v1591769435/SVE-2019_3bc5eea84d.png)\n\n### KNOX\n\n![](https://res.cloudinary.com/dvgomg5gh/image/upload/v1591769436/D39_6-2_ee457f68cd.png)\n[Image courtesy](https://docs.samsungknox.com/whitepapers/knox-platform/hardware-backed-root-of-trust.htm)\n\nAs the market leader of smartphone, Samsung conducts a series of protection on Android, known as the Knox Platform, to ensure the security of its devices. During the booting process, Samsung uses S-boot (Secure Boot) to make sure it can only boot a stocked image. If the device tries to boot a custom image, it will trip (turned from 0X0 to 0X1) a one-time programmable bit e-fuse (a.k.a Knox bit). Once a trustzone app (trustlet) detects the Knox bit tripped, it will delete the encryption key of sensitive data to prevent unauthorized data from accessing the locked device.\n\n### Vulnerability\n\nSmartphones with Samsung Exynos processor use a exclusive secure bootloader named S-boot. S-boot has ODIN mode which allows users to upgrade the firmware manually. Due to the insufficiency in its code, the flash command (opcode: 0x66) in ODIN mode is not able to properly check the flash image size, which leads to buffer overflow.\n\nThe flash command in ODIN mode uses a temporary buffer to store the image. In Galaxy S8, the buffer is located at 0xC0000000, right in front of sboot code segment (0xC9000000). Although the system will check to ensure that the size being no larger than 0x1e0000, it uses signed comparison to check the size of the image; thus provide us some space to get around. We therefore provide a size larger than 0x80000000, making buffer overflowed and, in the end, the following segments such as code, stack, and heap will be overwritten.\n\n![](https://res.cloudinary.com/dvgomg5gh/image/upload/v1591769435/D39_6-3_8b038e080e.png)\n\n### The Exploit\n\n#### Code Execution\n\nAlthough we can overflow the code segment of S-Boot, we still cannot hijack the execution flow. Since USB receivers use physical memory to hold the data it received directly, we cannot affect instruction cache unless the cache line has been invalidated.\n\nFortunately, the heap segment is not cached due to MMU flag. There are some pointers stored in the heap segment, which can be accessed during the USB process. If we overwrite these pointers with null bytes, the processor will trigger an exception and trap into the exception handler while accessing to NULL pointers. Since the handler has never been executed, it is not cached in the instruction cache. Therefore we can also overwrite the exception handler simultaneously and hijack it directly to our shellcode.\n\n![](https://res.cloudinary.com/dvgomg5gh/image/upload/v1591769437/D39_6-4_58c7cc6a95.png)\n\n#### Booting Custom Kernel\n\nSince all the run-time data has been overwritten -- including stack, heap and global variables -- the sboot fail to perform further booting operation. These kinds of data are difficult to recover, so we must re-execute the booting process.\n\nUnder normal condition, S-boot calls several functions in a particular function table which is located at 0xC90C7350. To re-execute s-boot, these functions have to be invoked sequentially again. They would initialize the memory of heap and stack, set the global variables, and boot the kernel at the end. However, these functions also involve some SMC calls which cannot be executed twice. Since we only compromised EL1 (Exception Level 1), the trustzone in EL3 (Exception Level 3) cannot be reverted. As a result, we have to overwrite these SMC calls with NOP instruction while overflowing the code segment to ignore those SMC (System Management Controller) calls.\n\nAfter all the run-time data has been reset, we replace the original kernel with our custom one. Then we execute one last function to boot our custom kernel and get the **root privilege without blowing KNOX bit**.\n\n![](https://res.cloudinary.com/dvgomg5gh/image/upload/v1591769436/D39_6-5_2f6b6f9ccd.png)\n\n### Timeline\n\n2019-10-02 Report Vulnerability\n2019-10-08 Informed Vulnerability duplicated and release patch note\n\n### Appendix: Potential Exploit Path on Galaxy S10\n\nAccording to our analysis, this vulnerability affects Galaxy S9, Galaxy S10 and Galaxy Note 10 as well. Among them we find that exploitation can still be trigger at different address. For instance, even the temporary buffer located at different addresss, like 0x890000000 in Galaxy S10, there are still chances to exploit it. To explain the complete exploitation flow, we choose the firmware, G970FXXU1ASD5, as an example.\n\nIn Galaxy S9 and later version, there is another feature added to the secure boot - compressed_download. It uses another buffer to store the flash image. However if compressed_download failed during the initialization, it will fallback to normal download, and use the buffer (0xC0000000) to store the flash image.\n\n![](https://res.cloudinary.com/dvgomg5gh/image/upload/v1591769435/D39_6-6_724f86aa51.png)\n\nTo make S-boot fallback to normal download, we have to make the function `cd_v3_smp_register` fail. After reversing, we noticed that the function `cd_v3_smp_register` may return failed if there is no available core(`booted_cores` \u003e 3) can be booted. Coincidentally, there is a test command - \"smp_boot_test\" in the UART (Universal Asynchronous Receiver/Transmitter) console. The command smp_boot_test will boot a core and add the count of the booted_cores. Although `smp_boot_test` shutdown the booted up core immediately, it didn't restore the count. Therefore, the compressed_download_init may failed if the command `smp_boot_test` has been invoked more than twice before entering the download mode.\n\nIf we have the UART debug cable to get the UART console, we can call the command`smp_boot_test` 3 times and enter the download mode via the command `usb`. The `compressed_download_init` would fail, then the temporary buffer fallback to 0xC0000000. Therefore the arbitrary code execution on S10's bootloader can be achieved as the one in Galaxy S8.\n\nWe managed to build our own TypeC debug cable at first. However, after trying every kinds of Pull-up/down resistor value, TypeC accessory mode, TypeC VDM, we cannot yet figure out a cable for RID_523K detection. Still, in the end, we applied other approach that enable us to attain **Galaxy S10 Secure Bootloader's permission of arbitrary code** without having debug cable.\n\nWe will have a thorough display on Black Hat. Stay tuned!\n\nFor the latest vulnerability research from D39, please follow:\n\nTeamT5 official website: [https://teamt5.org/](https://teamt5.org/ \"https://teamt5.org/\")\n\nTwitter: [https://twitter.com/TeamT5_Official](https://twitter.com/TeamT5_Official \"https://twitter.com/TeamT5_Official\")","createdAt":"2020-06-10T06:31:39.066Z","updatedAt":"2020-07-02T09:16:52.294Z","__v":0,"id":"5ee07e4bbf58af004a154156"}],"createdAt":"2020-06-10T06:31:39.059Z","updatedAt":"2021-01-13T02:33:44.215Z","__v":1,"topic":{"category":"blogs","_id":"5ecaa004a792d70040a0d8b0","color":"#64cda2","name":"Technical Analysis","createdAt":"2020-05-24T16:25:40.461Z","updatedAt":"2020-06-07T22:08:04.525Z","__v":0,"contents":[{"locale":"en","_id":"5edd6544bf58af004a15410d","text":"Technical Analysis","createdAt":"2020-06-07T22:08:04.247Z","updatedAt":"2020-06-07T22:08:04.247Z","__v":0,"id":"5edd6544bf58af004a15410d"},{"locale":"tw","_id":"5edd6544bf58af004a15410e","text":"技術分析","createdAt":"2020-06-07T22:08:04.247Z","updatedAt":"2020-06-07T22:08:04.247Z","__v":0,"id":"5edd6544bf58af004a15410e"},{"locale":"jp","_id":"5edd6544bf58af004a15410f","text":"技術分析","createdAt":"2020-06-07T22:08:04.248Z","updatedAt":"2020-06-07T22:08:04.248Z","__v":0,"id":"5edd6544bf58af004a15410f"}],"id":"5ecaa004a792d70040a0d8b0"},"publish_date":"2020-06-10T03:00:00.000Z","author":{"confirmed":true,"blocked":false,"_id":"5eeadf2c163518003f86d911","username":"D39","email":"d39@example.com","provider":"local","createdAt":"2020-06-18T03:27:40.091Z","updatedAt":"2020-06-19T03:40:27.965Z","__v":0,"role":"5e467d0375f9d7007998aebf","id":"5eeadf2c163518003f86d911"},"been_relative_posts":[{"publish":true,"enable_form":false,"tags":["609a3fe42107530037594af9","5ed467b5165e5f006fa403fc"],"relative_posts":["5ee07e4bbf58af004a154155","609a38e42107530037594ae8"],"_id":"5f2b78f2163518003f86da49","banner_img_url":"https://res.cloudinary.com/dvgomg5gh/image/upload/f_auto/v1596099107/20200525_e334c6b0ed.png","post_name":"Black Hat’s Talk: D39 Shares Their Research on Breaking Samsung Secure Boot at Black Hat USA 2020","post_url":"black-hat-s-talk-d39-shares-their-research-on-breaking-samsung-secure-boot-at-black-hat-usa-2020","publish_date":"2020-08-06T08:00:00.000Z","contents":[{"locale":"en","_id":"5f2b78f2163518003f86da4a","title":"Black Hat’s Talk: D39 Shares Their Research on Breaking Samsung Secure Boot at Black Hat USA 2020","context":"*Image courtesy of Black Hat from https://www.blackhat.com/us-20/\n\nWe were glad to announce that TeamT5 was again accepted at Black Hat USA. And this time, our vulnerability research team, D39, presented their latest exploit research on Samsung S10 secure bootloader at the Black Hat Briefings. We were very honored to share our research findings with researchers and security experts all over the world in this annual flagship conference.\n\n![BHUSA_cover](https://res.cloudinary.com/dvgomg5gh/image/upload/v1596699298/BHUSA_cover_48fcf0b266.jpg)\n_TeamT5's vulnerability researcher presented on Black Hat USA 2020._\n\nD39 has been focusing on vulnerability research and has identified several critical security flaws. We have found several vulnerabilities in Samsung Secure boot, which can break through Samsung Knox protections. In Black Hat USA 2020, we elaborated how did we discover and exploit the vulnerabilities in detail, demonstrated the exploit on a Samsung Galaxy S10 smartphone, and had a discussion on the possible impact of these vulnerabilities.\n\n![Disclosure timeline](https://res.cloudinary.com/dvgomg5gh/image/upload/v1596699297/Disclosure_timeline_422975e76a.jpg)\n_Timeline of the vulnerability disclosure, patch release and assignment of SVE IDs._\n\nBlack Hat is the world’s leading information security event, and remains the best and biggest event of its kind. It provides attendees with cutting-edge security research, development and trends, and has the ability to define tomorrow’s information security landscape. Black Hat USA 2020 went fully virtual this year, held over the same dates from 1 to 6 August, in light of the coronavirus pandemic.","createdAt":"2020-08-06T03:28:50.998Z","updatedAt":"2020-08-06T07:56:30.077Z","__v":0,"id":"5f2b78f2163518003f86da4a"}],"createdAt":"2020-08-06T03:28:50.953Z","updatedAt":"2021-05-13T03:37:18.933Z","__v":1,"author":"5eec3483163518003f86d943","topic":"5ecaa036a792d70040a0d8b4","id":"5f2b78f2163518003f86da49"},{"publish":true,"enable_form":false,"tags":["5ffd1086c56e80003f985958","5ffd1093c56e80003f985959","5ffd109dc56e80003f98595a","5ed467b5165e5f006fa403fc"],"relative_posts":["5ee07e4bbf58af004a154155"],"_id":"5ffd4148c56e80003f98595c","post_name":"年度最慘漏洞！深入探究 Oracle WebLogic CVE-2020-14882","post_url":"most-epic-fail-vulnerability-research-on-oracle-weblogic-cve-2020-14882","publish_date":"2021-01-13T02:00:00.000Z","contents":[{"locale":"tw","_id":"5ffd4148c56e80003f98595d","title":"年度最慘漏洞！深入探究 Oracle WebLogic CVE-2020-14882","context":"圖片來源：[Pixabay](https://pixabay.com/photos/toys-pony-my-little-pony-horse-4968006/)\n\n## 緣起\n\nWebLogic 是美商 Oracle 的主要產品之一，係商業市場上主要的 Java（J2EE）應用伺服器軟體（application server）之一。於 2020 年爆出高風險漏洞 CVE-2020-14882 與 CVE-2020-14883，其中，CVE-2020-14882 的 CVSS 3.1 評分更高達 9.8，屬於嚴重（Critical）等級之漏洞。\n\n攻擊者可利用漏洞，組合惡意指令，使未經授權的請求繞過 WebLogic 後台登入等限制，最終可以遠端執行代碼攻擊（Remote Code Execution），因此攻擊者可輕易的利用此漏洞發起攻擊。\n\n\u003cbr\u003e\n\n## 技術分析\n\n我們從下圖的漏洞 POC 範例開始看起。\n\n![blog_2101-1.png](https://res.cloudinary.com/dvgomg5gh/image/upload/v1610433541/blog_2101_1_7add5099fd.png)\n_圖一、POC 攻擊範例_\n\n\u003cbr\u003e\n\n首先 WebLogic 會對 url 進行檢查，當攻擊者試圖存取 console 路徑底下的檔案資源時（階段 A），會將其 url 與 WebLogic 設定檔（web.xml）內的網頁資源路徑進行比對，若該 url 屬於任一資源路徑，將不須驗證即可進行資源存取（階段 B）。其 web.xml 的檔案路徑為 wlserver/server/lib/consoleapp/webapp/WEB-INF/web.xml，如下圖所示。\n\n![blog_2101-2.png](https://res.cloudinary.com/dvgomg5gh/image/upload/v1610433541/blog_2101_2_b9ab148ed5.png)\n_圖二、web.xml 內容_\n\n\u003cbr\u003e\n\n再來，```http://127.0.0.1:7001/console/images/%252E%252E%252Fconsole.portal``` 會先進行一次 url decode，將 %25 轉成 %，所以該 url 會變成 ```http://127.0.0.1:7001/console/images/%2E%2E%2Fconsole.portal```（階段 C）。\n\n但是在 UIServletInternal.getTree 函式中，WebLogic 又會做再一次 url decode，將 %2E%2E%2F 轉為 ../，於是 url 變成```http://127.0.0.1:7001/console/images/../console.portal```，且後續的操作中 WebLogic 都沒有對路徑進行權限檢查，所以產生了跨目錄穿越攻擊（Directory Traversal）的漏洞。\n\nWebLogic Server 處理後台管理（console）的請求時，會呼叫 BreadcrumbBacking().init 函式進行處理（階段 D）。當 url 中含有 handle 參數時，會將 handle 拆解成 class 和 argument。以 POC 為例，class 就會是 ```com.tangosol.coherence.mvel2.sh.ShellSession()```（階段 E），argument 則是 ```\"java.lang.Runtime.getRuntime().exec(%27whoami%27);\"```（階段 F）。\n\n後續，會將 argument 傳給 class 的 constructor ，而 ShellSession 函式會再把 argument 傳給 MVELInterpretedRuntime 函式中，最後透過反射執行 argument 中內含的惡意指令，也就是 POC 範例中的 whoami。\n\n\u003cbr\u003e\n\n## 修補插曲\n\n但僅憑跨目錄穿越攻擊、Unauthorized RCE 等問題，何以稱之為「年度最慘漏洞（Most Epic Fail）」？\n\nOracle 於 2020 年 10 月釋出修補程式，但細究其修補的方法，發現 Oracle 利用黑名單的方式過濾 url 參數，如下圖所示。\n\n![blog_2101-3.png](https://res.cloudinary.com/dvgomg5gh/image/upload/v1610433542/blog_2101_3_67ba9cf2c5.png)\n_圖三、Oracle 透過黑名單修補 CVE-2020-14882_\n\n\u003cbr\u003e\n\n#### 利用黑名單方式過濾，會有什麼問題呢？\n\n只要利用不在黑名單內的 %252e%252e，就可以成功繞過（Bypass）已修補程式中的 url 檢查。\n\n眾多安全研究人員於短時間內發現該問題並通報 Oracle，該漏洞也被編號為 CVE-2020-14750，如下圖所示。此錯誤的漏洞修補方式，也使得 CVE-2020-14882 成功入圍 2020 年 [Pwnie Award Most Epic Fail](https://pwnies.com/nominations/active/most-epic-fail/oracle-weblogic-server-co-oracle/) 項目。\n\n![blog_2101-4.png](https://res.cloudinary.com/dvgomg5gh/image/upload/v1610433541/blog_2101_4_677f062e72.png)\n_圖四、眾多研究員回報 CVE-2020-14750_\n\n\u003cbr\u003e\n\n漏洞修補是一門深奧的學問，以 CVE-2020-14882 為例，其成因包含對檔案路徑存取控管不確實、對路徑做兩次的 url decode 及後台管理程式提供代碼執行。但 Oracle 一開始只修補兩次的 url decode 問題，更不用說其修補的方式為黑名單限制。因漏洞修補不確實而產生了更多的漏洞，所以不可不慎。\n\n\u003cbr\u003e\n\n## 影響層面\n\n攻擊者利用此漏洞互相搭配，不須登入即可遠端指令執行，進而產生憑證竊取（Credential Dump）、橫向移動（Lateral Movement）等攻擊行為。\n\n- 受影響產品：WebLogic Server\n- 受影響版本：10.3.6.0.0、12.1.3.0.0、12.2.1.3.0、12.2.1.4.0、14.1.1.0.0\n\n\u003cbr\u003e\n\n## 防護建議\n\n- 更新 Oracle 官方最新修正 [patch](https://www.oracle.com/security-alerts/cpuoct2020.html)。\n- 惡意 payload 檢查，例如檢查 console.portal 和 payload 是否帶有 ```handle=...``` 參數，或是直接關閉 console.portal 和 payload 的 handle 功能。\n- 匯入以下 Yara 偵測規則，確認是否存在利用該漏洞的惡意程式。\n\n```\nrule CVE_2020_14882 {\n    meta:\n        author = \"TeamT5\"\n        description = \"CVE-2020-14882 exploit\"\n    strings:\n        $resource1 = \"console/bea-helpsets/\"\n        $resource2 = \"console/framework/skins/wlsconsole/images/\"\n        $resource3 = \"console/framework/skins/wlsconsole/css/\"\n        $resource4 = \"console/framework/skins/wlsconsole/js/\"\n        $resource5 = \"console/framework/skeletons/wlsconsole/css/\"\n        $resource6 = \"console/framework/skeletons/wlsconsole/js/\"\n        $resource7 = \"console/css/\"\n        $resource8 = \"console/common/\"\n        $resource9 = \"console/images/\"\n\n        $console1 = \"console.portal\"\n        $console2 = \"consolejndi.portal\"\n        \n        $handle = \"handle=\"\n\n    condition:\n        any of ($resource*) and 1 of ($console*) and $handle\n}\n```\n\n![blog_2101-5.png](https://res.cloudinary.com/dvgomg5gh/image/upload/v1610433541/blog_2101_5_8a00e312e3.png)\n_圖五、透過 Yara 偵測規則可有效偵測 CVE-2020-14882 exploit_\n\n\u003cbr\u003e\n","__v":0,"id":"5ffd4148c56e80003f98595d"}],"createdAt":"2021-01-12T06:27:20.923Z","updatedAt":"2021-01-13T02:33:44.217Z","__v":1,"author":"5ff54e5ec56e80003f985956","topic":"5ecaa004a792d70040a0d8b0","banner_img_url":"https://res.cloudinary.com/dvgomg5gh/image/upload/f_auto/v1610441497/toys_4968006_1920_454e3e5929.jpg","id":"5ffd4148c56e80003f98595c"}],"id":"5ee07e4bbf58af004a154155"}},"__N_SSG":true},"page":"/[lang]/posts/[uid]","query":{"lang":"jp","uid":"blackhat-s-talk-breaking-samsung-s-root-of-trust-exploiting-samsung-secure-boot"},"buildId":"yZH7uzr0jnSd-VRHt_pM1","runtimeConfig":{"env":"production","baseUrl":"https://teamt5.org/","cmsUrl":"https://official-cms.teamt5.net/"},"isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html></html>