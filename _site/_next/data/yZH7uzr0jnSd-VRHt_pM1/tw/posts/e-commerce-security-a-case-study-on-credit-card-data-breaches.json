{"pageProps":{"post":{"publish":true,"enable_form":false,"tags":[{"_id":"5fb1db587f8d95003fe7dad5","name":"e-commerce security","createdAt":"2020-11-16T01:52:24.059Z","updatedAt":"2020-11-16T01:52:24.059Z","__v":0,"id":"5fb1db587f8d95003fe7dad5"},{"_id":"5fb479dd7f8d95003fe7db53","name":"credit card skimming","createdAt":"2020-11-18T01:33:17.132Z","updatedAt":"2020-11-18T01:33:17.132Z","__v":0,"id":"5fb479dd7f8d95003fe7db53"},{"_id":"5fb1db737f8d95003fe7dad6","name":"data breach","createdAt":"2020-11-16T01:52:51.014Z","updatedAt":"2020-11-18T01:34:03.650Z","__v":0,"id":"5fb1db737f8d95003fe7dad6"},{"_id":"5ecf8907fedd7f004b26978d","name":"backdoor","createdAt":"2020-05-28T09:48:55.991Z","updatedAt":"2020-05-28T09:48:55.991Z","__v":0,"id":"5ecf8907fedd7f004b26978d"},{"_id":"5ecf8852fedd7f004b269789","name":"ThreatSonar","createdAt":"2020-05-28T09:45:54.353Z","updatedAt":"2020-12-16T01:47:55.089Z","__v":0,"id":"5ecf8852fedd7f004b269789"}],"relative_posts":[],"_id":"5fab40b27f8d95003fe7dab2","post_url":"e-commerce-security-a-case-study-on-credit-card-data-breaches","publish_date":"2020-11-18T02:00:00.000Z","post_name":"打倒夢靨！電子商務安全不再沉睡！！信用卡與個資竊取案例分析","contents":[{"locale":"tw","_id":"5fac956e7f8d95003fe7dab3","title":"打倒夢靨！電子商務安全不再沉睡！！信用卡與個資竊取案例分析","context":"By Jason3e7 | 圖片來源：[Pixabay](https://pixabay.com/vectors/lock-security-credit-card-5459714/)\n\n## 前言\n\n近期於台灣發生多起信用卡盜刷事件，TeamT5 追蹤到幾起事件後深入調查，並於本文揭露側錄技術，以促進電商資訊安全，保護消費者的權益。\n\n## 技術分析\n\nTeamT5 分析近期數起信用卡盜刷事件，發現過往手法多為攻擊網站後再行 Dump Database，新的手法為存入資料庫之前，於前端程式或後端程式去側錄機敏資訊，以下將以知名 ASP.NET 平台的 CMS，DNN（DotNetNuke）作為範例，以前端與後端的攻擊手法分別說明。\n\n- **後端程式側錄**\n\n  利用高隱匿性的 IIS module，透過修改 config 被 IIS 載入後執行，可於該網站任意頁面側錄資訊。\n經過一段時間收集機敏資訊後，攻擊者再透過其他後門程式，定期將機敏資訊帶走，清除蹤跡。\n\n  運作原理拆解如下：\n\n\n 1. IIS web.config 被新增一行資料以啟用新的 module（LoggerModule）\n![202011-1](https://res.cloudinary.com/dvgomg5gh/image/upload/v1605146682/202011-1_6a6e70e4b2.jpg)\n 2. 於 bin 資料夾底下也新增檔案 System.Logger.dll\n![202011-2](https://res.cloudinary.com/dvgomg5gh/image/upload/v1605146684/202011-2_15be0c2208.jpg)\n 3. 反編譯 System.Logger.dll 之後，檢查內容發現 module 利用 Application_BeginRequest 的特性，於網站每個頁面執行前，執行側錄程式，故不管哪個頁面的機敏資訊都能側錄。\n![202011-3](https://res.cloudinary.com/dvgomg5gh/image/upload/v1605146681/202011-3_ebd6f3620b.jpg)\n 4. 側錄過程於後端接收，故前端無法察覺\n![202011-4](https://res.cloudinary.com/dvgomg5gh/image/upload/v1605146681/202011-4_1b178ba603.jpg)\n 5. 側錄資訊\n![202011-5](https://res.cloudinary.com/dvgomg5gh/image/upload/v1605146680/202011-5_bc97ae7951.jpg)\n\n<br>\n\n- **前端程式側錄**\n\n  利用網站前端複雜的載入資源匿蹤，透過插入 javascript 於前端載入後執行，可於載入頁面側錄資訊。\n\n  攻擊者可直接轉拋機敏資訊到遠端主機，或者於網站建立收集器，經過一段時間收集機敏資訊後，再透過其他後門程式，將機敏資訊帶走，清除蹤跡。\n\n  運作原理拆解如下：\n\n\n  1. 插入 JavaScript 到側錄機敏資訊頁面中，任意可載入資源的位置，在 http_server 設定接收主機（外部直接轉拋或內部隱匿留存），如下圖。\n![202011-6](https://res.cloudinary.com/dvgomg5gh/image/upload/v1605146681/202011-6_33f67394c9.jpg)\n\n  2. 如利用後端收集器接收，可參考下列圖片\n![202011-7](https://res.cloudinary.com/dvgomg5gh/image/upload/v1605146684/202011-7_9904abacc1.jpg)\n\n  3. 網站前端載入資源複雜，不易察覺\n![202011-8](https://res.cloudinary.com/dvgomg5gh/image/upload/v1605146692/202011-8_d2c677c5c1.jpg)\n\n  4. 側錄資訊\n![202011-9](https://res.cloudinary.com/dvgomg5gh/image/upload/v1605146691/202011-9_ccfef7c3ab.jpg)\n\n<br>\n\n## 影響與建議\n\n* 自動化或定期檢查程式碼是否被竄改，並做好版本控管\n* 透過 TeamT5 [ThreatSonar](https://teamt5.org/tw/products/threatsonar/) 檢查是否有攻擊者活動跡象\n  * 檢查是否有後門程式、webshell\n  * 是否有可疑連線 C2\n* 使用以下 yara rule 掃描網站目錄，檢查是否存在側錄模組\n\n```\nrule IIS_Module_sniffer\n{\n\tmeta:\n\t\tauthor = \"jason3e7\"\n\t\tdescription = \"detect IIS module sniffer\"\n\t\tdate = \"20201110\"\n\tstrings:\n\t\t$c0 = \"IHttpModule\" wide ascii\n\t\t$c1 = \"Application_BeginRequest\" wide ascii\n\t\t$c2 = \"Request\" wide ascii\n\t\t$c3 = \"Form\" wide ascii\n\t\t$c4 = \"StreamWriter\" wide ascii\n\t\t$c5 = \"WriteLine\" wide ascii\n\t\t$c6 = \"Write\" wide ascii\n\tcondition:\n\t\t$c0 and $c1 and ($c2 and $c3) and $c4 and ($c5 or $c6) \n}\n```\n\n<br>","createdAt":"2020-11-12T01:52:46.370Z","updatedAt":"2020-11-18T01:34:33.061Z","__v":0,"id":"5fac956e7f8d95003fe7dab3"}],"createdAt":"2020-11-11T01:38:58.079Z","updatedAt":"2020-12-16T01:47:55.087Z","__v":0,"author":{"confirmed":true,"blocked":false,"_id":"5eeae43e163518003f86d914","username":"Global Support & Service","email":"globalsupport@example.com","provider":"local","createdAt":"2020-06-18T03:49:18.738Z","updatedAt":"2020-06-30T08:49:49.293Z","__v":0,"role":"5e467d0375f9d7007998aebf","id":"5eeae43e163518003f86d914"},"topic":{"category":"blogs","_id":"5ecaa004a792d70040a0d8b0","color":"#64cda2","name":"Technical Analysis","createdAt":"2020-05-24T16:25:40.461Z","updatedAt":"2020-06-07T22:08:04.525Z","__v":0,"contents":[{"locale":"en","_id":"5edd6544bf58af004a15410d","text":"Technical Analysis","createdAt":"2020-06-07T22:08:04.247Z","updatedAt":"2020-06-07T22:08:04.247Z","__v":0,"id":"5edd6544bf58af004a15410d"},{"locale":"tw","_id":"5edd6544bf58af004a15410e","text":"技術分析","createdAt":"2020-06-07T22:08:04.247Z","updatedAt":"2020-06-07T22:08:04.247Z","__v":0,"id":"5edd6544bf58af004a15410e"},{"locale":"jp","_id":"5edd6544bf58af004a15410f","text":"技術分析","createdAt":"2020-06-07T22:08:04.248Z","updatedAt":"2020-06-07T22:08:04.248Z","__v":0,"id":"5edd6544bf58af004a15410f"}],"id":"5ecaa004a792d70040a0d8b0"},"banner_img_url":"https://res.cloudinary.com/dvgomg5gh/image/upload/f_auto/v1605149028/lock-5459714_b5a77d6d01.png","been_relative_posts":[],"id":"5fab40b27f8d95003fe7dab2"}},"__N_SSG":true}